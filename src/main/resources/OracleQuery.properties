#Generated by Eclipse Messages Editor (Eclipse Babel)
## MENU GRID QUERIES

AAACARD_SEARCH = AND HPM.AAA_CARDNO=?4 ORDER BY HPM.QUOTE_NO

ADMIN_PORTFOLIO_ACTIVEPOLICY = SELECT  ROWNUM \
                               SNO,TO_CHAR(PM.EFFECTIVE_DATE,'DD/MM/YYYY') \
                               EFFECTIVE_DATE,PI.CUST_NAME,PI.LAST_NAME,(CASE \
                               WHEN MDD.ISCOMMERCIAL_YN ='N' THEN 'PRIVATE' \
                               ELSE 'COMMERCIAL'END) ISCOMMERCIAL_YN,(SELECT \
                               BRANCH_NAME FROM BRANCH_MASTER WHERE \
                               BRANCH_CODE=PM.BRANCH_CODE) \
                               BRANCH_NAME,PM.APPLICATION_ID,PM.LOGIN_ID,PM.APP\
                               LICATION_NO,BCM.COMPANY_NAME \
                               BROKER_ORGANIZATION,PM.REMARKS,PI.FIRST_NAME,PM.\
                               OVERALL_PREMIUM + NVL (PM.EXCESS_PREMIUM, '0') \
                               PREMIUM,NVL (PM.EXCESS_PREMIUM, '0') \
                               EXCESS_PREMIUM,PI.COMPANY_NAME,PM.POLICY_NO,TO_C\
                               HAR (PM.ENTRY_DATE, \
                               'DD/MM/YYYY')ENTRY_DATE,PM.PRODUCT_ID,PM.CREDIT_\
                               NO,PM.DEBIT_NOTE_NO,PM.RECEIPT_NO, (SELECT \
                               PRODUCT_NAME FROM PRODUCT_MASTER PMM WHERE \
                               PMM.PRODUCT_ID=PM.PRODUCT_ID) \
                               PRODUCT_NAME,MDD.POLICYTYPE,PM.QUOTE_NO,(CASE \
                               WHEN PM.STATUS='P' AND PM.INTEGRATION_STATUS \
                               ='S' THEN 'P' WHEN PM. STATUS='P' AND \
                               PM.INTEGRATION_STATUS ='F' THEN 'PD' WHEN \
                               PM.STATUS='D' AND PM.INTEGRATION_STATUS ='F' \
                               THEN 'D' WHEN PM.STATUS='Y' AND \
                               PM.CUST_APPROVE_STATUS='Y' THEN 'CAQ' WHEN \
                               PM.STATUS='Y' AND PM.CUST_APPROVE_STATUS='N' \
                               THEN 'CRQ' WHEN PM.STATUS='Y' AND \
                               PM.CUST_APPROVE_STATUS='P' THEN 'CPQ' WHEN \
                               PM.STATUS='Y' AND PM.CUST_APPROVE_STATUS='R' \
                               THEN 'CREQ' WHEN PM.STATUS='Y' AND \
                               ERD.STATUS='R' AND PM.REMARKS = 'REFERAL' THEN \
                               'UQ' WHEN PM.STATUS='Y' AND PM.REMARKS \
                               IN('ADMIN') THEN 'AQ' WHEN PM.STATUS='Y' AND \
                               (ERD.STATUS='R' OR ERD.STATUS='D') AND \
                               PM.REMARKS = 'REFERAL' AND PM.ADMIN_REMARKS IS \
                               NOT NULL AND PM.ADMIN_REFERRAL_STATUS IS NOT \
                               NULL THEN 'RRQ' WHEN PM.INTEGRATION_STATUS IS \
                               NULL AND PM.STATUS = 'Y' AND \
                               TRUNC(PM.ENTRY_DATE) > TRUNC(SYSDATE) - 30 AND \
                               PM.CUST_APPROVE_STATUS IS NULL THEN 'EQ' WHEN \
                               (PM.STATUS = 'R' OR PM.STATUS = 'D') AND \
                               (ERD.STATUS='R' OR ERD.STATUS='D') AND \
                               PM.REMARKS NOT IN ('REFERAL') THEN 'RQ' WHEN \
                               PM.INTEGRATION_STATUS IS NULL AND PM.STATUS = \
                               'Y' AND TRUNC(PM.ENTRY_DATE) < TRUNC(SYSDATE) - \
                               30 AND PM.CUST_APPROVE_STATUS IS NULL THEN \
                               'EXQ' END) STATUS_TYPE, ( CASE WHEN \
                               PM.STATUS='P' AND PM.INTEGRATION_STATUS ='S' \
                               THEN 'POLICIES' WHEN PM.STATUS='P' AND \
                               PM.INTEGRATION_STATUS ='F' THEN 'PENDING \
                               POLICY' WHEN PM.STATUS='D' AND \
                               PM.INTEGRATION_STATUS ='F' THEN 'CANCEL POLICY' \
                               WHEN PM.STATUS='Y' AND \
                               PM.CUST_APPROVE_STATUS='Y' THEN 'CUSTOMER \
                               APPROVED QUOTE' WHEN PM.STATUS='Y' AND \
                               PM.CUST_APPROVE_STATUS='N' THEN 'CUSTOMER \
                               REJECTED QUOTE' WHEN PM.STATUS='Y' AND \
                               PM.CUST_APPROVE_STATUS='P' THEN 'CUSTOMER \
                               PENDING QUOTE' WHEN PM.STATUS='Y' AND \
                               PM.CUST_APPROVE_STATUS='R' THEN 'CUSTOMER \
                               REJECTED FOR REQUOTE' WHEN PM.STATUS='Y' AND \
                               ERD.STATUS='R' AND PM.REMARKS = 'REFERAL' THEN \
                               'REFERRAL PENDING QUOTE' WHEN PM.STATUS='Y' AND \
                               PM.REMARKS IN ('ADMIN') THEN 'REFERRAL APPROVED \
                               QUOTE' WHEN PM.STATUS='Y' AND (ERD.STATUS='R' \
                               OR ERD.STATUS='D') AND PM.REMARKS = 'REFERAL' \
                               AND PM.ADMIN_REMARKS IS NOT NULL AND \
                               PM.ADMIN_REFERRAL_STATUS IS NOT NULL THEN \
                               'REFERRAL REJECTED QUOTE' WHEN \
                               PM.INTEGRATION_STATUS IS NULL AND PM.STATUS = \
                               'Y' AND TRUNC(PM.ENTRY_DATE) > TRUNC(SYSDATE) - \
                               30 AND PM.CUST_APPROVE_STATUS IS NULL THEN \
                               'EXISTING QUOTE' WHEN (PM.STATUS = 'R' OR \
                               PM.STATUS = 'D') AND (ERD.STATUS='R' OR \
                               ERD.STATUS='D') AND PM.REMARKS NOT IN \
                               ('REFERAL') THEN 'REJECTED QUOTE' WHEN \
                               PM.INTEGRATION_STATUS IS NULL AND PM.STATUS = \
                               'Y' AND TRUNC(PM.ENTRY_DATE) < TRUNC(SYSDATE) - \
                               30 AND PM.CUST_APPROVE_STATUS IS NULL THEN \
                               'LAPSED QUOTE' END) \
                               STATUS_TYPE_NAME,ERD.REQUESTREFERENCENO \
                               REQUESTREFERENCENO  FROM  HOME_POSITION_MASTER \
                               PM JOIN MOTOR_DATA_DETAIL MDD ON  \
                               (PM.QUOTE_NO=MDD.QUOTE_NO) JOIN PERSONAL_INFO \
                               PI ON  (MDD.CUSTOMER_ID=PI.CUSTOMER_ID) JOIN \
                               LOGIN_MASTER LM ON (LM.LOGIN_ID=PM.LOGIN_ID) \
                               JOIN BROKER_COMPANY_MASTER BCM  ON \
                               (LM.OA_CODE=BCM.AGENCY_CODE) JOIN \
                               ESERVICE_REQUEST_DETAIL ERD ON (PM.QUOTE_NO = \
                               ERD.QUOTE_NO) WHERE TRUNC(PM.EFFECTIVE_DATE) \
                               BETWEEN TO_DATE (?1, 'DD/MM/YYYY') AND TO_DATE \
                               (?2, 'DD/MM/YYYY') AND  \
                               DECODE(?3,'ALL','A',PM.PRODUCT_ID) IN \
                               DECODE(?3,'ALL','A',?3)   AND  LOWER(PM.STATUS) \
                               IN (?4) AND BCM.BRANCH_CODE IN(SELECT \
                               REGEXP_SUBSTR(?5, '[^,]+', 1, LEVEL) AS DATA \
                               FROM DUAL CONNECT BY REGEXP_SUBSTR(?5, '[^,]+', \
                               1, LEVEL) IS NOT NULL) AND  (CASE WHEN  ?6='A'  \
                               THEN 'A'  ELSE  NVL(BCM.BROKER_TYPE,'J') \
                               END)=(CASE WHEN  ?6='A'  THEN 'A'  ELSE  \
                               NVL(?6,'K') END) AND PI.AMEND_ID=(SELECT \
                               MAX(AMEND_ID) FROM PERSONAL_INFO P WHERE \
                               PI.CUSTOMER_ID=P.CUSTOMER_ID)

ADMIN_PORTFOLIO_PENDINGPOLICY = SELECT   ROWNUM \
                                SNO,PI.CUST_NAME,PI.LAST_NAME,(CASE WHEN \
                                MDD.ISCOMMERCIAL_YN ='N' THEN 'PRIVATE' ELSE \
                                'COMMERCIAL'END) ISCOMMERCIAL_YN,(SELECT \
                                BRANCH_NAME FROM BRANCH_MASTER WHERE \
                                BRANCH_CODE=PM.BRANCH_CODE) \
                                BRANCH_NAME,PM.APPLICATION_ID,PM.APPLICATION_NO\
                                ,BCM.COMPANY_NAME \
                                BROKER_ORGANIZATION,PM.LOGIN_ID,PM.QUOTE_NO,PM.\
                                REMARKS, PI.FIRST_NAME, CASE  WHEN MDD.STATUS \
                                IN ('C')  THEN  FT.FINAL_PREMIUM  ELSE \
                                (PM.PREMIUM + NVL (PM.EXCESS_PREMIUM, '0'))  \
                                END  PREMIUM,NVL (PM.EXCESS_PREMIUM, '0') \
                                EXCESS_PREMIUM, \
                                PI.COMPANY_NAME,PM.POLICY_NO,TO_CHAR \
                                (PM.ENTRY_DATE,'DD/MM/YYYY')ENTRY_DATE,PM.PRODU\
                                CT_ID,(SELECT PRODUCT_NAME FROM PRODUCT_MASTER \
                                PMM  WHERE PMM.PRODUCT_ID=PM.PRODUCT_ID) \
                                PRODUCT_NAME,NVL(FT.REFERALL_REMARKS,MDD.REFERR\
                                AL_REMARKS) AS REFERAL_REMARKS,(CASE WHEN \
                                PM.STATUS='P' AND PM.INTEGRATION_STATUS ='S' \
                                THEN 'P' WHEN PM. STATUS='P' AND \
                                PM.INTEGRATION_STATUS ='F' THEN 'PD' WHEN \
                                PM.STATUS='D' AND PM.INTEGRATION_STATUS ='F' \
                                THEN 'D' WHEN PM.STATUS='Y' AND \
                                PM.CUST_APPROVE_STATUS='Y' THEN 'CAQ' WHEN \
                                PM.STATUS='Y' AND PM.CUST_APPROVE_STATUS='N' \
                                THEN 'CRQ' WHEN PM.STATUS='Y' AND \
                                PM.CUST_APPROVE_STATUS='P' THEN 'CPQ' WHEN \
                                PM.STATUS='Y' AND PM.CUST_APPROVE_STATUS='R' \
                                THEN 'CREQ' WHEN PM.STATUS='Y' AND \
                                ERD.STATUS='R' AND PM.REMARKS = 'REFERAL' THEN \
                                'UQ' WHEN PM.STATUS='Y' AND PM.REMARKS \
                                IN('ADMIN') THEN 'AQ' WHEN PM.STATUS='Y' AND \
                                (ERD.STATUS='R' OR ERD.STATUS='D') AND \
                                PM.REMARKS = 'REFERAL' AND PM.ADMIN_REMARKS IS \
                                NOT NULL AND PM.ADMIN_REFERRAL_STATUS IS NOT \
                                NULL THEN 'RRQ' WHEN PM.INTEGRATION_STATUS IS \
                                NULL AND PM.STATUS = 'Y' AND \
                                TRUNC(PM.ENTRY_DATE) > TRUNC(SYSDATE) - 30 AND \
                                PM.CUST_APPROVE_STATUS IS NULL THEN 'EQ' WHEN \
                                (PM.STATUS = 'R' OR PM.STATUS = 'D') AND \
                                (ERD.STATUS='R' OR ERD.STATUS='D') AND \
                                PM.REMARKS NOT IN ('REFERAL') THEN 'RQ' WHEN \
                                PM.INTEGRATION_STATUS IS NULL AND PM.STATUS = \
                                'Y' AND TRUNC(PM.ENTRY_DATE) < TRUNC(SYSDATE) \
                                - 30 AND PM.CUST_APPROVE_STATUS IS NULL THEN \
                                'EXQ' END) STATUS_TYPE, ( CASE WHEN \
                                PM.STATUS='P' AND PM.INTEGRATION_STATUS ='S' \
                                THEN 'POLICIES' WHEN PM.STATUS='P' AND \
                                PM.INTEGRATION_STATUS ='F' THEN 'PENDING \
                                POLICY' WHEN PM.STATUS='D' AND \
                                PM.INTEGRATION_STATUS ='F' THEN 'CANCEL \
                                POLICY' WHEN PM.STATUS='Y' AND \
                                PM.CUST_APPROVE_STATUS='Y' THEN 'CUSTOMER \
                                APPROVED QUOTE' WHEN PM.STATUS='Y' AND \
                                PM.CUST_APPROVE_STATUS='N' THEN 'CUSTOMER \
                                REJECTED QUOTE' WHEN PM.STATUS='Y' AND \
                                PM.CUST_APPROVE_STATUS='P' THEN 'CUSTOMER \
                                PENDING QUOTE' WHEN PM.STATUS='Y' AND \
                                PM.CUST_APPROVE_STATUS='R' THEN 'CUSTOMER \
                                REJECTED FOR REQUOTE' WHEN PM.STATUS='Y' AND \
                                ERD.STATUS='R' AND PM.REMARKS = 'REFERAL' THEN \
                                'REFERRAL PENDING QUOTE' WHEN PM.STATUS='Y' \
                                AND PM.REMARKS IN ('ADMIN') THEN 'REFERRAL \
                                APPROVED QUOTE' WHEN PM.STATUS='Y' AND \
                                (ERD.STATUS='R' OR ERD.STATUS='D') AND \
                                PM.REMARKS = 'REFERAL' AND PM.ADMIN_REMARKS IS \
                                NOT NULL AND PM.ADMIN_REFERRAL_STATUS IS NOT \
                                NULL THEN 'REFERRAL REJECTED QUOTE' WHEN \
                                PM.INTEGRATION_STATUS IS NULL AND PM.STATUS = \
                                'Y' AND TRUNC(PM.ENTRY_DATE) > TRUNC(SYSDATE) \
                                - 30 AND PM.CUST_APPROVE_STATUS IS NULL THEN \
                                'EXISTING QUOTE' WHEN (PM.STATUS = 'R' OR \
                                PM.STATUS = 'D') AND (ERD.STATUS='R' OR \
                                ERD.STATUS='D') AND PM.REMARKS NOT IN \
                                ('REFERAL') THEN 'REJECTED QUOTE' WHEN \
                                PM.INTEGRATION_STATUS IS NULL AND PM.STATUS = \
                                'Y' AND TRUNC(PM.ENTRY_DATE) < TRUNC(SYSDATE) \
                                - 30 AND PM.CUST_APPROVE_STATUS IS NULL THEN \
                                'LAPSED QUOTE' END) \
                                STATUS_TYPE_NAME,ERD.REQUESTREFERENCENO \
                                REQUESTREFERENCENO FROM  HOME_POSITION_MASTER \
                                PM JOIN MOTOR_DATA_DETAIL MDD ON  \
                                (PM.QUOTE_NO=MDD.QUOTE_NO) JOIN PERSONAL_INFO \
                                PI ON  (MDD.CUSTOMER_ID=PI.CUSTOMER_ID) JOIN \
                                LOGIN_MASTER LM ON (LM.LOGIN_ID=PM.LOGIN_ID) \
                                JOIN BROKER_COMPANY_MASTER BCM  ON \
                                (LM.OA_CODE=BCM.AGENCY_CODE) LEFT JOIN \
                                FACTOR_RATE_TRAN_DETAILS FT ON \
                                (FT.APPLICATION_NO=PM.APPLICATION_NO AND \
                                NVL(MDD.POLICYTYPE,14)=FT.POLICYTYPE) JOIN \
                                ESERVICE_REQUEST_DETAIL ERD ON (PM.QUOTE_NO = \
                                ERD.QUOTE_NO) WHERE TRUNC(PM.ENTRY_DATE) \
                                BETWEEN TO_DATE (?1, 'DD/MM/YYYY') AND TO_DATE \
                                (?2, 'DD/MM/YYYY') AND  \
                                DECODE(?3,'ALL','A',PM.PRODUCT_ID) IN \
                                DECODE(?3,'ALL','A',?3)   AND  \
                                LOWER(PM.STATUS) IN (?4) AND BCM.BRANCH_CODE \
                                IN(SELECT REGEXP_SUBSTR(?5, '[^,]+', 1, LEVEL) \
                                AS DATA FROM DUAL CONNECT BY REGEXP_SUBSTR(?5, \
                                '[^,]+', 1, LEVEL) IS NOT NULL) AND  (CASE \
                                WHEN  ?6='A'  THEN 'A'  ELSE  \
                                NVL(BCM.BROKER_TYPE,'J') END)=(CASE WHEN  \
                                ?6='A'  THEN 'A'  ELSE  NVL(?6,'K') END) AND \
                                PI.AMEND_ID=(SELECT MAX(AMEND_ID) FROM \
                                PERSONAL_INFO P WHERE \
                                PI.CUSTOMER_ID=P.CUSTOMER_ID)

ALL_BRANCH_LIST = SELECT ATTACHED_BRANCH FROM LOGIN_MASTER WHERE LOGIN_ID=?1

CANCEL_POLICY = SELECT HPM.POLICY_NO,(SELECT REQ_REF_NO FROM MOTOR_DATA_DETAIL \
                MDD WHERE MDD.QUOTE_NO=HPM.QUOTE_NO AND HPM.APPLICATION_NO = \
                MDD.APPLICATION_NO) REQREFNO,HPM.STATUS, HPM.APPLICATION_NO, \
                HPM.CUSTOMER_ID, HPM.OVERALL_PREMIUM, \
                TO_CHAR(HPM.EFFECTIVE_DATE, 'DD/MM/YYYY') QUOTATION_DATE, NVL \
                (PI.COMPANY_NAME, PI.FIRST_NAME) || ' ' || PI.JOINT_NAME \
                CUSTOMER_NAME, PI.LAST_NAME, HPM.LOGIN_ID, HPM.QUOTE_NO, \
                HPM.EXCESS_PREMIUM, PI.COMPANY_NAME, HPM.INCEPTION_DATE, NULL \
                OPEN_COVER_NO, HPM.AMEND_ID, BCM.COMPANY_NAME BROKER_NAME, \
                HPM.RECEIPT_NO, (SELECT DISTINCT VEHICLE_ID FROM \
                MOTOR_DATA_DETAIL MDD WHERE HPM.QUOTE_NO = MDD.QUOTE_NO AND \
                HPM.APPLICATION_NO = MDD.APPLICATION_NO) VEHICLE_ID, (SELECT \
                MPM.POLICYTYPE_DESC_ENGLISH FROM MOTOR_POLICYTYPE_MASTER MPM \
                WHERE MPM.POLICYTYPE_ID=(SELECT POLICYTYPE FROM \
                MOTOR_DATA_DETAIL MDD WHERE MDD.QUOTE_NO=HPM.QUOTE_NO AND \
                HPM.APPLICATION_NO = MDD.APPLICATION_NO)) POLICYTYPE,(SELECT \
                CASE WHEN MDD.ISCOMMERCIAL_YN ='N' THEN 'PRIVATE' ELSE \
                'COMMERCIAL' END ISCOMMERCIAL_YN FROM MOTOR_DATA_DETAIL MDD \
                WHERE HPM.QUOTE_NO = MDD.QUOTE_NO AND HPM.APPLICATION_NO = \
                MDD.APPLICATION_NO) ISCOMMERCIAL_YN FROM HOME_POSITION_MASTER \
                HPM, PERSONAL_INFO PI, BROKER_COMPANY_MASTER BCM, LOGIN_MASTER \
                LM WHERE HPM.STATUS = 'D' AND HPM.AMEND_ID = '0' AND \
                PI.CUSTOMER_ID = HPM.CUSTOMER_ID AND HPM.PRODUCT_ID =?1 AND \
                (CASE WHEN HPM.BDM_CODE IS NULL OR HPM.APPLICATION_ID = '1' \
                THEN HPM.LOGIN_ID ELSE HPM.BDM_CODE END) = ?2 AND PI.STATUS = \
                'Y' AND PI.AMEND_ID = (SELECT MAX (AMEND_ID) FROM \
                PERSONAL_INFO WHERE CUSTOMER_ID = PI.CUSTOMER_ID) AND \
                HPM.BROKER_CODE = BCM.AGENCY_CODE AND HPM.POLICY_NO IS NOT \
                NULL ORDER BY HPM.INCEPTION_DATE DESC

CIVILID_SEARCH = AND PI.CIVIL_ID=?4 ORDER BY HPM.QUOTE_NO

COMMON_SEARCHDATA = SELECT HPM.MOBILE,HPM.QUOTE_NO,TO_CHAR(hpm.EXPIRY_DATE, \
                    'DD/MM/YYYY') EXPIRY_DATE, HPM.CUSTOMER_ID,(SELECT \
                    REQUESTREFERENCENO FROM DOMESTIC_EMPLOYEE_DETAIL DED WHERE \
                    DED.QUOTE_NO=HPM.QUOTE_NO) \
                    REQREFNO,''ISCOMMERCIAL_YN,''POLICY_TYPE, TO_CHAR(HPM. \
                    ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, \
                    TO_CHAR(HPM.ENTRY_DATE, 'DD/MM/YYYY') ENTRY_DATE, TO_CHAR \
                    (HPM.EFFECTIVE_DATE, 'DD/MM/YYYY') \
                    VALIDITY_DATE,(PI.FIRST_NAME || ' ' || PI.LAST_NAME) \
                    CUSTOMER_NAME, ( CASE WHEN HPM.APPLICATION_ID='1' THEN \
                    HPM.LOGIN_ID ELSE HPM.APPLICATION_ID END) LOGIN_ID, ( \
                    SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE \
                    AGENCY_CODE = HPM.BROKER_CODE) BROKER_COMPANY_NAME, ( \
                    SELECT DISTINCT CUSTOMER_NAME FROM PREMIA_CUSTOMER_DETAILS \
                    WHERE CUSTOMER_CODE = NVL (HPM.BDM_CODE, 0)) \
                    PREMIA_CUSTOMER_NAME, TO_CHAR (HPM.INCEPTION_DATE, \
                    'DD/MM/YYYY') POLICY_START_DATE, NVL (HPM. \
                    OVERALL_PREMIUM, 0) PREMIUM, TO_CHAR (HPM.EFFECTIVE_DATE, \
                    'DD/MM/YYYY') EFFECTIVE_DATE, HPM.POLICY_NO, HPM.STATUS \
                    ORG_STATUS,( CASE WHEN HPM.STATUS='P' AND \
                    HPM.INTEGRATION_STATUS ='S' THEN 'P' WHEN HPM.STATUS='P' \
                    AND HPM.INTEGRATION_STATUS ='F' THEN 'PD' WHEN \
                    HPM.STATUS='D' AND HPM.INTEGRATION_STATUS ='F' THEN 'D' \
                    WHEN HPM.STATUS='Y' AND HPM.CUST_APPROVE_STATUS='Y'  AND \
                    (HPM.REMARKS IS NULL OR HPM.REMARKS!='Referal') THEN 'CAQ' \
                    WHEN HPM.STATUS='Y' AND HPM.CUST_APPROVE_STATUS='N'  AND \
                    (HPM.REMARKS IS NULL OR HPM.REMARKS!='Referal') THEN 'CRQ' \
                    WHEN HPM.STATUS='Y' AND HPM.CUST_APPROVE_STATUS='P'  AND \
                    (HPM.REMARKS IS NULL OR HPM.REMARKS!='Referal') THEN 'CPQ' \
                    WHEN HPM.STATUS='Y' AND HPM.CUST_APPROVE_STATUS='R'  AND \
                    (HPM.REMARKS IS NULL OR HPM.REMARKS!='Referal') THEN \
                    'CREQ' WHEN HPM.INTEGRATION_STATUS IS NULL AND HPM.STATUS \
                    = 'Y' AND TRUNC(HPM.ENTRY_DATE) > TRUNC(SYSDATE) - 30 AND \
                    HPM.CUST_APPROVE_STATUS IS NULL THEN 'EQ' WHEN HPM.STATUS \
                    = 'D' AND HPM.INTEGRATION_STATUS IS NULL AND HPM.REMARKS \
                    NOT IN ('Referal') THEN 'RQ' WHEN HPM.INTEGRATION_STATUS \
                    IS NULL AND HPM.STATUS = 'Y' AND TRUNC(HPM.ENTRY_DATE) < \
                    TRUNC(SYSDATE) - 30 AND HPM.CUST_APPROVE_STATUS IS NULL \
                    THEN 'EXQ' END) STATUS_TYPE, ( CASE WHEN HPM.STATUS='P' \
                    AND HPM.INTEGRATION_STATUS ='S' THEN 'Policies' WHEN \
                    HPM.STATUS='P' AND HPM.INTEGRATION_STATUS ='F' THEN \
                    'Pending Policy' WHEN HPM.STATUS='D' AND \
                    HPM.INTEGRATION_STATUS ='F' THEN 'Cancel Policy' WHEN \
                    HPM.STATUS='Y' AND HPM.CUST_APPROVE_STATUS='Y'  AND \
                    (HPM.REMARKS IS NULL OR HPM.REMARKS!='Referal') THEN \
                    'Customer Approved Quote' WHEN HPM.STATUS='Y' AND \
                    HPM.CUST_APPROVE_STATUS='N'  AND (HPM.REMARKS IS NULL OR \
                    HPM.REMARKS!='Referal') THEN 'Customer Rejected Quote' \
                    WHEN HPM.STATUS='Y' AND HPM.CUST_APPROVE_STATUS='P'  AND \
                    (HPM.REMARKS IS NULL OR HPM.REMARKS!='Referal') THEN \
                    'Customer Pending Quote' WHEN HPM.STATUS='Y' AND \
                    HPM.CUST_APPROVE_STATUS='R'  AND (HPM.REMARKS IS NULL OR \
                    HPM.REMARKS!='Referal') THEN 'Customer Rejected for \
                    ReQuote' WHEN HPM.INTEGRATION_STATUS IS NULL AND \
                    HPM.STATUS = 'Y' AND TRUNC(HPM.ENTRY_DATE) > \
                    TRUNC(SYSDATE) - 30 AND HPM.CUST_APPROVE_STATUS IS NULL \
                    THEN 'Existing Quote' WHEN HPM.STATUS = 'D' AND \
                    HPM.INTEGRATION_STATUS IS NULL AND HPM.REMARKS NOT IN \
                    ('Referal') THEN 'Rejected Quote' WHEN \
                    HPM.INTEGRATION_STATUS IS NULL AND HPM.STATUS = 'Y' AND \
                    TRUNC(HPM.ENTRY_DATE) < TRUNC(SYSDATE) - 30 AND \
                    HPM.CUST_APPROVE_STATUS IS NULL THEN 'Lapsed Quote' END) \
                    STATUS_TYPE_NAME,( SELECT BRANCH_NAME FROM BRANCH_MASTER \
                    WHERE BRANCH_CODE=HPM.BRANCH_CODE) BRANCH_NAME FROM \
                    HOME_POSITION_MASTER HPM, PERSONAL_INFO PI WHERE \
                    (hpm.LOGIN_ID =?1 or HPM.BDM_CODE=?1) AND HPM.CUSTOMER_ID \
                    = PI.CUSTOMER_ID  AND HPM.PRODUCT_ID = ?2 AND \
                    (HPM.APPLICATION_ID =?3 OR ?3 IS NULL) AND PI.AMEND_ID = ( \
                    SELECT MAX (AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID \
                    = PI.CUSTOMER_ID) AND PI.STATUS = 'Y'  

COMMON_SEARCHDATA_ADMIN = SELECT \
                          HPM.MOBILE,HPM.QUOTE_NO,TO_CHAR(hpm.EXPIRY_DATE, \
                          'DD/MM/YYYY') EXPIRY_DATE, HPM.CUSTOMER_ID,(SELECT \
                          REQUESTREFERENCENO FROM DOMESTIC_EMPLOYEE_DETAIL DED \
                          WHERE DED.QUOTE_NO=HPM.QUOTE_NO) \
                          REQREFNO,''ISCOMMERCIAL_YN,''POLICY_TYPE, \
                          TO_CHAR(HPM. ENTRY_DATE, 'DD/MM/YYYY') \
                          QUOTATION_DATE, TO_CHAR(HPM.ENTRY_DATE, \
                          'DD/MM/YYYY') ENTRY_DATE, TO_CHAR \
                          (HPM.EFFECTIVE_DATE, 'DD/MM/YYYY') \
                          VALIDITY_DATE,(PI.FIRST_NAME || ' ' || PI.LAST_NAME) \
                          CUSTOMER_NAME, ( CASE WHEN HPM.APPLICATION_ID='1' \
                          THEN HPM.LOGIN_ID ELSE HPM.APPLICATION_ID END) \
                          LOGIN_ID, ( SELECT COMPANY_NAME FROM \
                          BROKER_COMPANY_MASTER WHERE AGENCY_CODE = \
                          HPM.BROKER_CODE) BROKER_COMPANY_NAME, ( SELECT \
                          DISTINCT CUSTOMER_NAME FROM PREMIA_CUSTOMER_DETAILS \
                          WHERE CUSTOMER_CODE = NVL (HPM.BDM_CODE, 0)) \
                          PREMIA_CUSTOMER_NAME, TO_CHAR (HPM.INCEPTION_DATE, \
                          'DD/MM/YYYY') POLICY_START_DATE, NVL (HPM. \
                          OVERALL_PREMIUM, 0) PREMIUM, TO_CHAR \
                          (HPM.EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE, \
                          HPM.POLICY_NO, HPM.STATUS ORG_STATUS,( CASE WHEN \
                          HPM.STATUS='P' AND HPM.INTEGRATION_STATUS ='S' THEN \
                          'P' WHEN HPM.STATUS='P' AND HPM.INTEGRATION_STATUS \
                          ='F' THEN 'PD' WHEN HPM.STATUS='D' AND \
                          HPM.INTEGRATION_STATUS ='F' THEN 'D' WHEN \
                          HPM.STATUS='Y' AND HPM.CUST_APPROVE_STATUS='Y'  AND \
                          (HPM.REMARKS IS NULL OR HPM.REMARKS!='Referal') THEN \
                          'CAQ' WHEN HPM.STATUS='Y' AND \
                          HPM.CUST_APPROVE_STATUS='N'  AND (HPM.REMARKS IS \
                          NULL OR HPM.REMARKS!='Referal') THEN 'CRQ' WHEN \
                          HPM.STATUS='Y' AND HPM.CUST_APPROVE_STATUS='P'  AND \
                          (HPM.REMARKS IS NULL OR HPM.REMARKS!='Referal')  \
                          THEN 'CPQ' WHEN HPM.STATUS='Y' AND \
                          HPM.CUST_APPROVE_STATUS='R'  AND (HPM.REMARKS IS \
                          NULL OR HPM.REMARKS!='Referal') THEN 'CREQ' WHEN \
                          HPM.INTEGRATION_STATUS IS NULL AND HPM.STATUS = 'Y' \
                          AND TRUNC(HPM.ENTRY_DATE) > TRUNC(SYSDATE) - 30 AND \
                          HPM.CUST_APPROVE_STATUS IS NULL THEN 'EQ' WHEN \
                          HPM.STATUS = 'D' AND HPM.INTEGRATION_STATUS IS NULL \
                          AND HPM.REMARKS NOT IN ('Referal') THEN 'RQ' WHEN \
                          HPM.INTEGRATION_STATUS IS NULL AND HPM.STATUS = 'Y' \
                          AND TRUNC(HPM.ENTRY_DATE) < TRUNC(SYSDATE) - 30 AND \
                          HPM.CUST_APPROVE_STATUS IS NULL THEN 'EXQ' END) \
                          STATUS_TYPE, ( CASE WHEN HPM.STATUS='P' AND \
                          HPM.INTEGRATION_STATUS ='S' THEN 'Policies' WHEN \
                          HPM.STATUS='P' AND HPM.INTEGRATION_STATUS ='F' THEN \
                          'Pending Policy' WHEN HPM.STATUS='D' AND \
                          HPM.INTEGRATION_STATUS ='F' THEN 'Cancel Policy' \
                          WHEN HPM.STATUS='Y' AND HPM.CUST_APPROVE_STATUS='Y'  \
                          AND (HPM.REMARKS IS NULL OR HPM.REMARKS!='Referal') \
                          THEN 'Customer Approved Quote' WHEN HPM.STATUS='Y' \
                          AND HPM.CUST_APPROVE_STATUS='N'  AND (HPM.REMARKS IS \
                          NULL OR HPM.REMARKS!='Referal') THEN 'Customer \
                          Rejected Quote' WHEN HPM.STATUS='Y' AND \
                          HPM.CUST_APPROVE_STATUS='P'  AND (HPM.REMARKS IS \
                          NULL OR HPM.REMARKS!='Referal') THEN 'Customer \
                          Pending Quote' WHEN HPM.STATUS='Y' AND \
                          HPM.CUST_APPROVE_STATUS='R'  AND (HPM.REMARKS IS \
                          NULL OR HPM.REMARKS!='Referal') THEN 'Customer \
                          Rejected for ReQuote' WHEN HPM.INTEGRATION_STATUS IS \
                          NULL AND HPM.STATUS = 'Y' AND TRUNC(HPM.ENTRY_DATE) \
                          > TRUNC(SYSDATE) - 30 AND HPM.CUST_APPROVE_STATUS IS \
                          NULL THEN 'Existing Quote' WHEN HPM.STATUS = 'D' AND \
                          HPM.INTEGRATION_STATUS IS NULL AND HPM.REMARKS NOT \
                          IN ('Referal') THEN 'Rejected Quote' WHEN \
                          HPM.INTEGRATION_STATUS IS NULL AND HPM.STATUS = 'Y' \
                          AND TRUNC(HPM.ENTRY_DATE) < TRUNC(SYSDATE) - 30 AND \
                          HPM.CUST_APPROVE_STATUS IS NULL THEN 'Lapsed Quote' \
                          END) STATUS_TYPE_NAME,?1 DOC_NO,?3 APPLICATION_ID,( \
                          SELECT BRANCH_NAME FROM BRANCH_MASTER WHERE \
                          BRANCH_CODE=HPM.BRANCH_CODE) BRANCH_NAME FROM \
                          HOME_POSITION_MASTER HPM, PERSONAL_INFO PI WHERE \
                          HPM.CUSTOMER_ID = PI.CUSTOMER_ID AND HPM.PRODUCT_ID \
                          = ?2 AND PI.AMEND_ID = ( SELECT MAX (AMEND_ID) FROM \
                          PERSONAL_INFO WHERE CUSTOMER_ID = PI.CUSTOMER_ID) \
                          AND PI.STATUS = 'Y'  

COMMON_SEARCHDATA_WO_LOGINID = SELECT \
                               HPM.MOBILE,HPM.QUOTE_NO,TO_CHAR(hpm.EXPIRY_DATE,\
                                'DD/MM/YYYY') EXPIRY_DATE, \
                               HPM.CUSTOMER_ID,(SELECT REQUESTREFERENCENO FROM \
                               DOMESTIC_EMPLOYEE_DETAIL DED WHERE \
                               DED.QUOTE_NO=HPM.QUOTE_NO) \
                               REQREFNO,''ISCOMMERCIAL_YN,''POLICY_TYPE, \
                               TO_CHAR(HPM. ENTRY_DATE, 'DD/MM/YYYY') \
                               QUOTATION_DATE, TO_CHAR(HPM.ENTRY_DATE, \
                               'DD/MM/YYYY') ENTRY_DATE, TO_CHAR \
                               (HPM.EFFECTIVE_DATE, 'DD/MM/YYYY') \
                               VALIDITY_DATE,(PI.FIRST_NAME || ' ' || \
                               PI.LAST_NAME) CUSTOMER_NAME, ( CASE WHEN \
                               HPM.APPLICATION_ID='1' THEN HPM.LOGIN_ID ELSE \
                               HPM.APPLICATION_ID END) LOGIN_ID, ( SELECT \
                               COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE \
                               AGENCY_CODE = HPM.BROKER_CODE) \
                               BROKER_COMPANY_NAME, ( SELECT DISTINCT \
                               CUSTOMER_NAME FROM PREMIA_CUSTOMER_DETAILS \
                               WHERE CUSTOMER_CODE = NVL (HPM.BDM_CODE, 0)) \
                               PREMIA_CUSTOMER_NAME, TO_CHAR \
                               (HPM.INCEPTION_DATE, 'DD/MM/YYYY') \
                               POLICY_START_DATE, NVL (HPM. OVERALL_PREMIUM, \
                               0) PREMIUM, TO_CHAR (HPM.EFFECTIVE_DATE, \
                               'DD/MM/YYYY') EFFECTIVE_DATE, HPM.POLICY_NO, \
                               HPM.STATUS ORG_STATUS,( CASE WHEN \
                               HPM.STATUS='P' AND HPM.INTEGRATION_STATUS ='S' \
                               THEN 'P' WHEN HPM.STATUS='P' AND \
                               HPM.INTEGRATION_STATUS ='F' THEN 'PD' WHEN \
                               HPM.STATUS='D' AND HPM.INTEGRATION_STATUS ='F' \
                               THEN 'D' WHEN HPM.STATUS='Y' AND \
                               HPM.CUST_APPROVE_STATUS='Y'  AND (HPM.REMARKS \
                               IS NULL OR HPM.REMARKS!='Referal') THEN 'CAQ' \
                               WHEN HPM.STATUS='Y' AND \
                               HPM.CUST_APPROVE_STATUS='N'  AND (HPM.REMARKS \
                               IS NULL OR HPM.REMARKS!='Referal') THEN 'CRQ' \
                               WHEN HPM.STATUS='Y' AND \
                               HPM.CUST_APPROVE_STATUS='P'  AND (HPM.REMARKS \
                               IS NULL OR HPM.REMARKS!='Referal') THEN 'CPQ' \
                               WHEN HPM.STATUS='Y' AND \
                               HPM.CUST_APPROVE_STATUS='R'  AND (HPM.REMARKS \
                               IS NULL OR HPM.REMARKS!='Referal') THEN 'CREQ' \
                               WHEN HPM.INTEGRATION_STATUS IS NULL AND \
                               HPM.STATUS = 'Y' AND TRUNC(HPM.ENTRY_DATE) > \
                               TRUNC(SYSDATE) - 30 AND HPM.CUST_APPROVE_STATUS \
                               IS NULL THEN 'EQ' WHEN HPM.STATUS = 'D' AND \
                               HPM.INTEGRATION_STATUS IS NULL AND HPM.REMARKS \
                               NOT IN ('Referal') THEN 'RQ' WHEN \
                               HPM.INTEGRATION_STATUS IS NULL AND HPM.STATUS = \
                               'Y' AND TRUNC(HPM.ENTRY_DATE) < TRUNC(SYSDATE) \
                               - 30 AND HPM.CUST_APPROVE_STATUS IS NULL THEN \
                               'EXQ' END) STATUS_TYPE, ( CASE WHEN \
                               HPM.STATUS='P' AND HPM.INTEGRATION_STATUS ='S' \
                               THEN 'Policies' WHEN HPM.STATUS='P' AND \
                               HPM.INTEGRATION_STATUS ='F' THEN 'Pending \
                               Policy' WHEN HPM.STATUS='D' AND \
                               HPM.INTEGRATION_STATUS ='F' THEN 'Cancel \
                               Policy' WHEN HPM.STATUS='Y' AND \
                               HPM.CUST_APPROVE_STATUS='Y'  AND (HPM.REMARKS \
                               IS NULL OR HPM.REMARKS!='Referal') THEN \
                               'Customer Approved Quote' WHEN HPM.STATUS='Y' \
                               AND HPM.CUST_APPROVE_STATUS='N'  AND \
                               (HPM.REMARKS IS NULL OR HPM.REMARKS!='Referal') \
                               THEN 'Customer Rejected Quote' WHEN \
                               HPM.STATUS='Y' AND HPM.CUST_APPROVE_STATUS='P'  \
                               AND (HPM.REMARKS IS NULL OR \
                               HPM.REMARKS!='Referal') THEN 'Customer Pending \
                               Quote' WHEN HPM.STATUS='Y' AND \
                               HPM.CUST_APPROVE_STATUS='R'  AND (HPM.REMARKS \
                               IS NULL OR HPM.REMARKS!='Referal') THEN \
                               'Customer Rejected for ReQuote' WHEN \
                               HPM.INTEGRATION_STATUS IS NULL AND HPM.STATUS = \
                               'Y' AND TRUNC(HPM.ENTRY_DATE) > TRUNC(SYSDATE) \
                               - 30 AND HPM.CUST_APPROVE_STATUS IS NULL THEN \
                               'Existing Quote' WHEN HPM.STATUS = 'D' AND \
                               HPM.INTEGRATION_STATUS IS NULL AND HPM.REMARKS \
                               NOT IN ('Referal') THEN 'Rejected Quote' WHEN \
                               HPM.INTEGRATION_STATUS IS NULL AND HPM.STATUS = \
                               'Y' AND TRUNC(HPM.ENTRY_DATE) < TRUNC(SYSDATE) \
                               - 30 AND HPM.CUST_APPROVE_STATUS IS NULL THEN \
                               'Lapsed Quote' END) STATUS_TYPE_NAME,?1 \
                               DOC_NO,( SELECT BRANCH_NAME FROM BRANCH_MASTER \
                               WHERE BRANCH_CODE=HPM.BRANCH_CODE) BRANCH_NAME \
                               FROM HOME_POSITION_MASTER HPM, PERSONAL_INFO PI \
                               WHERE HPM.CUSTOMER_ID = PI.CUSTOMER_ID  AND \
                               HPM.PRODUCT_ID = ?2 AND (HPM.APPLICATION_ID =?3 \
                               OR ?3 IS NULL) AND PI.AMEND_ID = ( SELECT MAX \
                               (AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID \
                               = PI.CUSTOMER_ID) AND PI.STATUS = 'Y'  

COPYQUOTE = SELECT DETAIL_NAME CODE,REMARKS CODEDESC FROM \
            MARINE_CONSTANT_DETAIL WHERE PRODUCT_ID=?1 AND RSACODE='COPY \
            QUOTE' AND STATUS='Y'

CUSTOMERCODE_SEARCH = AND PI.MISSIPPI_CUSTOMER_CODE=?4 ORDER BY HPM.QUOTE_NO

DOMESTIC_ACTIVE_POLICY = SELECT HPM.POLICY_NO,(SELECT REQUESTREFERENCENO FROM \
                         DOMESTIC_EMPLOYEE_DETAIL MDD WHERE MDD. \
                         QUOTE_NO=HPM.QUOTE_NO AND HPM.APPLICATION_NO = \
                         MDD.APPLICATION_NO) REQREFNO,( SELECT \
                         MPM.POLICYTYPE_DESC_ENGLISH FROM \
                         DOMESTIC_POLICYTYPE_MASTER MPM WHERE \
                         MPM.POLICYTYPE_ID=( SELECT POLICYTYPE FROM \
                         DOMESTIC_EMPLOYEE_DETAIL MDD WHERE \
                         MDD.QUOTE_NO=HPM.QUOTE_NO AND HPM.APPLICATION_NO = \
                         MDD.APPLICATION_NO)) POLICY_TYPE,HPM. CUSTOMER_ID, \
                         HPM.OVERALL_PREMIUM, TO_CHAR(HPM.ENTRY_DATE, \
                         'DD/MM/YYYY') QUOTATION_DATE, (PI.FIRST_NAME || ' ' \
                         || PI. LAST_NAME) CUSTOMER_NAME, PI.LAST_NAME, \
                         HPM.LOGIN_ID, HPM.QUOTE_NO, HPM. EXCESS_PREMIUM, \
                         PI.COMPANY_NAME, TO_CHAR (HPM.INCEPTION_DATE, \
                         'DD/MM/YYYY') INCEPTION_DATE, NULL OPEN_COVER_NO, \
                         HPM.AMEND_ID, HPM. RECEIPT_NO, BCM.COMPANY_NAME \
                         BROKER_NAME, '' TRAVEL_COVER_ID,PI.MODE_OF_PAYMENT,'' \
                         ISCOMMERCIAL_YN FROM HOME_POSITION_MASTER HPM, \
                         PERSONAL_INFO PI, BROKER_COMPANY_MASTER BCM WHERE ( \
                         CASE WHEN HPM.BDM_CODE IS NULL OR HPM.APPLICATION_ID \
                         = '1' THEN HPM.LOGIN_ID ELSE HPM.BDM_CODE END) =?1 \
                         AND HPM.STATUS = 'P' AND HPM.AMEND_ID = '0' AND \
                         PI.CUSTOMER_ID = HPM.CUSTOMER_ID AND HPM.PRODUCT_ID = \
                         ?2 AND PI.STATUS = 'Y' AND PI.AMEND_ID = ( SELECT MAX \
                         (AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = \
                         PI.CUSTOMER_ID) AND HPM.BROKER_CODE = BCM.AGENCY_CODE \
                         AND (HPM.APPLICATION_ID=?3 OR ?3 IS NULL) AND \
                         HPM.INTEGRATION_ERROR IS NULL ORDER BY HPM.ENTRY_DATE \
                         DESC

DOMESTIC_BROKER = SELECT * FROM (SELECT LOGIN_ID CODE ,USERNAME CODEDESC FROM \
                  LOGIN_MASTER WHERE  OA_CODE = (SELECT OA_CODE  FROM \
                  LOGIN_MASTER WHERE LOGIN_ID =?1 AND USERTYPE != 'Customer' \
                  AND USERTYPE != 'Freight') AND USERTYPE != 'Freight' AND \
                  STATUS='Y' AND LOGIN_ID IN ( SELECT DISTINCT (A.LOGIN_ID)  \
                  FROM DOMESTIC_EMPLOYEE_DETAIL A, PERSONAL_INFO B  WHERE  \
                  (A.CUSTOMER_ID = B.CUSTOMER_ID OR A.CUSTOMER_ID IS NULL) AND (B.STATUS = 'Y' OR B.STATUS IS NULL)) ) order \
                  by CODEDESC

DOMESTIC_CANCEL_POLICY = SELECT HPM.POLICY_NO,(SELECT REQUESTREFERENCENO FROM \
                         DOMESTIC_EMPLOYEE_DETAIL MDD WHERE MDD. \
                         QUOTE_NO=HPM.QUOTE_NO AND HPM.APPLICATION_NO = \
                         MDD.APPLICATION_NO) REQREFNO,HPM.STATUS, HPM. \
                         APPLICATION_NO, HPM.CUSTOMER_ID, HPM.OVERALL_PREMIUM, \
                         TO_CHAR(HPM. EFFECTIVE_DATE, 'DD/MM/YYYY') \
                         QUOTATION_DATE, (PI.FIRST_NAME || ' ' || PI. \
                         LAST_NAME) CUSTOMER_NAME, PI.LAST_NAME, HPM. \
                         LOGIN_ID, HPM.QUOTE_NO, HPM.EXCESS_PREMIUM, \
                         PI.COMPANY_NAME, HPM. INCEPTION_DATE, NULL \
                         OPEN_COVER_NO, HPM.AMEND_ID, BCM.COMPANY_NAME \
                         BROKER_NAME, HPM.RECEIPT_NO, ( SELECT \
                         MPM.POLICYTYPE_DESC_ENGLISH FROM \
                         DOMESTIC_POLICYTYPE_MASTER MPM WHERE \
                         MPM.POLICYTYPE_ID=( SELECT POLICYTYPE FROM \
                         DOMESTIC_EMPLOYEE_DETAIL MDD WHERE \
                         MDD.QUOTE_NO=HPM.QUOTE_NO AND HPM.APPLICATION_NO = \
                         MDD.APPLICATION_NO)) POLICYTYPE,'' ISCOMMERCIAL_YN \
                         FROM HOME_POSITION_MASTER HPM, PERSONAL_INFO PI, \
                         BROKER_COMPANY_MASTER BCM, LOGIN_MASTER LM WHERE \
                         HPM.STATUS = 'D' AND HPM.AMEND_ID = '0' AND \
                         PI.CUSTOMER_ID = HPM.CUSTOMER_ID AND HPM.PRODUCT_ID \
                         =?1 AND ( CASE WHEN HPM.BDM_CODE IS NULL OR \
                         HPM.APPLICATION_ID = '1' THEN HPM.LOGIN_ID ELSE \
                         HPM.BDM_CODE END) = ?2 AND PI.STATUS = 'Y' AND \
                         PI.AMEND_ID = ( SELECT MAX (AMEND_ID) FROM \
                         PERSONAL_INFO WHERE CUSTOMER_ID = PI.CUSTOMER_ID) AND \
                         HPM.BROKER_CODE = BCM.AGENCY_CODE AND HPM.POLICY_NO \
                         IS NOT NULL ORDER BY HPM.INCEPTION_DATE DESC

DOMESTIC_EXPIRE_DATA = SELECT ERD.REQUESTREFERENCENO, ERD.QUOTE_NO, \
                       ERD.STATUS, ERD.CUSTOMER_ID, \
                       TO_CHAR(ERD.ENTRY_DATE,'DD/MM/YYYY') \
                       QUOTATION_DATE,(PI.FIRST_NAME ||' ' || PI.LAST_NAME) \
                       CUSTOMER_NAME, ERD.OVERALL_PREMIUM PREMIUM,'' \
                       LAPSED_REMARKS,'' LAPSED_DATE,''VALIDITY_DATE, \
                       ERD.LOGIN_ID FROM DOMESTIC_EMPLOYEE_DETAIL ERD, \
                       PERSONAL_INFO PI WHERE  (CASE WHEN ERD.BDM_CODE IS NULL \
                       OR ERD.APPLICATION_ID = '1' THEN ERD.LOGIN_ID ELSE \
                       ERD.BDM_CODE END)=?1 AND TRUNC (ERD.ENTRY_DATE) < \
                       TRUNC(SYSDATE) - 30 AND (ERD.APPLICATION_ID =?2 OR ?2 \
                       IS NULL) AND ERD.STATUS = 'Y' AND PI.CUSTOMER_ID = \
                       ERD.CUSTOMER_ID AND ERD.QUOTE_NO IS NOT NULL AND \
                       PI.AMEND_ID = ( SELECT MAX (AMEND_ID) FROM \
                       PERSONAL_INFO WHERE CUSTOMER_ID = PI.CUSTOMER_ID) AND \
                       PI.STATUS = 'Y' AND ERD.BRANCH_CODE=?3 ORDER BY \
                       QUOTE_NO DESC

DOMESTIC_ISSUER_BROKER = SELECT * FROM (SELECT DISTINCT PM.LOGIN_ID CODE, \
                         PM.LOGIN_ID FIRST_NAME, BCM.COMPANY_NAME CODEDESC, \
                         LM.OA_CODE FROM DOMESTIC_EMPLOYEE_DETAIL PM, \
                         LOGIN_MASTER LM, BROKER_COMPANY_MASTER BCM WHERE \
                         LM.LOGIN_ID = PM.LOGIN_ID AND LM.AGENCY_CODE = \
                         BCM.AGENCY_CODE AND PM.STATUS IN ('P', 'Y','R') AND \
                         BCM.BRANCH_CODE = ?1 AND PM.BROKER_CODE = \
                         BCM.AGENCY_CODE AND PM.BDM_CODE IS NULL AND lm.status \
                         = 'Y' AND BCM.status = 'Y' AND LM.OA_CODE NOT IN \
                         (SELECT BROKER_CODE FROM LOGIN_RSAUSER_DETAILS WHERE \
                         LOGIN_ID = ?2 AND PRODUCT_ID = ?3) UNION ALL SELECT \
                         DISTINCT LM.LOGIN_ID CODE, USERNAME, USERNAME \
                         CODEDESC, LM.OA_CODE FROM login_master lm, \
                         DOMESTIC_EMPLOYEE_DETAIL PM WHERE lm.usertype = \
                         'User' AND lm.BRANCH_CODE = ?1 AND lm.OA_CODE != \
                         '90016' AND PM.STATUS IN ('P', 'Y','R') AND \
                         PM.login_id = lm.login_id AND PM.broker_code = \
                         lm.agency_code AND PM.BDM_CODE IS NULL AND \
                         lm.AGENCY_CODE IN (SELECT DISTINCT AGENCY_CODE FROM \
                         LOGIN_USER_DETAILS LR WHERE PRODUCT_ID = ?3 AND \
                         STATUS = 'Y' AND LR.LOGIN_ID = lm.LOGIN_ID) AND \
                         lm.status = 'Y' UNION ALL SELECT DISTINCT \
                         pcd.CUSTOMER_CODE CODE, pcd.CUSTOMER_NAME, \
                         pcd.CUSTOMER_NAME CODEDESC, pcd.CUSTOMER_CODE FROM \
                         PREMIA_CUSTOMER_DETAILS pcd, DOMESTIC_EMPLOYEE_DETAIL \
                         PM WHERE CUSTOMER_TYPE = '009' AND CUSTOMER_CATEGORY \
                         =(SELECT CORE_APP_CODE FROM BRANCH_MASTER WHERE \
                         STATUS='Y' AND BRANCH_CODE=?1) AND  \
                         ((SELECT CORE_APP_CODE FROM branch_master WHERE status = 'Y' AND branch_code = ?1) BETWEEN DIVISION_FROM AND DIVISION_TO) \
                         AND PM.BDM_CODE IS NOT NULL AND PM.BDM_CODE = \
                         pcd.CUSTOMER_CODE AND PM.STATUS IN ('P', 'Y','R','D') AND \
                         pcd.status = 'Y') ORDER BY CODEDESC

DOMESTIC_PENDING_POLICY = SELECT A.QUOTE_NO, A.LAPSED_REMARKS, \
                          TO_DATE(A.LAPSED_DATE, 'DD/MM/YYYY') LAPSED_DATE, \
                          A.CUSTOMER_ID, TO_CHAR(A.ENTRY_DATE, 'DD/MM/YYYY') \
                          AS QUOTATION_DATE,( B.FIRST_NAME || ' ' || \
                          B.LAST_NAME) CUSTOMER_NAME, A. LOGIN_ID, \
                          A.APPLICATION_NO , B.COMPANY_NAME, \
                          ERD.REQUESTREFERENCENO, A. OVERALL_PREMIUM PREMIUM, \
                          TO_CHAR(A. INCEPTION_DATE, 'DD/MM/YYYY') \
                          INCEPTION_DATE, A.EXPIRY_DATE, B.EMAIL, '' \
                          ISCOMMERCIAL_YN,( SELECT MPM.POLICYTYPE_DESC_ENGLISH \
                          FROM DOMESTIC_POLICYTYPE_MASTER MPM WHERE \
                          MPM.POLICYTYPE_ID=ERD.POLICYTYPE) POLICY_TYPE FROM \
                          HOME_POSITION_MASTER A, PERSONAL_INFO B, \
                          DOMESTIC_EMPLOYEE_DETAIL ERD WHERE ( CASE WHEN \
                          A.BDM_CODE IS NULL OR A.APPLICATION_ID = '1' THEN \
                          A.LOGIN_ID ELSE A.BDM_CODE END) = ?1 AND \
                          A.INTEGRATION_STATUS = 'F' AND B.CUSTOMER_ID = \
                          A.CUSTOMER_ID AND A.PRODUCT_ID =?2 AND \
                          (A.APPLICATION_ID=?3 OR ?3 IS NULL) AND ERD.QUOTE_NO \
                          = A.QUOTE_NO AND B.AMEND_ID = ( SELECT MAX \
                          (AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = \
                          B.CUSTOMER_ID) AND B.STATUS = 'Y' ORDER BY QUOTE_NO \
                          DESC

DOMESTIC_REJECTED_DATA = SELECT \
                         DED.REQUESTREFERENCENO,DED.APPLICATION_NO,DED.QUOTE_NO\
                         ,'' LAPSED_REMARKS,'' LAPSED_DATE, DED.CUSTOMER_ID, \
                         TO_CHAR(DED.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, \
                         '' VALIDITY_PERIOD, PI.FIRST_NAME || ' ' || \
                         PI.LAST_NAME CUSTOMER_NAME, DED.LOGIN_ID, DED.STATUS, \
                         PI. COMPANY_NAME, 'REJECTED' \
                         REJECT_DESC,DED.OVERALL_PREMIUM PREMIUM FROM \
                         DOMESTIC_EMPLOYEE_DETAIL DED, PERSONAL_INFO PI WHERE \
                         DED.STATUS IN('D') AND (CASE WHEN DED.BDM_CODE IS \
                         NULL OR DED.APPLICATION_ID = '1' THEN DED.LOGIN_ID \
                         ELSE DED.BDM_CODE END)=?1 AND PI.CUSTOMER_ID = \
                         DED.CUSTOMER_ID AND (DED.APPLICATION_ID =?2 OR ?2 IS \
                         NULL) AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM \
                         PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID) AND \
                         PI.STATUS='Y' AND DED.BRANCH_CODE=?3 ORDER BY \
                         QUOTE_NO DESC

DOMESTIC_REQREFNO_SEARCH = SELECT ERD.REQUESTREFERENCENO REQREFNO, \
                           ERD.POLICYENDDATE EXPIRY_DATE,ERD.SPONSOR_MOBILE_NO \
                           MOBILE,ERD.SPONSOR_MOBILE_NO MOBILE, ERD.QUOTE_NO, \
                           ERD.POLICY_NO, TO_CHAR(ERD.ENTRY_DATE, \
                           'DD/MM/YYYY') EFFECTIVE_DATE, ''ISCOMMERCIAL_YN, '' \
                           POLICY_TYPE, ERD.INSURED_NAME || ' ' || \
                           ERD.INSURED_LAST_NAME CUSTOMER_NAME, TO_CHAR \
                           (ERD.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, \
                           (CASE WHEN ERD.APPLICATION_ID = '1' THEN \
                           ERD.LOGIN_ID ELSE ERD.APPLICATION_ID END) LOGIN_ID, \
                           (SELECT HPM.OVERALL_PREMIUM FROM \
                           HOME_POSITION_MASTER HPM WHERE HPM.QUOTE_NO = \
                           ERD.QUOTE_NO) PREMIUM, ERD.POLICYSTARTDATE \
                           POLICY_START_DATE, (CASE WHEN ERD.STATUS = 'P' AND \
                           ERD.INTEGRATION_STATUS = 'S' THEN 'P' WHEN \
                           ERD.STATUS = 'P' AND ERD.INTEGRATION_STATUS = 'F' \
                           THEN 'PD' WHEN ERD.STATUS = 'D' AND \
                           ERD.INTEGRATION_STATUS = 'F' THEN 'D' WHEN \
                           ERD.STATUS = 'Y' AND ERD.CUST_APPROVE_STATUS = 'Y' \
                           THEN 'CAQ' WHEN ERD.STATUS = 'Y' AND \
                           ERD.CUST_APPROVE_STATUS = 'N' THEN 'CRQ' WHEN \
                           ERD.STATUS = 'Y' AND ERD.CUST_APPROVE_STATUS = 'P' \
                           THEN 'CPQ' WHEN ERD.STATUS = 'Y' AND \
                           ERD.CUST_APPROVE_STATUS = 'R' THEN 'CREQ' WHEN \
                           ERD.INTEGRATION_STATUS IS NULL AND ERD.STATUS = 'Y' \
                           AND TRUNC (ERD.ENTRY_DATE) > TRUNC (SYSDATE) - 30 \
                           AND ERD.CUST_APPROVE_STATUS IS NULL THEN 'EQ' WHEN \
                           ERD.STATUS = 'D' AND HPM.REMARKS NOT IN ('Referal') \
                           THEN 'RQ' WHEN ERD.INTEGRATION_STATUS IS NULL AND \
                           ERD.STATUS = 'Y' AND TRUNC (ERD.ENTRY_DATE) < TRUNC \
                           (SYSDATE) - 30 AND ERD.CUST_APPROVE_STATUS IS NULL \
                           THEN 'EXQ' END) STATUS_TYPE, (CASE WHEN ERD.STATUS \
                           = 'P' AND ERD.INTEGRATION_STATUS = 'S' THEN \
                           'Policies' WHEN ERD.STATUS = 'P' AND \
                           ERD.INTEGRATION_STATUS = 'F' THEN 'Pending Policy' \
                           WHEN ERD.STATUS = 'D' AND ERD.INTEGRATION_STATUS = \
                           'F' THEN 'Cancel Policy' WHEN ERD.STATUS = 'Y' AND \
                           ERD.CUST_APPROVE_STATUS = 'Y' THEN 'Customer \
                           Approved Quote' WHEN ERD.STATUS = 'Y' AND \
                           ERD.CUST_APPROVE_STATUS = 'N' THEN 'Customer \
                           Rejected Quote' WHEN ERD.STATUS = 'Y' AND \
                           ERD.CUST_APPROVE_STATUS = 'P' THEN 'Customer \
                           Pending Quote' WHEN ERD.STATUS = 'Y' AND \
                           ERD.CUST_APPROVE_STATUS = 'R' THEN 'Customer \
                           Rejected for ReQuote' WHEN ERD.INTEGRATION_STATUS \
                           IS NULL AND ERD.STATUS = 'Y' AND TRUNC \
                           (ERD.ENTRY_DATE) > TRUNC (SYSDATE) - 30 AND \
                           ERD.CUST_APPROVE_STATUS IS NULL THEN 'Existing \
                           Quote' WHEN ERD.STATUS = 'D' AND HPM.REMARKS NOT IN \
                           ('Referal') THEN 'Rejected Quote' WHEN \
                           ERD.INTEGRATION_STATUS IS NULL AND ERD.STATUS = 'Y' \
                           AND TRUNC (ERD.ENTRY_DATE) < TRUNC (SYSDATE) - 30 \
                           AND ERD.CUST_APPROVE_STATUS IS NULL THEN 'Lapsed \
                           Quote' END) STATUS_TYPE_NAME, (SELECT BRANCH_NAME \
                           FROM BRANCH_MASTER WHERE BRANCH_CODE = \
                           ERD.BRANCH_CODE) BRANCH_NAME, ERD.STATUS ORG_STATUS \
                           FROM DOMESTIC_EMPLOYEE_DETAIL ERD, \
                           HOME_POSITION_MASTER HPM WHERE (ERD.LOGIN_ID = ?1 \
                           OR ERD.BDM_CODE = ?1) AND ERD.PRODUCT_ID = ?2 AND \
                           ERD.QUOTE_NO = HPM.QUOTE_NO(+) AND \
                           (ERD.APPLICATION_ID = ?3 OR ?3 IS NULL)  

DOMESTIC_REQ_REF_NO_ADMIN = SELECT ERD.REQUESTREFERENCENO REQREFNO, \
                            ERD.POLICYENDDATE \
                            EXPIRY_DATE,ERD.SPONSOR_MOBILE_NO MOBILE, \
                            ERD.QUOTE_NO, ERD.POLICY_NO, \
                            TO_CHAR(ERD.ENTRY_DATE, 'DD/MM/YYYY') \
                            EFFECTIVE_DATE, ''ISCOMMERCIAL_YN, '' POLICY_TYPE, \
                            ERD.INSURED_NAME || ' ' || ERD.INSURED_LAST_NAME \
                            CUSTOMER_NAME, TO_CHAR (ERD.ENTRY_DATE, \
                            'DD/MM/YYYY') QUOTATION_DATE, (CASE WHEN \
                            ERD.APPLICATION_ID = '1' THEN ERD.LOGIN_ID ELSE \
                            ERD.APPLICATION_ID END) LOGIN_ID, (SELECT \
                            HPM.OVERALL_PREMIUM FROM HOME_POSITION_MASTER HPM \
                            WHERE HPM.QUOTE_NO = ERD.QUOTE_NO) PREMIUM, \
                            ERD.POLICYSTARTDATE POLICY_START_DATE, (CASE WHEN \
                            ERD.STATUS = 'P' AND ERD.INTEGRATION_STATUS = 'S' \
                            THEN 'P' WHEN ERD.STATUS = 'P' AND \
                            ERD.INTEGRATION_STATUS = 'F' THEN 'PD' WHEN \
                            ERD.STATUS = 'D' AND ERD.INTEGRATION_STATUS = 'F' \
                            THEN 'D' WHEN ERD.STATUS = 'Y' AND \
                            ERD.CUST_APPROVE_STATUS = 'Y' THEN 'CAQ' WHEN \
                            ERD.STATUS = 'Y' AND ERD.CUST_APPROVE_STATUS = 'N' \
                            THEN 'CRQ' WHEN ERD.STATUS = 'Y' AND \
                            ERD.CUST_APPROVE_STATUS = 'P' THEN 'CPQ' WHEN \
                            ERD.STATUS = 'Y' AND ERD.CUST_APPROVE_STATUS = 'R' \
                            THEN 'CREQ' WHEN ERD.INTEGRATION_STATUS IS NULL \
                            AND ERD.STATUS = 'Y' AND TRUNC (ERD.ENTRY_DATE) > \
                            TRUNC (SYSDATE) - 30 AND ERD.CUST_APPROVE_STATUS \
                            IS NULL THEN 'EQ' WHEN ERD.STATUS = 'D' AND \
                            HPM.REMARKS NOT IN ('Referal') THEN 'RQ' WHEN \
                            ERD.INTEGRATION_STATUS IS NULL AND ERD.STATUS = \
                            'Y' AND TRUNC (ERD.ENTRY_DATE) < TRUNC (SYSDATE) - \
                            30 AND ERD.CUST_APPROVE_STATUS IS NULL THEN 'EXQ' \
                            END) STATUS_TYPE, (CASE WHEN ERD.STATUS = 'P' AND \
                            ERD.INTEGRATION_STATUS = 'S' THEN 'Policies' WHEN \
                            ERD.STATUS = 'P' AND ERD.INTEGRATION_STATUS = 'F' \
                            THEN 'Pending Policy' WHEN ERD.STATUS = 'D' AND \
                            ERD.INTEGRATION_STATUS = 'F' THEN 'Cancel Policy' \
                            WHEN ERD.STATUS = 'Y' AND ERD.CUST_APPROVE_STATUS \
                            = 'Y' THEN 'Customer Approved Quote' WHEN \
                            ERD.STATUS = 'Y' AND ERD.CUST_APPROVE_STATUS = 'N' \
                            THEN 'Customer Rejected Quote' WHEN ERD.STATUS = \
                            'Y' AND ERD.CUST_APPROVE_STATUS = 'P' THEN \
                            'Customer Pending Quote' WHEN ERD.STATUS = 'Y' AND \
                            ERD.CUST_APPROVE_STATUS = 'R' THEN 'Customer \
                            Rejected for ReQuote' WHEN ERD.INTEGRATION_STATUS \
                            IS NULL AND ERD.STATUS = 'Y' AND TRUNC \
                            (ERD.ENTRY_DATE) > TRUNC (SYSDATE) - 30 AND \
                            ERD.CUST_APPROVE_STATUS IS NULL THEN 'Existing \
                            Quote' WHEN ERD.STATUS = 'D' AND HPM.REMARKS NOT \
                            IN ('Referal') THEN 'Rejected Quote' WHEN \
                            ERD.INTEGRATION_STATUS IS NULL AND ERD.STATUS = \
                            'Y' AND TRUNC (ERD.ENTRY_DATE) < TRUNC (SYSDATE) - \
                            30 AND ERD.CUST_APPROVE_STATUS IS NULL THEN \
                            'Lapsed Quote' END) STATUS_TYPE_NAME,?1,?3, \
                            (SELECT BRANCH_NAME FROM BRANCH_MASTER WHERE \
                            BRANCH_CODE = ERD.BRANCH_CODE) BRANCH_NAME, \
                            ERD.STATUS ORG_STATUS FROM \
                            DOMESTIC_EMPLOYEE_DETAIL ERD, HOME_POSITION_MASTER \
                            HPM WHERE ERD.PRODUCT_ID = ?2 AND ERD.QUOTE_NO = \
                            HPM.QUOTE_NO(+)          

DOMESTIC_REQ_REF_NO_SEARCH_WO_LOGINID = SELECT ERD.REQUESTREFERENCENO \
                                        REQREFNO, ERD.POLICYENDDATE \
                                        EXPIRY_DATE,ERD.SPONSOR_MOBILE_NO \
                                        MOBILE, ERD.QUOTE_NO, ERD.POLICY_NO, \
                                        TO_CHAR(ERD.ENTRY_DATE, 'DD/MM/YYYY') \
                                        EFFECTIVE_DATE, ''ISCOMMERCIAL_YN, '' \
                                        POLICY_TYPE, ERD.INSURED_NAME || ' ' \
                                        || ERD.INSURED_LAST_NAME \
                                        CUSTOMER_NAME, TO_CHAR \
                                        (ERD.ENTRY_DATE, 'DD/MM/YYYY') \
                                        QUOTATION_DATE, (CASE WHEN \
                                        ERD.APPLICATION_ID = '1' THEN \
                                        ERD.LOGIN_ID ELSE ERD.APPLICATION_ID \
                                        END) LOGIN_ID, (SELECT \
                                        HPM.OVERALL_PREMIUM FROM \
                                        HOME_POSITION_MASTER HPM WHERE \
                                        HPM.QUOTE_NO = ERD.QUOTE_NO) PREMIUM, \
                                        ERD.POLICYSTARTDATE POLICY_START_DATE, \
                                        (CASE WHEN ERD.STATUS = 'P' AND \
                                        ERD.INTEGRATION_STATUS = 'S' THEN 'P' \
                                        WHEN ERD.STATUS = 'P' AND \
                                        ERD.INTEGRATION_STATUS = 'F' THEN 'PD' \
                                        WHEN ERD.STATUS = 'D' AND \
                                        ERD.INTEGRATION_STATUS = 'F' THEN 'D' \
                                        WHEN ERD.STATUS = 'Y' AND \
                                        ERD.CUST_APPROVE_STATUS = 'Y' THEN \
                                        'CAQ' WHEN ERD.STATUS = 'Y' AND \
                                        ERD.CUST_APPROVE_STATUS = 'N' THEN \
                                        'CRQ' WHEN ERD.STATUS = 'Y' AND \
                                        ERD.CUST_APPROVE_STATUS = 'P' THEN \
                                        'CPQ' WHEN ERD.STATUS = 'Y' AND \
                                        ERD.CUST_APPROVE_STATUS = 'R' THEN \
                                        'CREQ' WHEN ERD.INTEGRATION_STATUS IS \
                                        NULL AND ERD.STATUS = 'Y' AND TRUNC \
                                        (ERD.ENTRY_DATE) > TRUNC (SYSDATE) - \
                                        30 AND ERD.CUST_APPROVE_STATUS IS NULL \
                                        THEN 'EQ' WHEN ERD.STATUS = 'D' AND \
                                        HPM.REMARKS NOT IN ('Referal') THEN \
                                        'RQ' WHEN ERD.INTEGRATION_STATUS IS \
                                        NULL AND ERD.STATUS = 'Y' AND TRUNC \
                                        (ERD.ENTRY_DATE) < TRUNC (SYSDATE) - \
                                        30 AND ERD.CUST_APPROVE_STATUS IS NULL \
                                        THEN 'EXQ' END) STATUS_TYPE, (CASE \
                                        WHEN ERD.STATUS = 'P' AND \
                                        ERD.INTEGRATION_STATUS = 'S' THEN \
                                        'Policies' WHEN ERD.STATUS = 'P' AND \
                                        ERD.INTEGRATION_STATUS = 'F' THEN \
                                        'Pending Policy' WHEN ERD.STATUS = 'D' \
                                        AND ERD.INTEGRATION_STATUS = 'F' THEN \
                                        'Cancel Policy' WHEN ERD.STATUS = 'Y' \
                                        AND ERD.CUST_APPROVE_STATUS = 'Y' THEN \
                                        'Customer Approved Quote' WHEN \
                                        ERD.STATUS = 'Y' AND \
                                        ERD.CUST_APPROVE_STATUS = 'N' THEN \
                                        'Customer Rejected Quote' WHEN \
                                        ERD.STATUS = 'Y' AND \
                                        ERD.CUST_APPROVE_STATUS = 'P' THEN \
                                        'Customer Pending Quote' WHEN \
                                        ERD.STATUS = 'Y' AND \
                                        ERD.CUST_APPROVE_STATUS = 'R' THEN \
                                        'Customer Rejected for ReQuote' WHEN \
                                        ERD.INTEGRATION_STATUS IS NULL AND \
                                        ERD.STATUS = 'Y' AND TRUNC \
                                        (ERD.ENTRY_DATE) > TRUNC (SYSDATE) - \
                                        30 AND ERD.CUST_APPROVE_STATUS IS NULL \
                                        THEN 'Existing Quote' WHEN ERD.STATUS \
                                        = 'D' AND HPM.REMARKS NOT IN \
                                        ('Referal') THEN 'Rejected Quote' WHEN \
                                        ERD.INTEGRATION_STATUS IS NULL AND \
                                        ERD.STATUS = 'Y' AND TRUNC \
                                        (ERD.ENTRY_DATE) < TRUNC (SYSDATE) - \
                                        30 AND ERD.CUST_APPROVE_STATUS IS NULL \
                                        THEN 'Lapsed Quote' END) \
                                        STATUS_TYPE_NAME,?1, (SELECT \
                                        BRANCH_NAME FROM BRANCH_MASTER WHERE \
                                        BRANCH_CODE = ERD.BRANCH_CODE) \
                                        BRANCH_NAME, ERD.STATUS ORG_STATUS \
                                        FROM DOMESTIC_EMPLOYEE_DETAIL ERD, \
                                        HOME_POSITION_MASTER HPM WHERE \
                                        ERD.PRODUCT_ID = ?2 AND ERD.QUOTE_NO = \
                                        HPM.QUOTE_NO(+) AND \
                                        (ERD.APPLICATION_ID = ?3 OR ?3 IS \
                                        NULL)  

EXISTING_DATA_MOTOR = SELECT REQUESTREFERENCENO REFERENCE_NO, ERD.QUOTE_NO, \
                      ERD.CUSTOMER_ID,INSURED_NAME ||' '  || JOINT_NAME \
                      CUSTOMER_NAME, TO_CHAR(ERD.ENTRY_DATE, 'DD/MM/YYYY') \
                      QUOTATION_DATE, TO_CHAR (ERD.ENTRY_DATE, 'DD/MM/YYYY') \
                      VALIDITY_DATE,NVL (ERD.OVERALL_PREMIUM, 0) PREMIUM,CASE \
                      WHEN ISCOMMERCIAL_YN ='1' THEN 'PRIVATE' ELSE \
                      'COMMERCIAL' END ISCOMMERCIAL_YN,(CASE WHEN ERD.BDM_CODE \
                      IS NULL OR ERD.APPLICATION_ID = '1' THEN ERD.LOGIN_ID \
                      ELSE ERD.BDM_CODE END) LOGIN_ID FROM \
                      ESERVICE_REQUEST_DETAIL ERD WHERE (CASE WHEN \
                      ERD.BDM_CODE IS NULL OR ERD.APPLICATION_ID = '1' THEN \
                      ERD.LOGIN_ID ELSE ERD.BDM_CODE END)=?1 AND \
                      (ERD.APPLICATION_ID =?2 OR ?2 IS NULL) AND \
                      ERD.PRODUCT_ID =?3 AND ERD.INTEGRATION_STATUS IS NULL \
                      AND ERD.STATUS = 'Y' AND TRUNC(ERD.ENTRY_DATE) > \
                      TRUNC(SYSDATE) - 30 AND ERD.CUST_APPROVE_STATUS IS NULL \
                      AND QUOTE_TYPE!='WQ'

EXISTING_DATA_RSA = SELECT \
                    REFERENCE_NO,QUOTE_NO,CUSTOMER_ID,(POLICY_FIRST_NAME||' \
                    '||POLICY_LAST_NAME) \
                    CUSTOMER_NAME,TO_CHAR(ENTRY_DATE,'DD/MM/YYYY') \
                    QUOTATION_DATE,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY') \
                    VALIDITY_DATE ,NVL(TOTAL_PREMIUM,0) PREMIUM FROM \
                    RSA_MASTER_DETAILS WHERE (CASE WHEN BDM_CODE IS NULL THEN \
                    LOGIN_ID ELSE BDM_CODE END)=?1 AND STATUS='Y' AND  \
                    APPLICATION_ID=NVL(?2,'1')  ORDER BY QUOTE_NO DESC

EXISTING_DATA_TRAVEL = SELECT REFERENCE_NO,QUOTE_NO,CUSTOMER_ID,PASSENGER_NAME \
                       CUSTOMER_NAME,TO_CHAR(ENTRY_DATE,'DD/MM/YYYY') \
                       QUOTATION_DATE,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY') \
                       VALIDITY_DATE ,NVL(TOTAL_PREMIUM,0) PREMIUM FROM \
                       TRAVEL_RAW_DETAIL WHERE (CASE WHEN BDM_CODE IS NULL \
                       THEN LOGIN_ID ELSE BDM_CODE END)=?1 AND STATUS='Y' AND  \
                       APPLICATION_ID=NVL(?2,'1') AND INTEGRATION_STATUS IS \
                       NULL AND CUST_APPROVE_STATUS IS NULL AND REMARKS IS NULL

EXISTING_LOGINID = SELECT (CORE_APP_CODE|| '' || '001') LOGINID FROM \
                   BRANCH_MASTER WHERE BRANCH_CODE=?1 AND STATUS='Y'

E_Chassis_No = AND ERD.VEH_CHASSIS_NO=?4 ORDER BY ERD.QUOTE_NO

E_Plate_Number = AND ERD.VEH_PLATE_NUMBER=?4 ORDER BY ERD.QUOTE_NO

E_RequestReferenceNo = AND ERD.REQUESTREFERENCENO=?4 ORDER BY ERD.QUOTE_NO

#******* ADMIN *******
FEEDBACK_DATA = SELECT \
                LOGIN_ID,STATUS,REMARKS,PARAM,TO_CHAR(ENTRY_DATE,'DD/MM/YYYY') \
                ENTRY_DATE,SCREENSHOT_PATH,SCREENSHOT_NAME,COMMON_FILE_PATH,FEE\
                DBACK_ID,CASE WHEN COMMON_FILE_PATH IS NOT NULL OR \
                COMMON_FILE_PATH != '' THEN COMMON_FILE_PATH WHEN \
                SCREENSHOT_PATH IS NOT NULL OR SCREENSHOT_PATH != '' THEN \
                SCREENSHOT_PATH ELSE 'N' END AS \
                FILE_PATH,MOBILE_NO,RENEWAL_POLICYNO FROM \
                MOTOR_FEEDBACK_DETAILS WHERE ENTRY_DATE BETWEEN TO_DATE(?1 \
                ,'DD/MM/YYYY') AND TO_DATE(?2,'DD/MM/YYYY') AND PRODUCT_ID=?3

FIRST_NAME_SEARCH = AND upper(PI.FIRST_NAME) like upper(?4) ORDER BY \
                    HPM.QUOTE_NO

FLEET_EXISTING_DATA = SELECT REQUESTREFERENCENO REFERENCE_NO, \
                      ERD.UPLOAD_TRAN_ID,ERD.QUOTE_NO, ERD.RENEWALYN,ERD.RENEWALPOLICYNO, \
                      ERD.CUSTOMER_ID,COMPANY_NAME CUSTOMER_NAME, \
                      TO_CHAR(ERD.ENTRY_DATE,'DD/MM/YYYY') QUOTATION_DATE, \
                      TO_CHAR (ERD.ENTRY_DATE, 'DD/MM/YYYY') VALIDITY_DATE,NVL \
                      (ERD.OVERALL_PREMIUM, 0) PREMIUM,(CASE WHEN ERD.BDM_CODE \
                      IS NULL OR ERD.APPLICATION_ID = '1' THEN ERD.LOGIN_ID \
                      ELSE ERD.BDM_CODE END) LOGIN_ID,(CASE WHEN \
                      ERD.UPLOAD_TRAN_ID IS NULL AND (SELECT COUNT(*) FROM \
                      FLEET_TEMPLATE_RAW FTR WHERE \
                      FTR.TRANSACTION_ID=ERD.UPLOAD_TRAN_ID AND FTR.STATUS!='R')=0 THEN 'FU' WHEN \
                      ERD.UPLOAD_TRAN_ID IS NOT NULL  AND ((SELECT \
                      FTD.TOTALRECORDS FROM FLEET_TRANSACTION_DETAILS FTD \
                      WHERE FTD.TRANID=ERD.UPLOAD_TRAN_ID)!=(SELECT COUNT(*) \
                      FROM FLEET_TEMPLATE_RAW FTR WHERE \
                      FTR.TRANSACTION_ID=ERD.UPLOAD_TRAN_ID AND FTR.STATUS!='R')) THEN 'FUP' WHEN \
                      ERD.UPLOAD_TRAN_ID IS NOT NULL AND ((SELECT \
                      FTD.TOTALRECORDS FROM FLEET_TRANSACTION_DETAILS FTD \
                      WHERE FTD.TRANID=ERD.UPLOAD_TRAN_ID)=(SELECT COUNT(*) \
                      FROM FLEET_TEMPLATE_RAW FTR WHERE \
                      FTR.TRANSACTION_ID=ERD.UPLOAD_TRAN_ID AND FTR.STATUS!='R')) THEN 'FUC' END) \
                      STATUS_TYPE FROM FLEET_REQUEST_DETAIL ERD, HOME_POSITION_MASTER HPM WHERE (CASE \
                      WHEN ERD.BDM_CODE IS NULL OR ERD.APPLICATION_ID = '1' \
                      THEN ERD.LOGIN_ID ELSE ERD.BDM_CODE END)=?1 AND \
                      (ERD.APPLICATION_ID =?2 OR ?2 IS NULL) AND \
                      ERD.PRODUCT_ID =?3 AND ERD.INTEGRATION_STATUS IS NULL AND (ERD.HODREFERRALYN='N' OR ERD.HODREFERRALYN IS NULL)\
                      AND ERD.STATUS = 'Y' AND TRUNC(ERD.ENTRY_DATE) > \
                      TRUNC(SYSDATE) - 30 AND ERD.CUST_APPROVE_STATUS IS NULL AND ERD.QUOTE_NO=HPM.QUOTE_NO (+) AND ERD.STATUS=HPM.STATUS (+)

######### INTEGRATION - POLICY DETAILS #############
INTEGSTATUS_STAGES = SELECT * FROM MARINE_CONSTANT_DETAIL WHERE \
                     RSACODE='INTEG_STAGE' AND PRODUCT_ID=?1 ORDER BY PERCENT \
                     ASC

######################################## DROPDOWN #################################################
LISTITEM_REMARKS = SELECT ITEM_CODE CODE,ITEM_VALUE \
                   CODEDESC,ITEM_DESC,PARAM1,PARAM2 FROM LIST_ITEM_VALUE WHERE \
                   ITEM_TYPE=?1 AND STATUS='Y' AND PARAM1='G' order by \
                   TO_NUMBER(ITEM_CODE) asc

LIST_ITEM = SELECT ITEM_CODE CODE,ITEM_VALUE CODEDESC,ITEM_DESC,PARAM1,PARAM2 \
            FROm LIST_ITEM_VALUE WHERE ITEM_TYPE=?1 AND STATUS IN('Y','R') \
            order by TO_NUMBER(ITEM_CODE) asc

MAKE_MODEL_SEARCH = AND ERD.VEH_MODEL_ID=?4 AND ERD.VEH_MAKE_ID=?5 ORDER BY \
                    ERD.QUOTE_NO

MOBILE_SEARCH = AND HPM.MOBILE=?4 ORDER BY  HPM.QUOTE_NO

#****************** USER SIDE MENU GRID APIS QUERY********************

MOTOR_ACTIVE_POLICY = SELECT HPM.ORANGE_CARDNO,HPM.ORANGE_CARDURL,HPM.POLICY_NO,(SELECT REQ_REF_NO FROM \
                      MOTOR_DATA_DETAIL MDD WHERE MDD.QUOTE_NO=HPM.QUOTE_NO \
                      AND HPM.APPLICATION_NO = MDD.APPLICATION_NO) \
                      REQREFNO,(SELECT MPM.POLICYTYPE_DESC_ENGLISH FROM \
                      MOTOR_POLICYTYPE_MASTER MPM WHERE \
                      MPM.POLICYTYPE_ID=(SELECT POLICYTYPE FROM \
                      MOTOR_DATA_DETAIL MDD WHERE MDD.QUOTE_NO=HPM.QUOTE_NO \
                      AND HPM.APPLICATION_NO = MDD.APPLICATION_NO)) \
                      POLICY_TYPE,HPM.CUSTOMER_ID, HPM.OVERALL_PREMIUM, \
                      TO_CHAR(HPM.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, \
                      NVL (PI.COMPANY_NAME, PI.FIRST_NAME) || ' ' || \
                      PI.JOINT_NAME CUSTOMER_NAME, PI.LAST_NAME, HPM.LOGIN_ID, \
                      HPM.QUOTE_NO, HPM.EXCESS_PREMIUM, PI.COMPANY_NAME, \
                      TO_CHAR (HPM.INCEPTION_DATE, 'DD/MM/YYYY') \
                      INCEPTION_DATE, NULL OPEN_COVER_NO, HPM.AMEND_ID, \
                      HPM.RECEIPT_NO, BCM.COMPANY_NAME BROKER_NAME, (SELECT \
                      TRAVEL_COVER_ID FROM TRAVEL_RAW_DETAIL WHERE QUOTE_NO = \
                      HPM.QUOTE_NO) TRAVEL_COVER_ID,PI.MODE_OF_PAYMENT,(SELECT \
                      CASE WHEN MDD.ISCOMMERCIAL_YN ='N' THEN 'PRIVATE' ELSE \
                      'COMMERCIAL' END ISCOMMERCIAL_YN FROM MOTOR_DATA_DETAIL \
                      MDD WHERE HPM.QUOTE_NO = MDD.QUOTE_NO AND \
                      HPM.APPLICATION_NO = MDD.APPLICATION_NO) ISCOMMERCIAL_YN \
                      FROM HOME_POSITION_MASTER HPM, PERSONAL_INFO PI, \
                      BROKER_COMPANY_MASTER BCM WHERE (CASE WHEN HPM.BDM_CODE \
                      IS NULL OR HPM.APPLICATION_ID = '1' THEN HPM.LOGIN_ID \
                      ELSE HPM.BDM_CODE END) = ?1 AND HPM.STATUS = 'P' AND \
                      HPM.AMEND_ID = '0' AND PI.CUSTOMER_ID = HPM.CUSTOMER_ID \
                      AND HPM.PRODUCT_ID = ?2 AND PI.STATUS = 'Y' AND \
                      PI.AMEND_ID = (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO \
                      WHERE CUSTOMER_ID = PI.CUSTOMER_ID) AND HPM.BROKER_CODE \
                      = BCM.AGENCY_CODE AND (HPM.APPLICATION_ID=?3 OR ?3 IS \
                      NULL) AND HPM.INTEGRATION_ERROR IS NULL AND \
                      HPM.POL_INTEG_STATUS='SUCCESS' ORDER BY HPM.ENTRY_DATE \
                      DESC


MOTOR_ACTIVE_POLICY1 = SELECT HPM.ORANGE_CARDNO,HPM.ORANGE_CARDURL,HPM.POLICY_NO,(SELECT REQ_REF_NO FROM \
                      MOTOR_DATA_DETAIL MDD WHERE MDD.QUOTE_NO=HPM.QUOTE_NO \
                      AND HPM.APPLICATION_NO = MDD.APPLICATION_NO) \
                      REQREFNO,(SELECT MPM.POLICYTYPE_DESC_ENGLISH FROM \
                      MOTOR_POLICYTYPE_MASTER MPM WHERE \
                      MPM.POLICYTYPE_ID=(SELECT POLICYTYPE FROM \
                      MOTOR_DATA_DETAIL MDD WHERE MDD.QUOTE_NO=HPM.QUOTE_NO \
                      AND HPM.APPLICATION_NO = MDD.APPLICATION_NO)) \
                      POLICY_TYPE,HPM.CUSTOMER_ID, HPM.OVERALL_PREMIUM, \
                      TO_CHAR(HPM.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, \
                      NVL (PI.COMPANY_NAME, PI.FIRST_NAME) || ' ' || \
                      PI.JOINT_NAME CUSTOMER_NAME, PI.LAST_NAME, HPM.LOGIN_ID, \
                      HPM.QUOTE_NO, HPM.EXCESS_PREMIUM, PI.COMPANY_NAME, \
                      TO_CHAR (HPM.INCEPTION_DATE, 'DD/MM/YYYY') \
                      INCEPTION_DATE, NULL OPEN_COVER_NO, HPM.AMEND_ID, \
                      HPM.RECEIPT_NO, BCM.COMPANY_NAME BROKER_NAME, (SELECT \
                      TRAVEL_COVER_ID FROM TRAVEL_RAW_DETAIL WHERE QUOTE_NO = \
                      HPM.QUOTE_NO) TRAVEL_COVER_ID,PI.MODE_OF_PAYMENT,(SELECT \
                      CASE WHEN MDD.ISCOMMERCIAL_YN ='N' THEN 'PRIVATE' ELSE \
                      'COMMERCIAL' END ISCOMMERCIAL_YN FROM MOTOR_DATA_DETAIL \
                      MDD WHERE HPM.QUOTE_NO = MDD.QUOTE_NO AND \
                      HPM.APPLICATION_NO = MDD.APPLICATION_NO) ISCOMMERCIAL_YN \
                      FROM HOME_POSITION_MASTER HPM, PERSONAL_INFO PI, \
                      BROKER_COMPANY_MASTER BCM WHERE ( CASE WHEN hpm.bdm_code IS NOT NULL and hpm.application_id != '1' THEN hpm.bdm_code WHEN hpm.bdm_code IS NULL OR hpm.application_id = '1' THEN hpm.login_id END ) = ?1 AND HPM.STATUS = 'P' AND \
                      HPM.AMEND_ID = '0' AND PI.CUSTOMER_ID = HPM.CUSTOMER_ID \
                      AND HPM.PRODUCT_ID = ?2 AND PI.STATUS = 'Y' AND \
                      PI.AMEND_ID = (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO \
                      WHERE CUSTOMER_ID = PI.CUSTOMER_ID) AND HPM.BROKER_CODE \
                      = BCM.AGENCY_CODE AND (HPM.APPLICATION_ID=?3 OR ?3 IS \
                      NULL) AND HPM.INTEGRATION_ERROR IS NULL AND \
                      HPM.POL_INTEG_STATUS='SUCCESS' ORDER BY HPM.ENTRY_DATE \
                      DESC
                      
MOTOR_ACTIVE_POLICY_BROKER = SELECT HPM.ORANGE_CARDNO,HPM.ORANGE_CARDURL,HPM.POLICY_NO,(SELECT REQ_REF_NO FROM \
                      MOTOR_DATA_DETAIL MDD WHERE MDD.QUOTE_NO=HPM.QUOTE_NO \
                      AND HPM.APPLICATION_NO = MDD.APPLICATION_NO) \
                      REQREFNO,(SELECT MPM.POLICYTYPE_DESC_ENGLISH FROM \
                      MOTOR_POLICYTYPE_MASTER MPM WHERE \
                      MPM.POLICYTYPE_ID=(SELECT POLICYTYPE FROM \
                      MOTOR_DATA_DETAIL MDD WHERE MDD.QUOTE_NO=HPM.QUOTE_NO \
                      AND HPM.APPLICATION_NO = MDD.APPLICATION_NO)) \
                      POLICY_TYPE,HPM.CUSTOMER_ID, HPM.OVERALL_PREMIUM, \
                      TO_CHAR(HPM.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, \
                      NVL (PI.COMPANY_NAME, PI.FIRST_NAME) || ' ' || \
                      PI.JOINT_NAME CUSTOMER_NAME, PI.LAST_NAME, HPM.LOGIN_ID, \
                      HPM.QUOTE_NO, HPM.EXCESS_PREMIUM, PI.COMPANY_NAME, \
                      TO_CHAR (HPM.INCEPTION_DATE, 'DD/MM/YYYY') \
                      INCEPTION_DATE, NULL OPEN_COVER_NO, HPM.AMEND_ID, \
                      HPM.RECEIPT_NO, BCM.COMPANY_NAME BROKER_NAME, (SELECT \
                      TRAVEL_COVER_ID FROM TRAVEL_RAW_DETAIL WHERE QUOTE_NO = \
                      HPM.QUOTE_NO) TRAVEL_COVER_ID,PI.MODE_OF_PAYMENT,(SELECT \
                      CASE WHEN MDD.ISCOMMERCIAL_YN ='N' THEN 'PRIVATE' ELSE \
                      'COMMERCIAL' END ISCOMMERCIAL_YN FROM MOTOR_DATA_DETAIL \
                      MDD WHERE HPM.QUOTE_NO = MDD.QUOTE_NO AND \
                      HPM.APPLICATION_NO = MDD.APPLICATION_NO) ISCOMMERCIAL_YN \
                      FROM HOME_POSITION_MASTER HPM, PERSONAL_INFO PI, \
                      BROKER_COMPANY_MASTER BCM WHERE ( CASE WHEN hpm.application_id = '1' THEN lower(hpm.login_id) END ) = lower(?1) AND HPM.STATUS = 'P' AND \
                      HPM.AMEND_ID = '0' AND PI.CUSTOMER_ID = HPM.CUSTOMER_ID \
                      AND HPM.PRODUCT_ID = ?2 AND PI.STATUS = 'Y' AND \
                      PI.AMEND_ID = (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO \
                      WHERE CUSTOMER_ID = PI.CUSTOMER_ID) AND HPM.BROKER_CODE \
                      = BCM.AGENCY_CODE AND (HPM.APPLICATION_ID=?3 OR ?3 IS \
                      NULL) AND HPM.INTEGRATION_ERROR IS NULL AND \
                      HPM.POL_INTEG_STATUS='SUCCESS' ORDER BY HPM.ENTRY_DATE \
                      DESC
                      
 

MOTOR_BROKER = SELECT * FROM (SELECT DISTINCT BCM.RSA_BROKER_CODE CODE, PM.LOGIN_ID \
               FIRST_NAME, BCM.COMPANY_NAME CODEDESC, LM.OA_CODE FROM \
               ESERVICE_REQUEST_DETAIL PM, LOGIN_MASTER LM, \
               BROKER_COMPANY_MASTER BCM WHERE LM.LOGIN_ID = PM.LOGIN_ID AND \
               LM.AGENCY_CODE = BCM.AGENCY_CODE AND PM.STATUS IN ('P', \
               'Y','R') AND BCM.BRANCH_CODE = ?1 AND PM.BROKER_CODE = \
               BCM.AGENCY_CODE AND lm.status = 'Y' AND \
               BCM.status = 'Y' AND LM.OA_CODE NOT IN (SELECT BROKER_CODE FROM \
               LOGIN_RSAUSER_DETAILS WHERE LOGIN_ID = ?2 AND PRODUCT_ID = ?3) \
               UNION ALL SELECT DISTINCT LM.LOGIN_ID CODE, USERNAME, USERNAME \
               CODEDESC, LM.OA_CODE FROM login_master lm, \
               ESERVICE_REQUEST_DETAIL PM WHERE lm.usertype = 'User' AND \
               lm.BRANCH_CODE = ?1 AND lm.OA_CODE != '90016' AND PM.STATUS IN \
               ('P', 'Y','R') AND PM.login_id = lm.login_id AND PM.broker_code \
               = lm.agency_code AND PM.BDM_CODE IS NULL AND lm.AGENCY_CODE IN \
               (SELECT DISTINCT AGENCY_CODE FROM LOGIN_USER_DETAILS LR WHERE \
               PRODUCT_ID = ?3 AND STATUS = 'Y' AND LR.LOGIN_ID = lm.LOGIN_ID) \
               AND lm.status = 'Y' UNION ALL SELECT DISTINCT pcd.CUSTOMER_CODE \
               CODE, pcd.CUSTOMER_NAME, pcd.CUSTOMER_NAME CODEDESC, \
               pcd.CUSTOMER_CODE FROM PREMIA_CUSTOMER_DETAILS pcd, \
               ESERVICE_REQUEST_DETAIL PM WHERE CUSTOMER_TYPE = '009' AND \
               CUSTOMER_CATEGORY =(SELECT CORE_APP_CODE FROM BRANCH_MASTER \
               WHERE STATUS='Y' AND BRANCH_CODE=?1) AND ((SELECT   \
               CORE_APP_CODE FROM   branch_master WHERE   status = 'Y' AND \
               branch_code = ?1) BETWEEN DIVISION_FROM AND DIVISION_TO) AND \
               PM.BDM_CODE = pcd.CUSTOMER_CODE AND PM.STATUS IN ('P', 'Y','R') \
               AND pcd.status = 'Y') ORDER BY CODEDESC

MOTOR_EXISTING_DATA = SELECT REQUESTREFERENCENO REFERENCE_NO, ERD.QUOTE_NO, \
                      ERD.CUSTOMER_ID,INSURED_NAME ||' '  || JOINT_NAME \
                      CUSTOMER_NAME, TO_CHAR(ERD.ENTRY_DATE, 'DD/MM/YYYY') \
                      QUOTATION_DATE, TO_CHAR (ERD.ENTRY_DATE, 'DD/MM/YYYY') \
                      VALIDITY_DATE,NVL (ERD.OVERALL_PREMIUM, 0) PREMIUM,CASE \
                      WHEN ISCOMMERCIAL_YN ='1' THEN 'PRIVATE' ELSE \
                      'COMMERCIAL' END ISCOMMERCIAL_YN,(CASE WHEN ERD.BDM_CODE \
                      IS NULL OR ERD.APPLICATION_ID = '1' THEN ERD.LOGIN_ID \
                      ELSE ERD.BDM_CODE END) LOGIN_ID FROM \
                      ESERVICE_REQUEST_DETAIL ERD, HOME_POSITION_MASTER HPM WHERE (CASE WHEN \
                      ERD.BDM_CODE IS NULL OR ERD.APPLICATION_ID = '1' THEN \
                      ERD.LOGIN_ID ELSE ERD.BDM_CODE END)=?1 AND \
                      (ERD.APPLICATION_ID =?2 OR ?2 IS NULL) AND \
                      ERD.PRODUCT_ID =?3 AND ERD.INTEGRATION_STATUS IS NULL \
                      AND ERD.STATUS = 'Y' AND TRUNC(ERD.ENTRY_DATE) > \
                      TRUNC(SYSDATE) - 30 AND ERD.CUST_APPROVE_STATUS IS NULL \
                      AND QUOTE_TYPE!='WQ' AND ERD.QUOTE_NO=HPM.QUOTE_NO (+) AND ERD.STATUS=HPM.STATUS (+)

MOTOR_EXPIRE_DATA = SELECT ERD.REQUESTREFERENCENO, ERD.QUOTE_NO, ERD.STATUS, \
                    ERD.CUSTOMER_ID, TO_CHAR(ERD.ENTRY_DATE,'DD/MM/YYYY') \
                    QUOTATION_DATE,NVL (PI.COMPANY_NAME, PI.FIRST_NAME)  ||' ' \
                    || PI.JOINT_NAME CUSTOMER_NAME, ERD.OVERALL_PREMIUM \
                    PREMIUM,'' LAPSED_REMARKS,'' \
                    LAPSED_DATE,''VALIDITY_DATE,(CASE WHEN ERD.BDM_CODE IS \
                    NULL THEN ERD.LOGIN_ID ELSE ERD.BDM_CODE END) \
                    LOGIN_ID,CASE WHEN ERD.ISCOMMERCIAL_YN ='1' THEN 'PRIVATE' \
                    ELSE 'COMMERCIAL' END ISCOMMERCIAL_YN FROM \
                    ESERVICE_REQUEST_DETAIL ERD, PERSONAL_INFO PI, HOME_POSITION_MASTER HPM WHERE (CASE \
                    WHEN ERD.BDM_CODE IS NULL THEN ERD.LOGIN_ID ELSE \
                    ERD.BDM_CODE END)=?1 AND TRUNC (ERD.ENTRY_DATE) < \
                    TRUNC(SYSDATE) - 30 AND (ERD.APPLICATION_ID =?2 OR ?2 IS \
                    NULL) AND ERD.STATUS = 'Y' AND PI.CUSTOMER_ID = \
                    ERD.CUSTOMER_ID AND ERD.QUOTE_NO IS NOT NULL AND \
                    PI.AMEND_ID = (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO \
                    WHERE CUSTOMER_ID = PI.CUSTOMER_ID) AND PI.STATUS = 'Y' \
                    AND ERD.QUOTE_NO=HPM.QUOTE_NO (+) AND ERD.STATUS=HPM.STATUS (+) \
                    ORDER BY ERD.QUOTE_NO DESC

MOTOR_FAILED_CHARGES = SELECT CHARGE_CODE CODE,'' \
                       CODE_DESC,P_WS_RESPONSE_TYPE,P_WS_ERROR,TO_CHAR(REQUEST_\
                       TIME,'DD/MM/YYYY HH24:MI:SS.FF3') \
                       REQUEST_TIME,TO_CHAR(RESPONSE_TIME,'DD/MM/YYYY \
                       HH24:MI:SS.FF3') RESPONSE_TIME FROM YI_CHARGE_DETAIL \
                       WHERE P_WS_RESPONSE_TYPE='F' AND REQUESTREFERENCENO=?1

MOTOR_FAILED_COVERS = SELECT COVER_CODE CODE,COVER_DESC \
                      CODE_DESC,P_WS_RESPONSE_TYPE,P_WS_ERROR,TO_CHAR(REQUEST_T\
                      IME,'DD/MM/YYYY HH24:MI:SS.FF3') \
                      REQUEST_TIME,TO_CHAR(RESPONSE_TIME,'DD/MM/YYYY \
                      HH24:MI:SS.FF3') RESPONSE_TIME FROM YI_COVER_DETAIL  \
                      WHERE P_WS_RESPONSE_TYPE='F' AND REQUESTREFERENCENO=?1

MOTOR_FAILED_DISCOUNTS = SELECT COMMERCIAL_DISCOUNT \
                         CODE,P_WS_RESPONSE_TYPE,P_WS_ERROR,TO_CHAR(REQUEST_TIM\
                         E,'DD/MM/YYYY HH24:MI:SS.FF3') \
                         REQUEST_TIME,TO_CHAR(RESPONSE_TIME,'DD/MM/YYYY \
                         HH24:MI:SS.FF3') RESPONSE_TIME FROM \
                         MOT_COMM_DISCOUNT_DETAIL WHERE P_WS_RESPONSE_TYPE='F' \
                         AND REQUESTREFERENCENO=?1

MOTOR_FIRST_NAME_SEARCH = AND upper(ERD.INSURED_NAME || ' ' || ERD.JOINT_NAME) \
                          like upper(?4) ORDER BY ERD.QUOTE_NO

MOTOR_MOBILE_SEARCH = AND ERD.MOBILE=?4 ORDER BY ERD.QUOTE_NO

MOTOR_PENDING_POLICY = SELECT A.QUOTE_NO, A.LAPSED_REMARKS, \
                       TO_DATE(A.LAPSED_DATE, 'DD/MM/YYYY') LAPSED_DATE, \
                       A.CUSTOMER_ID, TO_CHAR(A.ENTRY_DATE, 'DD/MM/YYYY') AS \
                       QUOTATION_DATE, B.FIRST_NAME || ' ' || B.JOINT_NAME \
                       CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO , \
                       B.COMPANY_NAME, ERD.REQUESTREFERENCENO, \
                       A.OVERALL_PREMIUM PREMIUM, TO_CHAR (A. INCEPTION_DATE, \
                       'DD/MM/YYYY') INCEPTION_DATE, A.EXPIRY_DATE, \
                       B.EMAIL,CASE WHEN ERD.ISCOMMERCIAL_YN ='1' THEN \
                       'PRIVATE' ELSE 'COMMERCIAL' END ISCOMMERCIAL_YN,(SELECT \
                       MPM.POLICYTYPE_DESC_ENGLISH FROM \
                       MOTOR_POLICYTYPE_MASTER MPM WHERE \
                       MPM.POLICYTYPE_ID=(SELECT POLICYTYPE FROM \
                       MOTOR_DATA_DETAIL MDD WHERE MDD.QUOTE_NO=A.QUOTE_NO AND \
                       A.APPLICATION_NO = MDD.APPLICATION_NO)) POLICY_TYPE \
                       FROM HOME_POSITION_MASTER A, PERSONAL_INFO B, \
                       ESERVICE_REQUEST_DETAIL ERD WHERE ( CASE WHEN \
                       A.BDM_CODE IS NULL OR A.APPLICATION_ID = '1' THEN \
                       A.LOGIN_ID ELSE A.BDM_CODE END) = ?1 AND \
                       A.INTEGRATION_STATUS = 'F' AND B.CUSTOMER_ID = \
                       A.CUSTOMER_ID AND A.PRODUCT_ID =?2 AND \
                       (A.APPLICATION_ID=?3 OR ?3 IS NULL) AND ERD.QUOTE_NO = \
                       A.QUOTE_NO AND B.AMEND_ID = ( SELECT MAX (AMEND_ID) \
                       FROM PERSONAL_INFO WHERE CUSTOMER_ID = B.CUSTOMER_ID) \
                       AND B.STATUS = 'Y' ORDER BY QUOTE_NO DESC

MOTOR_PENDING_REFERAL = SELECT HPM.POLICY_NO, HPM.CUSTOMER_ID, \
                        HPM.OVERALL_PREMIUM, TO_CHAR(HPM. ENTRY_DATE, \
                        'DD/MM/YYYY') QUOTATION_DATE, NVL (PI.COMPANY_NAME, \
                        PI. FIRST_NAME) || ' ' || PI.JOINT_NAME  \
                        CUSTOMER_NAME, PI.LAST_NAME, HPM.LOGIN_ID, \
                        HPM.QUOTE_NO, HPM.EXCESS_PREMIUM, PI.COMPANY_NAME, \
                        TO_CHAR (HPM.INCEPTION_DATE, 'DD/MM/YYYY') \
                        INCEPTION_DATE, NULL OPEN_COVER_NO, HPM.AMEND_ID, \
                        HPM.RECEIPT_NO, BCM. COMPANY_NAME \
                        BROKER_NAME,HPM.APPLICATION_NO,HPM.DEBIT_NOTE_NO,HPM. \
                        CREDIT_NO \
                        CREDIT_NOTE_NO,ERD.REQUESTREFERENCENO,PI.EMAIL,HPM.PREM\
                        IUM,HPM \
                        .EXPIRY_DATE,HPM.REMARKS,HPM.REFERRAL_DESCRIPTION,HPM.A\
                        DMIN_REMARKS,CASE WHEN ERD.ISCOMMERCIAL_YN ='1' THEN \
                        'PRIVATE' ELSE 'COMMERCIAL' END ISCOMMERCIAL_YN FROM \
                        HOME_POSITION_MASTER HPM, PERSONAL_INFO PI, \
                        BROKER_COMPANY_MASTER BCM,ESERVICE_REQUEST_DETAIL ERD \
                        WHERE ( CASE WHEN HPM.BDM_CODE IS NULL OR \
                        HPM.APPLICATION_ID = '1' THEN HPM.LOGIN_ID ELSE \
                        HPM.BDM_CODE END)=?1 AND HPM.STATUS = 'Y' AND \
                        HPM.AMEND_ID = '0' AND PI.CUSTOMER_ID = \
                        HPM.CUSTOMER_ID AND HPM.PRODUCT_ID =?2 AND PI.STATUS = \
                        'Y' AND PI.AMEND_ID = ( SELECT MAX (AMEND_ID) FROM \
                        PERSONAL_INFO WHERE CUSTOMER_ID = PI.CUSTOMER_ID) AND \
                        HPM.REMARKS = 'REFERAL' AND HPM.BROKER_CODE = \
                        BCM.AGENCY_CODE AND ERD.QUOTE_NO =HPM. QUOTE_NO AND \
                        (HPM.APPLICATION_ID=?3 OR ?3 IS NULL)

MOTOR_POLICY_STATUS = SELECT CURRENT_STATUS,QUOTATION_POLICY_NO,(SELECT \
                      PRODUCT_ID FROM HOME_POSITION_MASTER WHERE \
                      TO_CHAR(QUOTE_NO)=TO_CHAR(REQUESTREFERENCENO)) \
                      PRODUCT_ID FROM YI_POLICY_DETAIL WHERE \
                      REQUESTREFERENCENO=?1

MOTOR_REJECTED_DATA = SELECT \
                      ERD.REQUESTREFERENCENO,ERD.APPLICATION_NO,ERD.QUOTE_NO,''\
                       LAPSED_REMARKS,'' LAPSED_DATE, ERD.CUSTOMER_ID, \
                      TO_CHAR(ERD.ENTRY_DATE,'DD/MM/YYYY') QUOTATION_DATE, '' \
                      VALIDITY_PERIOD, PI.FIRST_NAME || ' ' || PI.JOINT_NAME \
                      CUSTOMER_NAME, ERD.LOGIN_ID, ERD.STATUS, \
                      PI.COMPANY_NAME, 'REJECTED' \
                      REJECT_DESC,ERD.OVERALL_PREMIUM PREMIUM,CASE WHEN \
                      ERD.ISCOMMERCIAL_YN ='1' THEN 'PRIVATE' ELSE \
                      'COMMERCIAL' END ISCOMMERCIAL_YN FROM \
                      ESERVICE_REQUEST_DETAIL ERD, PERSONAL_INFO PI WHERE \
                      (CASE WHEN ERD.BDM_CODE IS NULL OR ERD.APPLICATION_ID = \
                      '1' THEN ERD.LOGIN_ID ELSE ERD.BDM_CODE END)=?1 \
                      AND(ERD.STATUS IN ('D')) AND PI.CUSTOMER_ID = \
                      ERD.CUSTOMER_ID AND (ERD.APPLICATION_ID =?2 OR ?2 IS \
                      NULL) AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM \
                      PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID) AND \
                      PI.STATUS='Y' ORDER BY QUOTE_NO DESC

MOTOR_WAJAH_EXISTING_DATA = SELECT REQUESTREFERENCENO REFERENCE_NO, \
                            ERD.QUOTE_NO, ERD.CUSTOMER_ID,INSURED_NAME ||' '  \
                            || JOINT_NAME CUSTOMER_NAME, \
                            TO_CHAR(ERD.ENTRY_DATE, 'DD/MM/YYYY') \
                            QUOTATION_DATE, TO_CHAR (ERD.ENTRY_DATE, \
                            'DD/MM/YYYY') VALIDITY_DATE,NVL \
                            (ERD.OVERALL_PREMIUM, 0) PREMIUM,CASE WHEN \
                            ISCOMMERCIAL_YN ='1' THEN 'PRIVATE' ELSE \
                            'COMMERCIAL' END ISCOMMERCIAL_YN FROM \
                            ESERVICE_REQUEST_DETAIL ERD, HOME_POSITION_MASTER HPM WHERE (CASE WHEN \
                            ERD.BDM_CODE IS NULL OR ERD.APPLICATION_ID = '1' \
                            THEN ERD.LOGIN_ID ELSE ERD.BDM_CODE END)=?1 AND \
                            (ERD.APPLICATION_ID =?2 OR ?2 IS NULL) AND \
                            ERD.PRODUCT_ID =?3 AND ERD.INTEGRATION_STATUS IS \
                            NULL AND ERD.STATUS = 'Y' AND \
                            TRUNC(ERD.ENTRY_DATE) > TRUNC(SYSDATE) - 30 AND \
                            ERD.CUST_APPROVE_STATUS IS NULL AND QUOTE_TYPE='WQ' AND ERD.QUOTE_NO=HPM.QUOTE_NO (+) AND ERD.STATUS=HPM.STATUS (+)

ORANGECARD_SEARCH = AND HPM.ORANGE_CARDNO=?4 ORDER BY HPM.QUOTE_NO

POLICY_SEARCH = AND hpm.policy_no=?4 ORDER BY  HPM.QUOTE_NO

PORTFOLIO_ADMIN_BRANCH_LIST = SELECT BRANCH_CODE,BRANCH_NAME FROM \
                              BRANCH_MASTER WHERE BRANCH_CODE IN (SELECT \
                              DISTINCT(REGEXP_SUBSTR(LC_LOGIN,'[^,]+',1,LEVEL))\
                               LC_LOGIN FROM (SELECT ATTACHED_BRANCH LC_LOGIN \
                              FROM LOGIN_MASTER WHERE LOGIN_ID=?1) B CONNECT \
                              BY LEVEL <= LENGTH(LC_LOGIN) - \
                              LENGTH(REPLACE(LC_LOGIN,',',''))+1 AND LC_LOGIN \
                              IS NOT NULL) ORDER BY BRANCH_CODE

PORTFOLIO_ADMIN_REGION_LIST = SELECT BRANCH_CODE, BRANCH_NAME FROM \
                              BRANCH_MASTER WHERE   BRANCH_CODE IN (SELECT * \
                              FROM   TABLE(SPLIT_TEXT_FN ((SELECT  \
                              DECODE(ACCESSTYPE,'SUPER',NVL \
                              (BRANCH_CODE,BRANCH_CODE),BRANCH_CODE) FROM \
                              LOGIN_MASTER WHERE LOGIN_ID = ?1),','))) ORDER \
                              BY BRANCH_NAME

PORTFOLIO_BROKER_LIST = SELECT ITEM_VALUE,ITEM_DESC FROM LIST_ITEM_VALUE WHERE \
                        ITEM_TYPE=?1 ORDER BY ITEM_CODE

PORTFOLIO_TYPE_LIST = SELECT ITEM_VALUE,ITEM_DESC FROM LIST_ITEM_VALUE WHERE \
                      ITEM_TYPE=?1 ORDER BY ITEM_CODE

QUOTE_SEARCH = AND hpm.quote_no=?4 ORDER BY  HPM.QUOTE_NO

#RENEW_QUOTE_POLICY_SEARCH = SELECT   RQP.REQUEST_REF_NO \
                            #QUOTE_NO,RQP.QUOTE_PREMIUM PREMIUM,TO_CHAR \
                            #(RQP.NEW_START_DATE, 'DD/MM/YYYY') \
                            #POLICY_START_DATE,TO_CHAR (NEW_END_DATE, \
                            #'DD/MM/YYYY') VALIDITY_DATE,RQP.USERNAME \
                            #CUSTOMER_NAME,RQP.NEW_POLICY_NUMBER POLICY_NO, \
                            #RQP.LOGIN_ID,TO_CHAR (RQP.REQUEST_TIME, \
                            #'DD/MM/YYYY') QUOTATION_DATE,TO_CHAR \
                            #(RQP.REQUEST_TIME, 'DD/MM/YYYY') ENTRY_DATE FROM   \
                            #RENEW_QUOTE_POLICY RQP WHERE   \
                            #RQP.QUOTATION_POLICY_NO =?1
                            
RENEW_QUOTE_POLICY_SEARCH = SELECT  ERD.REQUESTREFERENCENO REQREFNO,ERD.POLICYENDDATE  \
                    EXPIRY_DATE,ERD.QUOTE_NO,ERD.POLICY_NO,TO_CHAR  \
                    (ERD.ENTRY_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE,(CASE WHEN  \
                    ERD.ISCOMMERCIAL_YN='1' THEN 'PRIVATE' ELSE 'COMMERCIAL'  \
                    END) ISCOMMERCIAL_YN,(SELECT MPM.POLICYTYPE_DESC_ENGLISH  \
                    FROM MOTOR_POLICYTYPE_MASTER MPM WHERE  \
                    MPM.POLICYTYPE_ID=ERD.POLICYTYPE)  \
                    POLICY_TYPE,ERD.INSURED_NAME || ' ' || ERD.JOINT_NAME  \
                    CUSTOMER_NAME,TO_CHAR (ERD.ENTRY_DATE, 'DD/MM/YYYY')  \
                    QUOTATION_DATE,(CASE WHEN ERD.APPLICATION_ID='1' THEN  \
                    ERD.LOGIN_ID ELSE ERD.APPLICATION_ID END) LOGIN_ID,(SELECT  \
                    HPM.OVERALL_PREMIUM FROM HOME_POSITION_MASTER HPM WHERE  \
                    HPM.QUOTE_NO=ERD.QUOTE_NO) PREMIUM, ERD.POLICYSTARTDATE  \
                    POLICY_START_DATE,(CASE WHEN ERD.STATUS = 'P' AND  \
                    ERD.INTEGRATION_STATUS = 'S' THEN 'P' WHEN ERD.STATUS =  \
                    'P' AND ERD.INTEGRATION_STATUS = 'F' THEN 'PD' WHEN  \
                    ERD.STATUS = 'D' AND ERD.INTEGRATION_STATUS = 'F' THEN 'D'  \
                    WHEN ERD.STATUS = 'Y' AND ERD.CUST_APPROVE_STATUS = 'Y'  \
                    THEN 'CAQ' WHEN ERD.STATUS = 'Y' AND  \
                    ERD.CUST_APPROVE_STATUS = 'N' THEN 'CRQ' WHEN ERD.STATUS =  \
                    'Y' AND ERD.CUST_APPROVE_STATUS = 'P' THEN 'CPQ' WHEN  \
                    ERD.STATUS = 'Y' AND ERD.CUST_APPROVE_STATUS = 'R' THEN  \
                    'CREQ' WHEN HPM.STATUS = 'Y' AND ERD.STATUS = 'R' AND  \
                    HPM.REMARKS = 'Referal' THEN 'UQ' WHEN HPM.STATUS = 'Y'  \
                    AND HPM.REMARKS IN('Admin') THEN 'AQ' WHEN HPM.STATUS =  \
                    'Y' AND (ERD.STATUS = 'R' OR ERD.STATUS = 'D') AND  \
                    HPM.REMARKS = 'Referal' AND HPM.ADMIN_REMARKS IS NOT NULL  \
                    AND HPM.ADMIN_REFERRAL_STATUS IS NOT NULL THEN 'RRQ' WHEN  \
                    ERD.INTEGRATION_STATUS IS NULL AND ERD.STATUS = 'Y' AND  \
                    TRUNC (ERD.ENTRY_DATE) > TRUNC (SYSDATE) - 30 AND ERD.CUST_APPROVE_STATUS IS NULL THEN 'EQ' WHEN (ERD.STATUS  \
                    = 'R' OR ERD.STATUS = 'D') AND (ERD.STATUS = 'R' OR  \
                    ERD.STATUS = 'D') AND HPM.REMARKS NOT IN ('Referal') THEN  \
                    'RQ' WHEN ERD.INTEGRATION_STATUS IS NULL AND ERD.STATUS =  \
                    'Y' AND TRUNC (ERD.ENTRY_DATE) < TRUNC (SYSDATE) - 30 AND  \
                    ERD.CUST_APPROVE_STATUS IS NULL THEN 'EXQ' END)  \
                    STATUS_TYPE, (CASE WHEN ERD.STATUS = 'P' AND  \
                    ERD.INTEGRATION_STATUS = 'S' THEN 'Policies' WHEN  \
                    ERD.STATUS = 'P' AND ERD.INTEGRATION_STATUS = 'F' THEN  \
                    'Pending Policy' WHEN ERD.STATUS = 'D' AND  \
                    ERD.INTEGRATION_STATUS = 'F' THEN 'Cancel Policy' WHEN  \
                    ERD.STATUS = 'Y' AND ERD.CUST_APPROVE_STATUS = 'Y' THEN  \
                    'Customer Approved Quote' WHEN ERD.STATUS = 'Y' AND  \
                    ERD.CUST_APPROVE_STATUS = 'N' THEN 'Customer Rejected  \
                    Quote' WHEN ERD.STATUS = 'Y' AND ERD.CUST_APPROVE_STATUS =  \
                    'P' THEN 'Customer Pending Quote' WHEN ERD.STATUS = 'Y'  \
                    AND ERD.CUST_APPROVE_STATUS = 'R' THEN 'Customer Rejected  \
                    for ReQuote' WHEN HPM.STATUS = 'Y' AND ERD.STATUS = 'R'  \
                    AND HPM.REMARKS = 'Referal' THEN 'Referral Pending Quote'  \
                    WHEN HPM.STATUS = 'Y' AND HPM.REMARKS IN ('Admin') THEN  \
                    'Referral Approved Quote' WHEN HPM.STATUS = 'Y' AND  \
                    (ERD.STATUS = 'R' OR ERD.STATUS = 'D') AND HPM.REMARKS =  \
                    'Referal' AND HPM.ADMIN_REMARKS IS NOT NULL AND  \
                    HPM.ADMIN_REFERRAL_STATUS IS NOT NULL THEN 'Referral  \
                    Rejected Quote' WHEN ERD.INTEGRATION_STATUS IS NULL AND  \
                    ERD.STATUS = 'Y' AND TRUNC (ERD.ENTRY_DATE) > TRUNC  \
                    (SYSDATE) - 30 AND ERD.CUST_APPROVE_STATUS IS NULL THEN  \
                    'Existing Quote' WHEN (ERD.STATUS = 'R' OR ERD.STATUS =  \
                    'D') AND (ERD.STATUS = 'R' OR ERD.STATUS = 'D') AND  \
                    HPM.REMARKS NOT IN ('Referal') THEN 'Rejected Quote' WHEN  \
                    ERD.INTEGRATION_STATUS IS NULL AND ERD.STATUS = 'Y' AND  \
                    TRUNC (ERD.ENTRY_DATE) < TRUNC (SYSDATE) - 30 AND  \
                    ERD.CUST_APPROVE_STATUS IS NULL THEN 'Lapsed Quote' END) STATUS_TYPE_NAME,(SELECT BRANCH_NAME FROM BRANCH_MASTER  \
                    WHERE BRANCH_CODE=ERD.BRANCH_CODE) BRANCH_NAME,ERD.STATUS  \
                    ORG_STATUS FROM ESERVICE_REQUEST_DETAIL ERD,  \
                    HOME_POSITION_MASTER HPM WHERE  \
                    ERD.QUOTE_NO=HPM.QUOTE_NO (+) \
                    AND ERD.RENEWAL_POLICYNO=?1

REQ_REF_NO_ADMIN = SELECT ERD.MOBILE,ERD.REQUESTREFERENCENO \
                   REQREFNO,ERD.POLICYENDDATE \
                   EXPIRY_DATE,ERD.POLICY_NO,TO_CHAR (ERD.ENTRY_DATE, \
                   'DD/MM/YYYY') EFFECTIVE_DATE,(CASE WHEN \
                   ERD.ISCOMMERCIAL_YN='1' THEN 'PRIVATE' ELSE 'COMMERCIAL' \
                   END) ISCOMMERCIAL_YN,(SELECT MPM.POLICYTYPE_DESC_ENGLISH \
                   FROM MOTOR_POLICYTYPE_MASTER MPM WHERE \
                   MPM.POLICYTYPE_ID=ERD.POLICYTYPE) \
                   POLICY_TYPE,ERD.QUOTE_NO,ERD.INSURED_NAME || ' ' || \
                   ERD.JOINT_NAME CUSTOMER_NAME,TO_CHAR (ERD.ENTRY_DATE, \
                   'DD/MM/YYYY') QUOTATION_DATE,(CASE WHEN \
                   ERD.APPLICATION_ID='1' THEN ERD.LOGIN_ID ELSE \
                   ERD.APPLICATION_ID END) LOGIN_ID,(SELECT \
                   HPM.OVERALL_PREMIUM FROM HOME_POSITION_MASTER HPM WHERE \
                   HPM.QUOTE_NO=ERD.QUOTE_NO) PREMIUM, ERD.POLICYSTARTDATE \
                   POLICY_START_DATE,(CASE WHEN ERD.STATUS = 'P' AND \
                   ERD.INTEGRATION_STATUS = 'S' THEN 'P' WHEN ERD.STATUS = 'P' \
                   AND ERD.INTEGRATION_STATUS = 'F' THEN 'PD' WHEN ERD.STATUS \
                   = 'D' AND ERD.INTEGRATION_STATUS = 'F' THEN 'D' WHEN \
                   ERD.STATUS = 'Y' AND ERD.CUST_APPROVE_STATUS = 'Y' THEN \
                   'CAQ' WHEN ERD.STATUS = 'Y' AND ERD.CUST_APPROVE_STATUS = \
                   'N' THEN 'CRQ' WHEN ERD.STATUS = 'Y' AND \
                   ERD.CUST_APPROVE_STATUS = 'P' THEN 'CPQ' WHEN ERD.STATUS = \
                   'Y' AND ERD.CUST_APPROVE_STATUS = 'R' THEN 'CREQ' WHEN \
                   HPM.STATUS = 'Y' AND ERD.STATUS = 'R' AND HPM.REMARKS = \
                   'Referal' THEN 'UQ' WHEN HPM.STATUS = 'Y' AND HPM.REMARKS \
                   IN('Admin') THEN 'AQ' WHEN HPM.STATUS = 'Y' AND (ERD.STATUS \
                   = 'R' OR ERD.STATUS = 'D') AND HPM.REMARKS = 'Referal' AND \
                   HPM.ADMIN_REMARKS IS NOT NULL AND HPM.ADMIN_REFERRAL_STATUS \
                   IS NOT NULL THEN 'RRQ' WHEN ERD.INTEGRATION_STATUS IS NULL \
                   AND ERD.STATUS = 'Y' AND TRUNC (ERD.ENTRY_DATE) > TRUNC \
                   (SYSDATE) - 30 AND ERD.CUST_APPROVE_STATUS IS NULL THEN \
                   'EQ' WHEN (ERD.STATUS = 'R' OR ERD.STATUS = 'D') AND \
                   (ERD.STATUS = 'R' OR ERD.STATUS = 'D') AND HPM.REMARKS NOT \
                   IN ('Referal') THEN 'RQ' WHEN ERD.INTEGRATION_STATUS IS \
                   NULL AND ERD.STATUS = 'Y' AND TRUNC (ERD.ENTRY_DATE) < \
                   TRUNC (SYSDATE) - 30 AND ERD.CUST_APPROVE_STATUS IS NULL \
                   THEN 'EXQ' END) STATUS_TYPE, (CASE WHEN ERD.STATUS = 'P' \
                   AND ERD.INTEGRATION_STATUS = 'S' THEN 'Policies' WHEN \
                   ERD.STATUS = 'P' AND ERD.INTEGRATION_STATUS = 'F' THEN \
                   'Pending Policy' WHEN ERD.STATUS = 'D' AND \
                   ERD.INTEGRATION_STATUS = 'F' THEN 'Cancel Policy' WHEN \
                   ERD.STATUS = 'Y' AND ERD.CUST_APPROVE_STATUS = 'Y' THEN \
                   'Customer Approved Quote' WHEN ERD.STATUS = 'Y' AND \
                   ERD.CUST_APPROVE_STATUS = 'N' THEN 'Customer Rejected \
                   Quote' WHEN ERD.STATUS = 'Y' AND ERD.CUST_APPROVE_STATUS = \
                   'P' THEN 'Customer Pending Quote' WHEN ERD.STATUS = 'Y' AND \
                   ERD.CUST_APPROVE_STATUS = 'R' THEN 'Customer Rejected for \
                   ReQuote' WHEN HPM.STATUS = 'Y' AND ERD.STATUS = 'R' AND \
                   HPM.REMARKS = 'Referal' THEN 'Referral Pending Quote' WHEN \
                   HPM.STATUS = 'Y' AND HPM.REMARKS IN ('Admin') THEN \
                   'Referral Approved Quote' WHEN HPM.STATUS = 'Y' AND \
                   (ERD.STATUS = 'R' OR ERD.STATUS = 'D') AND HPM.REMARKS = \
                   'Referal' AND HPM.ADMIN_REMARKS IS NOT NULL AND \
                   HPM.ADMIN_REFERRAL_STATUS IS NOT NULL THEN 'Referral \
                   Rejected Quote' WHEN ERD.INTEGRATION_STATUS IS NULL AND \
                   ERD.STATUS = 'Y' AND TRUNC (ERD.ENTRY_DATE) > TRUNC \
                   (SYSDATE) - 30 AND ERD.CUST_APPROVE_STATUS IS NULL THEN \
                   'Existing Quote' WHEN (ERD.STATUS = 'R' OR ERD.STATUS = \
                   'D') AND (ERD.STATUS = 'R' OR ERD.STATUS = 'D') AND \
                   HPM.REMARKS NOT IN ('Referal') THEN 'Rejected Quote' WHEN \
                   ERD.INTEGRATION_STATUS IS NULL AND ERD.STATUS = 'Y' AND \
                   TRUNC (ERD.ENTRY_DATE) < TRUNC (SYSDATE) - 30 AND \
                   ERD.CUST_APPROVE_STATUS IS NULL THEN 'Lapsed Quote' END) \
                   STATUS_TYPE_NAME,?1,?3,(SELECT BRANCH_NAME FROM \
                   BRANCH_MASTER WHERE BRANCH_CODE=ERD.BRANCH_CODE) \
                   BRANCH_NAME,ERD.STATUS ORG_STATUS FROM \
                   ESERVICE_REQUEST_DETAIL ERD, HOME_POSITION_MASTER HPM WHERE \
                   ERD.QUOTE_NO=HPM.QUOTE_NO (+) AND ERD.PRODUCT_ID=?2  

REQ_REF_NO_SEARCH = SELECT  ERD.REQUESTREFERENCENO REQREFNO,ERD.POLICYENDDATE \
                    EXPIRY_DATE,ERD.QUOTE_NO,ERD.POLICY_NO,TO_CHAR \
                    (ERD.ENTRY_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE,(CASE WHEN \
                    ERD.ISCOMMERCIAL_YN='1' THEN 'PRIVATE' ELSE 'COMMERCIAL' \
                    END) ISCOMMERCIAL_YN,(SELECT MPM.POLICYTYPE_DESC_ENGLISH \
                    FROM MOTOR_POLICYTYPE_MASTER MPM WHERE \
                    MPM.POLICYTYPE_ID=ERD.POLICYTYPE) \
                    POLICY_TYPE,ERD.INSURED_NAME || ' ' || ERD.JOINT_NAME \
                    CUSTOMER_NAME,TO_CHAR (ERD.ENTRY_DATE, 'DD/MM/YYYY') \
                    QUOTATION_DATE,(CASE WHEN ERD.APPLICATION_ID='1' THEN \
                    ERD.LOGIN_ID ELSE ERD.APPLICATION_ID END) LOGIN_ID,(SELECT \
                    HPM.OVERALL_PREMIUM FROM HOME_POSITION_MASTER HPM WHERE \
                    HPM.QUOTE_NO=ERD.QUOTE_NO) PREMIUM, ERD.POLICYSTARTDATE \
                    POLICY_START_DATE,(CASE WHEN ERD.STATUS = 'P' AND \
                    ERD.INTEGRATION_STATUS = 'S' THEN 'P' WHEN ERD.STATUS = \
                    'P' AND ERD.INTEGRATION_STATUS = 'F' THEN 'PD' WHEN \
                    ERD.STATUS = 'D' AND ERD.INTEGRATION_STATUS = 'F' THEN 'D' \
                    WHEN ERD.STATUS = 'Y' AND ERD.CUST_APPROVE_STATUS = 'Y' \
                    THEN 'CAQ' WHEN ERD.STATUS = 'Y' AND \
                    ERD.CUST_APPROVE_STATUS = 'N' THEN 'CRQ' WHEN ERD.STATUS = \
                    'Y' AND ERD.CUST_APPROVE_STATUS = 'P' THEN 'CPQ' WHEN \
                    ERD.STATUS = 'Y' AND ERD.CUST_APPROVE_STATUS = 'R' THEN \
                    'CREQ' WHEN HPM.STATUS = 'Y' AND ERD.STATUS = 'R' AND \
                    HPM.REMARKS = 'Referal' THEN 'UQ' WHEN HPM.STATUS = 'Y' \
                    AND HPM.REMARKS IN('Admin') THEN 'AQ' WHEN HPM.STATUS = \
                    'Y' AND (ERD.STATUS = 'R' OR ERD.STATUS = 'D') AND \
                    HPM.REMARKS = 'Referal' AND HPM.ADMIN_REMARKS IS NOT NULL \
                    AND HPM.ADMIN_REFERRAL_STATUS IS NOT NULL THEN 'RRQ' WHEN \
                    ERD.INTEGRATION_STATUS IS NULL AND ERD.STATUS = 'Y' AND \
                    TRUNC (ERD.ENTRY_DATE) > TRUNC (SYSDATE) - 30 AND \
                    ERD.CUST_APPROVE_STATUS IS NULL THEN 'EQ' WHEN (ERD.STATUS \
                    = 'R' OR ERD.STATUS = 'D') AND (ERD.STATUS = 'R' OR \
                    ERD.STATUS = 'D') AND HPM.REMARKS NOT IN ('Referal') THEN \
                    'RQ' WHEN ERD.INTEGRATION_STATUS IS NULL AND ERD.STATUS = \
                    'Y' AND TRUNC (ERD.ENTRY_DATE) < TRUNC (SYSDATE) - 30 AND \
                    ERD.CUST_APPROVE_STATUS IS NULL THEN 'EXQ' END) \
                    STATUS_TYPE, (CASE WHEN ERD.STATUS = 'P' AND \
                    ERD.INTEGRATION_STATUS = 'S' THEN 'Policies' WHEN \
                    ERD.STATUS = 'P' AND ERD.INTEGRATION_STATUS = 'F' THEN \
                    'Pending Policy' WHEN ERD.STATUS = 'D' AND \
                    ERD.INTEGRATION_STATUS = 'F' THEN 'Cancel Policy' WHEN \
                    ERD.STATUS = 'Y' AND ERD.CUST_APPROVE_STATUS = 'Y' THEN \
                    'Customer Approved Quote' WHEN ERD.STATUS = 'Y' AND \
                    ERD.CUST_APPROVE_STATUS = 'N' THEN 'Customer Rejected \
                    Quote' WHEN ERD.STATUS = 'Y' AND ERD.CUST_APPROVE_STATUS = \
                    'P' THEN 'Customer Pending Quote' WHEN ERD.STATUS = 'Y' \
                    AND ERD.CUST_APPROVE_STATUS = 'R' THEN 'Customer Rejected \
                    for ReQuote' WHEN HPM.STATUS = 'Y' AND ERD.STATUS = 'R' \
                    AND HPM.REMARKS = 'Referal' THEN 'Referral Pending Quote' \
                    WHEN HPM.STATUS = 'Y' AND HPM.REMARKS IN ('Admin') THEN \
                    'Referral Approved Quote' WHEN HPM.STATUS = 'Y' AND \
                    (ERD.STATUS = 'R' OR ERD.STATUS = 'D') AND HPM.REMARKS = \
                    'Referal' AND HPM.ADMIN_REMARKS IS NOT NULL AND \
                    HPM.ADMIN_REFERRAL_STATUS IS NOT NULL THEN 'Referral \
                    Rejected Quote' WHEN ERD.INTEGRATION_STATUS IS NULL AND \
                    ERD.STATUS = 'Y' AND TRUNC (ERD.ENTRY_DATE) > TRUNC \
                    (SYSDATE) - 30 AND ERD.CUST_APPROVE_STATUS IS NULL THEN \
                    'Existing Quote' WHEN (ERD.STATUS = 'R' OR ERD.STATUS = \
                    'D') AND (ERD.STATUS = 'R' OR ERD.STATUS = 'D') AND \
                    HPM.REMARKS NOT IN ('Referal') THEN 'Rejected Quote' WHEN \
                    ERD.INTEGRATION_STATUS IS NULL AND ERD.STATUS = 'Y' AND \
                    TRUNC (ERD.ENTRY_DATE) < TRUNC (SYSDATE) - 30 AND \
                    ERD.CUST_APPROVE_STATUS IS NULL THEN 'Lapsed Quote' END) \
                    STATUS_TYPE_NAME,(SELECT BRANCH_NAME FROM BRANCH_MASTER \
                    WHERE BRANCH_CODE=ERD.BRANCH_CODE) BRANCH_NAME,ERD.STATUS \
                    ORG_STATUS FROM ESERVICE_REQUEST_DETAIL ERD, \
                    HOME_POSITION_MASTER HPM WHERE  ERD.LOGIN_ID=?1 AND \
                    ERD.PRODUCT_ID=?2 AND ERD.QUOTE_NO=HPM.QUOTE_NO (+) AND \
                    (ERD.APPLICATION_ID =?3 OR ?3 IS NULL)      

REQ_REF_NO_SEARCH_WO_LOGINID = SELECT  ERD.REQUESTREFERENCENO \
                               REQREFNO,ERD.POLICYENDDATE \
                               EXPIRY_DATE,ERD.POLICY_NO,TO_CHAR \
                               (ERD.ENTRY_DATE, 'DD/MM/YYYY') \
                               EFFECTIVE_DATE,(CASE WHEN \
                               ERD.ISCOMMERCIAL_YN='1' THEN 'PRIVATE' ELSE \
                               'COMMERCIAL' END) ISCOMMERCIAL_YN,(SELECT \
                               MPM.POLICYTYPE_DESC_ENGLISH FROM \
                               MOTOR_POLICYTYPE_MASTER MPM WHERE \
                               MPM.POLICYTYPE_ID=ERD.POLICYTYPE) \
                               POLICY_TYPE,ERD.QUOTE_NO,ERD.INSURED_NAME || ' \
                               ' || ERD.JOINT_NAME CUSTOMER_NAME,TO_CHAR \
                               (ERD.ENTRY_DATE, 'DD/MM/YYYY') \
                               QUOTATION_DATE,(CASE WHEN \
                               ERD.APPLICATION_ID='1' THEN ERD.LOGIN_ID ELSE \
                               ERD.APPLICATION_ID END) LOGIN_ID,(SELECT \
                               HPM.OVERALL_PREMIUM FROM HOME_POSITION_MASTER \
                               HPM WHERE HPM.QUOTE_NO=ERD.QUOTE_NO) PREMIUM, \
                               ERD.POLICYSTARTDATE POLICY_START_DATE,(CASE \
                               WHEN ERD.STATUS = 'P' AND \
                               ERD.INTEGRATION_STATUS = 'S' THEN 'P' WHEN \
                               ERD.STATUS = 'P' AND ERD.INTEGRATION_STATUS = \
                               'F' THEN 'PD' WHEN ERD.STATUS = 'D' AND \
                               ERD.INTEGRATION_STATUS = 'F' THEN 'D' WHEN \
                               ERD.STATUS = 'Y' AND ERD.CUST_APPROVE_STATUS = \
                               'Y' THEN 'CAQ' WHEN ERD.STATUS = 'Y' AND \
                               ERD.CUST_APPROVE_STATUS = 'N' THEN 'CRQ' WHEN \
                               ERD.STATUS = 'Y' AND ERD.CUST_APPROVE_STATUS = \
                               'P' THEN 'CPQ' WHEN ERD.STATUS = 'Y' AND \
                               ERD.CUST_APPROVE_STATUS = 'R' THEN 'CREQ' WHEN \
                               HPM.STATUS = 'Y' AND ERD.STATUS = 'R' AND \
                               HPM.REMARKS = 'Referal' THEN 'UQ' WHEN \
                               HPM.STATUS = 'Y' AND HPM.REMARKS IN('Admin') \
                               THEN 'AQ' WHEN HPM.STATUS = 'Y' AND (ERD.STATUS \
                               = 'R' OR ERD.STATUS = 'D') AND HPM.REMARKS = \
                               'Referal' AND HPM.ADMIN_REMARKS IS NOT NULL AND \
                               HPM.ADMIN_REFERRAL_STATUS IS NOT NULL THEN \
                               'RRQ' WHEN ERD.INTEGRATION_STATUS IS NULL AND \
                               ERD.STATUS = 'Y' AND TRUNC (ERD.ENTRY_DATE) > \
                               TRUNC (SYSDATE) - 30 AND \
                               ERD.CUST_APPROVE_STATUS IS NULL THEN 'EQ' WHEN \
                               (ERD.STATUS = 'R' OR ERD.STATUS = 'D') AND \
                               (ERD.STATUS = 'R' OR ERD.STATUS = 'D') AND \
                               HPM.REMARKS NOT IN ('Referal') THEN 'RQ' WHEN \
                               ERD.INTEGRATION_STATUS IS NULL AND ERD.STATUS = \
                               'Y' AND TRUNC (ERD.ENTRY_DATE) < TRUNC \
                               (SYSDATE) - 30 AND ERD.CUST_APPROVE_STATUS IS \
                               NULL THEN 'EXQ' END) STATUS_TYPE, (CASE WHEN \
                               ERD.STATUS = 'P' AND ERD.INTEGRATION_STATUS = \
                               'S' THEN 'Policies' WHEN ERD.STATUS = 'P' AND \
                               ERD.INTEGRATION_STATUS = 'F' THEN 'Pending \
                               Policy' WHEN ERD.STATUS = 'D' AND \
                               ERD.INTEGRATION_STATUS = 'F' THEN 'Cancel \
                               Policy' WHEN ERD.STATUS = 'Y' AND \
                               ERD.CUST_APPROVE_STATUS = 'Y' THEN 'Customer \
                               Approved Quote' WHEN ERD.STATUS = 'Y' AND \
                               ERD.CUST_APPROVE_STATUS = 'N' THEN 'Customer \
                               Rejected Quote' WHEN ERD.STATUS = 'Y' AND \
                               ERD.CUST_APPROVE_STATUS = 'P' THEN 'Customer \
                               Pending Quote' WHEN ERD.STATUS = 'Y' AND \
                               ERD.CUST_APPROVE_STATUS = 'R' THEN 'Customer \
                               Rejected for ReQuote' WHEN HPM.STATUS = 'Y' AND \
                               ERD.STATUS = 'R' AND HPM.REMARKS = 'Referal' \
                               THEN 'Referral Pending Quote' WHEN HPM.STATUS = \
                               'Y' AND HPM.REMARKS IN ('Admin') THEN 'Referral \
                               Approved Quote' WHEN HPM.STATUS = 'Y' AND \
                               (ERD.STATUS = 'R' OR ERD.STATUS = 'D') AND \
                               HPM.REMARKS = 'Referal' AND HPM.ADMIN_REMARKS \
                               IS NOT NULL AND HPM.ADMIN_REFERRAL_STATUS IS \
                               NOT NULL THEN 'Referral Rejected Quote' WHEN \
                               ERD.INTEGRATION_STATUS IS NULL AND ERD.STATUS = \
                               'Y' AND TRUNC (ERD.ENTRY_DATE) > TRUNC \
                               (SYSDATE) - 30 AND ERD.CUST_APPROVE_STATUS IS \
                               NULL THEN 'Existing Quote' WHEN (ERD.STATUS = \
                               'R' OR ERD.STATUS = 'D') AND (ERD.STATUS = 'R' \
                               OR ERD.STATUS = 'D') AND HPM.REMARKS NOT IN \
                               ('Referal') THEN 'Rejected Quote' WHEN \
                               ERD.INTEGRATION_STATUS IS NULL AND ERD.STATUS = \
                               'Y' AND TRUNC (ERD.ENTRY_DATE) < TRUNC \
                               (SYSDATE) - 30 AND ERD.CUST_APPROVE_STATUS IS \
                               NULL THEN 'Lapsed Quote' END) \
                               STATUS_TYPE_NAME,?1,(SELECT BRANCH_NAME FROM \
                               BRANCH_MASTER WHERE \
                               BRANCH_CODE=ERD.BRANCH_CODE) \
                               BRANCH_NAME,ERD.STATUS ORG_STATUS FROM \
                               ESERVICE_REQUEST_DETAIL ERD, \
                               HOME_POSITION_MASTER HPM WHERE \
                               ERD.PRODUCT_ID=?2 AND ERD.QUOTE_NO=HPM.QUOTE_NO \
                               (+) AND (ERD.APPLICATION_ID =?3 OR ?3 IS NULL)  \
                                  

RSACARD_SEARCH = AND HPM.RSA_CARDNO=?4 ORDER BY HPM.QUOTE_NO

RSAISSUER = select DETAIL_NAME CODE,REMARKS CODEDESC from \
            marine_constant_detail where PRODUCT_ID=?1 AND RSACODE='SEARCH' \
            AND STATUS='Y'

RSA_DROPDOWN_BROKER = SELECT * FROM (SELECT DISTINCT PM.LOGIN_ID CODE, \
                      PM.LOGIN_ID FIRST_NAME, BCM.COMPANY_NAME CODEDESC, \
                      LM.OA_CODE FROM RSA_MASTER_DETAILS PM, LOGIN_MASTER LM, \
                      BROKER_COMPANY_MASTER BCM WHERE LM.LOGIN_ID = \
                      PM.LOGIN_ID AND LM.AGENCY_CODE = BCM.AGENCY_CODE AND \
                      PM.STATUS IN ('P', 'Y') AND BCM.BRANCH_CODE = ?1 AND \
                      PM.BROKER_CODE = BCM.AGENCY_CODE AND PM.BDM_CODE IS NULL \
                      and lm.status='Y' and BCM.status='Y' AND LM.OA_CODE NOT \
                      IN (SELECT BROKER_CODE FROM LOGIN_RSAUSER_DETAILS WHERE \
                      LOGIN_ID = ?2 AND PRODUCT_ID = ?3) UNION ALL SELECT \
                      DISTINCT LM.LOGIN_ID CODE, USERNAME, USERNAME CODEDESC, \
                      LM.OA_CODE FROM login_master lm, RSA_MASTER_DETAILS PM \
                      WHERE lm.usertype = 'User' AND lm.BRANCH_CODE = ?1 AND \
                      lm.OA_CODE != '90016' AND PM.STATUS IN ('P', 'Y') AND \
                      PM.login_id = lm.login_id AND PM.broker_code = \
                      lm.agency_code AND PM.BDM_CODE IS NULL and lm.status='Y' \
                      AND lm.AGENCY_CODE IN (SELECT DISTINCT AGENCY_CODE FROM \
                      LOGIN_USER_DETAILS LR WHERE PRODUCT_ID = ?3 AND STATUS = \
                      'Y' AND LR.LOGIN_ID = lm.LOGIN_ID) UNION ALL SELECT \
                      DISTINCT pcd.CUSTOMER_CODE CODE, pcd.CUSTOMER_NAME, \
                      pcd.CUSTOMER_NAME CODEDESC, pcd.CUSTOMER_CODE FROM \
                      PREMIA_CUSTOMER_DETAILS pcd, RSA_MASTER_DETAILS PM WHERE \
                      CUSTOMER_TYPE = '009' AND CUSTOMER_CATEGORY = (SELECT \
                      CORE_APP_CODE FROM branch_master WHERE   status = 'Y' \
                      AND branch_code =?1) AND (SELECT CORE_APP_CODE FROM \
                      branch_master WHERE status = 'Y' AND branch_code = ?1) \
                      BETWEEN DIVISION_FROM AND DIVISION_TO AND PM.BDM_CODE IS \
                      NOT NULL AND PM.BDM_CODE = pcd.CUSTOMER_CODE AND \
                      PM.STATUS IN ('P', 'Y') AND pcd.status = 'Y') ORDER BY \
                      CODEDESC

RSA_EXISTING_DATA = SELECT \
                    REFERENCE_NO,QUOTE_NO,CUSTOMER_ID,(POLICY_FIRST_NAME||' \
                    '||POLICY_LAST_NAME) \
                    CUSTOMER_NAME,TO_CHAR(ENTRY_DATE,'DD/MM/YYYY') \
                    QUOTATION_DATE,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY') \
                    VALIDITY_DATE ,NVL(TOTAL_PREMIUM,0) PREMIUM FROM \
                    RSA_MASTER_DETAILS WHERE (CASE WHEN BDM_CODE IS NULL THEN \
                    LOGIN_ID ELSE BDM_CODE END)=?1 AND STATUS='Y' AND  \
                    APPLICATION_ID=NVL(?2,'1')  ORDER BY QUOTE_NO DESC

#*********************************************************** SERCHING DATA *****************************************************************************
SEARCHDATA = SELECT   hpm.QUOTE_NO,hpm.CUSTOMER_ID,TO_CHAR(hpm.EXPIRY_DATE, \
             'DD/MM/YYYY') EXPIRY_DATE,(SELECT REQ_REF_NO FROM \
             MOTOR_DATA_DETAIL MDD WHERE MDD.QUOTE_NO=HPM.QUOTE_NO AND \
             HPM.APPLICATION_NO = MDD.APPLICATION_NO) REQREFNO,(SELECT CASE \
             WHEN MDD.ISCOMMERCIAL_YN ='N' THEN 'PRIVATE' ELSE 'COMMERCIAL' \
             END FROM MOTOR_DATA_DETAIL MDD WHERE HPM.QUOTE_NO = MDD.QUOTE_NO \
             AND HPM.APPLICATION_NO = MDD.APPLICATION_NO) \
             ISCOMMERCIAL_YN,(SELECT MPM.POLICYTYPE_DESC_ENGLISH FROM \
             MOTOR_POLICYTYPE_MASTER MPM WHERE MPM.POLICYTYPE_ID=(SELECT \
             POLICYTYPE FROM MOTOR_DATA_DETAIL MDD WHERE \
             MDD.QUOTE_NO=HPM.QUOTE_NO AND HPM.APPLICATION_NO = \
             MDD.APPLICATION_NO)) POLICY_TYPE, TO_CHAR(HPM.ENTRY_DATE, \
             'DD/MM/YYYY') QUOTATION_DATE,TO_CHAR (HPM.ENTRY_DATE, \
             'DD/MM/YYYY') ENTRY_DATE,TO_CHAR (hpm.EFFECTIVE_DATE, \
             'DD/MM/YYYY') VALIDITY_DATE,NVL (pi.COMPANY_NAME, pi.FIRST_NAME) \
             || ' ' || PI.JOINT_NAME CUSTOMER_NAME,(CASE WHEN \
             HPM.APPLICATION_ID='1' THEN HPM.LOGIN_ID ELSE HPM.APPLICATION_ID \
             END) LOGIN_ID,pi.COMPANY_NAME,TO_CHAR (hpm.INCEPTION_DATE, \
             'DD/MM/YYYY') POLICY_START_DATE,NVL (hpm.OVERALL_PREMIUM, 0) \
             PREMIUM,TO_CHAR (hpm.EFFECTIVE_DATE, 'DD/MM/YYYY') \
             EFFECTIVE_DATE,hpm.POLICY_NO,HPM.STATUS ORG_STATUS,(CASE WHEN \
             HPM.STATUS='P' AND HPM.INTEGRATION_STATUS ='S' THEN 'P' WHEN \
             HPM.STATUS='P' AND HPM.INTEGRATION_STATUS ='F' THEN 'PD' WHEN \
             HPM.STATUS='D' AND HPM.INTEGRATION_STATUS ='F' THEN 'D' WHEN \
             HPM.STATUS='Y' AND HPM.CUST_APPROVE_STATUS='Y'  AND (HPM.REMARKS \
             IS NULL OR HPM.REMARKS!='Referal') THEN 'CAQ' WHEN HPM.STATUS='Y' \
             AND HPM.CUST_APPROVE_STATUS='N' AND (HPM.REMARKS IS NULL OR \
             HPM.REMARKS!='Referal') THEN 'CRQ' WHEN HPM.STATUS='Y' AND \
             HPM.CUST_APPROVE_STATUS='P'  AND (HPM.REMARKS IS NULL OR \
             HPM.REMARKS!='Referal') THEN 'CPQ' WHEN HPM.STATUS='Y' AND \
             HPM.CUST_APPROVE_STATUS='R'  AND (HPM.REMARKS IS NULL OR \
             HPM.REMARKS!='Referal') THEN 'CREQ' WHEN HPM.STATUS='Y' AND \
             ERD.STATUS='R' AND HPM.REMARKS = 'Referal' THEN 'UQ' WHEN \
             HPM.STATUS='Y' AND HPM.REMARKS IN('Admin') THEN 'AQ' WHEN \
             HPM.STATUS='R' AND (ERD.STATUS='R' OR ERD.STATUS='D') AND \
             HPM.REMARKS = 'Referal' AND HPM.ADMIN_REMARKS IS NOT NULL AND \
             HPM.ADMIN_REFERRAL_STATUS IS NOT NULL THEN 'RRQ' WHEN \
             HPM.INTEGRATION_STATUS IS NULL AND HPM.STATUS = 'Y' AND \
             TRUNC(HPM.ENTRY_DATE) > TRUNC(SYSDATE) - 30 AND \
             HPM.CUST_APPROVE_STATUS IS NULL THEN 'EQ' WHEN (HPM.STATUS = 'R' \
             OR HPM.STATUS = 'D') AND (ERD.STATUS='R' OR ERD.STATUS='D') AND \
             HPM.REMARKS NOT IN ('Referal') THEN 'RQ' WHEN \
             HPM.INTEGRATION_STATUS IS NULL AND HPM.STATUS = 'Y' AND \
             TRUNC(HPM.ENTRY_DATE) < TRUNC(SYSDATE) - 30 AND \
             HPM.CUST_APPROVE_STATUS IS NULL THEN 'EXQ' END) STATUS_TYPE, \
             (CASE WHEN HPM.STATUS='P' AND HPM.INTEGRATION_STATUS ='S' THEN \
             'Policies' WHEN HPM.STATUS='P' AND HPM.INTEGRATION_STATUS ='F' \
             THEN 'Pending Policy' WHEN HPM.STATUS='D' AND \
             HPM.INTEGRATION_STATUS ='F' THEN 'Cancel Policy' WHEN \
             HPM.STATUS='Y' AND HPM.CUST_APPROVE_STATUS='Y'  AND (HPM.REMARKS \
             IS NULL OR HPM.REMARKS!='Referal') THEN 'Customer Approved Quote' \
             WHEN HPM.STATUS='Y' AND HPM.CUST_APPROVE_STATUS='N'  AND \
             (HPM.REMARKS IS NULL OR HPM.REMARKS!='Referal') THEN 'Customer \
             Rejected Quote' WHEN HPM.STATUS='Y' AND \
             HPM.CUST_APPROVE_STATUS='P'  AND (HPM.REMARKS IS NULL OR \
             HPM.REMARKS!='Referal') THEN 'Customer Pending Quote' WHEN \
             HPM.STATUS='Y' AND HPM.CUST_APPROVE_STATUS='R'  AND (HPM.REMARKS \
             IS NULL OR HPM.REMARKS!='Referal') THEN 'Customer Rejected for \
             ReQuote' WHEN HPM.STATUS='Y' AND ERD.STATUS='R' AND HPM.REMARKS = \
             'Referal' THEN 'Referral Pending Quote' WHEN HPM.STATUS='Y' AND \
             HPM.REMARKS IN ('Admin') THEN 'Referral Approved Quote' WHEN \
             HPM.STATUS='R' AND (ERD.STATUS='R' OR ERD.STATUS='D') AND \
             HPM.REMARKS = 'Referal' AND HPM.ADMIN_REMARKS IS NOT NULL AND \
             HPM.ADMIN_REFERRAL_STATUS IS NOT NULL THEN 'Referral Rejected \
             Quote' WHEN HPM.INTEGRATION_STATUS IS NULL AND HPM.STATUS = 'Y' \
             AND TRUNC(HPM.ENTRY_DATE) > TRUNC(SYSDATE) - 30 AND \
             HPM.CUST_APPROVE_STATUS IS NULL THEN 'Existing Quote' WHEN \
             (HPM.STATUS = 'R' OR HPM.STATUS = 'D') AND (ERD.STATUS='R' OR \
             ERD.STATUS='D') AND HPM.REMARKS NOT IN ('Referal') THEN 'Rejected \
             Quote' WHEN HPM.INTEGRATION_STATUS IS NULL AND HPM.STATUS = 'Y' \
             AND TRUNC(HPM.ENTRY_DATE) < TRUNC(SYSDATE) - 30 AND \
             HPM.CUST_APPROVE_STATUS IS NULL THEN 'Lapsed Quote' END) \
             STATUS_TYPE_NAME,(SELECT BRANCH_NAME FROM BRANCH_MASTER WHERE \
             BRANCH_CODE=HPM.BRANCH_CODE) BRANCH_NAME FROM   \
             HOME_POSITION_MASTER HPM, PERSONAL_INFO \
             PI,ESERVICE_REQUEST_DETAIL ERD WHERE (hpm.LOGIN_ID =?1 or \
             HPM.BDM_CODE=?1) AND hpm.CUSTOMER_ID = pi.CUSTOMER_ID AND \
             hpm.PRODUCT_ID =?2  AND ERD.QUOTE_NO=HPM.QUOTE_NO AND \
             ERD.APPLICATION_NO=HPM.APPLICATION_NO AND \
             ERD.CUSTOMER_ID=HPM.CUSTOMER_ID AND \
             ERD.CUSTOMER_ID=PI.CUSTOMER_ID AND (HPM.APPLICATION_ID =?3 OR ?3 \
             IS NULL) AND PI.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM \
             PERSONAL_INFO WHERE   CUSTOMER_ID = PI.CUSTOMER_ID) AND PI.STATUS \
             = 'Y'    

SEARCHDATA_ADMIN = SELECT HPM.MOBILE,HPM.QUOTE_NO,TO_CHAR(hpm.EXPIRY_DATE, \
                   'DD/MM/YYYY') EXPIRY_DATE, HPM.CUSTOMER_ID,(SELECT \
                   REQ_REF_NO FROM MOTOR_DATA_DETAIL MDD WHERE \
                   MDD.QUOTE_NO=HPM.QUOTE_NO AND HPM.APPLICATION_NO = \
                   MDD.APPLICATION_NO) REQREFNO,(SELECT CASE WHEN \
                   MDD.ISCOMMERCIAL_YN ='N' THEN 'PRIVATE' ELSE 'COMMERCIAL' \
                   END FROM MOTOR_DATA_DETAIL MDD WHERE HPM.QUOTE_NO = \
                   MDD.QUOTE_NO AND HPM.APPLICATION_NO = MDD.APPLICATION_NO) \
                   ISCOMMERCIAL_YN,(SELECT MPM.POLICYTYPE_DESC_ENGLISH FROM \
                   MOTOR_POLICYTYPE_MASTER MPM WHERE MPM.POLICYTYPE_ID=(SELECT \
                   POLICYTYPE FROM MOTOR_DATA_DETAIL MDD WHERE \
                   MDD.QUOTE_NO=HPM.QUOTE_NO AND HPM.APPLICATION_NO = \
                   MDD.APPLICATION_NO)) POLICY_TYPE, TO_CHAR(HPM.ENTRY_DATE, \
                   'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR (HPM.ENTRY_DATE, \
                   'DD/MM/YYYY') ENTRY_DATE, TO_CHAR (HPM.EFFECTIVE_DATE, \
                   'DD/MM/YYYY') VALIDITY_DATE, NVL (PI.COMPANY_NAME, \
                   PI.FIRST_NAME) || ' ' || PI.JOINT_NAME  CUSTOMER_NAME, \
                   (CASE WHEN HPM.APPLICATION_ID='1' THEN HPM.LOGIN_ID ELSE \
                   HPM.APPLICATION_ID END) LOGIN_ID, (SELECT COMPANY_NAME FROM \
                   BROKER_COMPANY_MASTER WHERE AGENCY_CODE = HPM.BROKER_CODE) \
                   BROKER_COMPANY_NAME, (SELECT DISTINCT CUSTOMER_NAME FROM \
                   PREMIA_CUSTOMER_DETAILS WHERE CUSTOMER_CODE = NVL \
                   (HPM.BDM_CODE, 0)) PREMIA_CUSTOMER_NAME, TO_CHAR \
                   (HPM.INCEPTION_DATE, 'DD/MM/YYYY') POLICY_START_DATE, NVL \
                   (HPM.OVERALL_PREMIUM, 0) PREMIUM, TO_CHAR \
                   (HPM.EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE, \
                   HPM.POLICY_NO, HPM.STATUS ORG_STATUS,(CASE WHEN \
                   HPM.STATUS='P' AND HPM.INTEGRATION_STATUS ='S' THEN 'P' \
                   WHEN HPM.STATUS='P' AND HPM.INTEGRATION_STATUS ='F' THEN \
                   'PD' WHEN HPM.STATUS='D' AND HPM.INTEGRATION_STATUS ='F' \
                   THEN 'D' WHEN HPM.STATUS='Y' AND \
                   HPM.CUST_APPROVE_STATUS='Y'  AND (HPM.REMARKS IS NULL OR \
                   HPM.REMARKS!='Referal') THEN 'CAQ' WHEN HPM.STATUS='Y' AND \
                   HPM.CUST_APPROVE_STATUS='N'  AND (HPM.REMARKS IS NULL OR \
                   HPM.REMARKS!='Referal') THEN 'CRQ' WHEN HPM.STATUS='Y' AND \
                   HPM.CUST_APPROVE_STATUS='P'  AND (HPM.REMARKS IS NULL OR \
                   HPM.REMARKS!='Referal') THEN 'CPQ' WHEN HPM.STATUS='Y' AND \
                   HPM.CUST_APPROVE_STATUS='R'  AND (HPM.REMARKS IS NULL OR \
                   HPM.REMARKS!='Referal') THEN 'CREQ' WHEN HPM.STATUS='Y' AND \
                   ERD.STATUS='R' AND HPM.REMARKS = 'Referal' THEN 'UQ' WHEN \
                   HPM.STATUS='Y' AND HPM.REMARKS IN('Admin') THEN 'AQ' WHEN \
                   HPM.STATUS='R' AND (ERD.STATUS='R' OR ERD.STATUS='D') AND \
                   HPM.REMARKS = 'Referal' AND HPM.ADMIN_REMARKS IS NOT NULL \
                   AND HPM.ADMIN_REFERRAL_STATUS IS NOT NULL THEN 'RRQ' WHEN \
                   HPM.INTEGRATION_STATUS IS NULL AND HPM.STATUS = 'Y' AND \
                   TRUNC(HPM.ENTRY_DATE) > TRUNC(SYSDATE) - 30 AND \
                   HPM.CUST_APPROVE_STATUS IS NULL THEN 'EQ' WHEN (HPM.STATUS \
                   = 'R' OR HPM.STATUS = 'D') AND (ERD.STATUS='R' OR \
                   ERD.STATUS='D') AND HPM.REMARKS NOT IN ('Referal') THEN \
                   'RQ' WHEN HPM.INTEGRATION_STATUS IS NULL AND HPM.STATUS = \
                   'Y' AND TRUNC(HPM.ENTRY_DATE) < TRUNC(SYSDATE) - 30 AND \
                   HPM.CUST_APPROVE_STATUS IS NULL THEN 'EXQ' END) \
                   STATUS_TYPE, (CASE WHEN HPM.STATUS='P' AND \
                   HPM.INTEGRATION_STATUS ='S' THEN 'Policies' WHEN \
                   HPM.STATUS='P' AND HPM.INTEGRATION_STATUS ='F' THEN \
                   'Pending Policy' WHEN HPM.STATUS='D' AND \
                   HPM.INTEGRATION_STATUS ='F' THEN 'Cancel Policy' WHEN \
                   HPM.STATUS='Y' AND HPM.CUST_APPROVE_STATUS='Y'  AND \
                   (HPM.REMARKS IS NULL OR HPM.REMARKS!='Referal') THEN \
                   'Customer Approved Quote' WHEN HPM.STATUS='Y' AND \
                   HPM.CUST_APPROVE_STATUS='N'  AND (HPM.REMARKS IS NULL OR \
                   HPM.REMARKS!='Referal') THEN 'Customer Rejected Quote' WHEN \
                   HPM.STATUS='Y' AND HPM.CUST_APPROVE_STATUS='P'  AND \
                   (HPM.REMARKS IS NULL OR HPM.REMARKS!='Referal') THEN \
                   'Customer Pending Quote' WHEN HPM.STATUS='Y' AND \
                   HPM.CUST_APPROVE_STATUS='R'  AND (HPM.REMARKS IS NULL OR \
                   HPM.REMARKS!='Referal') THEN 'Customer Rejected for \
                   ReQuote' WHEN HPM.STATUS='Y' AND ERD.STATUS='R' AND \
                   HPM.REMARKS = 'Referal' THEN 'Referral Pending Quote' WHEN \
                   HPM.STATUS='Y' AND HPM.REMARKS IN ('Admin') THEN 'Referral \
                   Approved Quote' WHEN HPM.STATUS='R' AND (ERD.STATUS='R' OR \
                   ERD.STATUS='D') AND HPM.REMARKS = 'Referal' AND \
                   HPM.ADMIN_REMARKS IS NOT NULL AND HPM.ADMIN_REFERRAL_STATUS \
                   IS NOT NULL THEN 'Referral Rejected Quote' WHEN \
                   HPM.INTEGRATION_STATUS IS NULL AND HPM.STATUS = 'Y' AND \
                   TRUNC(HPM.ENTRY_DATE) > TRUNC(SYSDATE) - 30 AND \
                   HPM.CUST_APPROVE_STATUS IS NULL THEN 'Existing Quote' WHEN \
                   (HPM.STATUS = 'R' OR HPM.STATUS = 'D') AND (ERD.STATUS='R' \
                   OR ERD.STATUS='D') AND HPM.REMARKS NOT IN ('Referal') THEN \
                   'Rejected Quote' WHEN HPM.INTEGRATION_STATUS IS NULL AND \
                   HPM.STATUS = 'Y' AND TRUNC(HPM.ENTRY_DATE) < TRUNC(SYSDATE) \
                   - 30 AND HPM.CUST_APPROVE_STATUS IS NULL THEN 'Lapsed \
                   Quote' END) STATUS_TYPE_NAME,?1 DOC_NO,?3 \
                   APPLICATION_ID,(SELECT BRANCH_NAME FROM BRANCH_MASTER WHERE \
                   BRANCH_CODE=HPM.BRANCH_CODE) BRANCH_NAME FROM \
                   HOME_POSITION_MASTER HPM, PERSONAL_INFO \
                   PI,ESERVICE_REQUEST_DETAIL ERD  WHERE HPM.CUSTOMER_ID = \
                   PI.CUSTOMER_ID AND HPM.PRODUCT_ID = ?2  AND \
                   ERD.QUOTE_NO=HPM.QUOTE_NO AND \
                   ERD.APPLICATION_NO=HPM.APPLICATION_NO AND \
                   ERD.CUSTOMER_ID=HPM.CUSTOMER_ID AND \
                   ERD.CUSTOMER_ID=PI.CUSTOMER_ID AND PI.AMEND_ID = (SELECT \
                   MAX (AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = \
                   PI.CUSTOMER_ID) AND PI.STATUS = 'Y'  

SEARCHDATA_WO_LOGINID = SELECT HPM.QUOTE_NO,TO_CHAR(hpm.EXPIRY_DATE, \
                        'DD/MM/YYYY') EXPIRY_DATE, HPM.CUSTOMER_ID,(SELECT \
                        REQ_REF_NO FROM MOTOR_DATA_DETAIL MDD WHERE \
                        MDD.QUOTE_NO=HPM.QUOTE_NO AND HPM.APPLICATION_NO = \
                        MDD.APPLICATION_NO) REQREFNO,(SELECT CASE WHEN \
                        MDD.ISCOMMERCIAL_YN ='N' THEN 'PRIVATE' ELSE \
                        'COMMERCIAL' END FROM MOTOR_DATA_DETAIL MDD WHERE \
                        HPM.QUOTE_NO = MDD.QUOTE_NO AND HPM.APPLICATION_NO = \
                        MDD.APPLICATION_NO) ISCOMMERCIAL_YN,(SELECT \
                        MPM.POLICYTYPE_DESC_ENGLISH FROM \
                        MOTOR_POLICYTYPE_MASTER MPM WHERE \
                        MPM.POLICYTYPE_ID=(SELECT POLICYTYPE FROM \
                        MOTOR_DATA_DETAIL MDD WHERE MDD.QUOTE_NO=HPM.QUOTE_NO \
                        AND HPM.APPLICATION_NO = MDD.APPLICATION_NO)) \
                        POLICY_TYPE, TO_CHAR(HPM.ENTRY_DATE, 'DD/MM/YYYY') \
                        QUOTATION_DATE, TO_CHAR (HPM.ENTRY_DATE, 'DD/MM/YYYY') \
                        ENTRY_DATE, TO_CHAR (HPM.EFFECTIVE_DATE, 'DD/MM/YYYY') \
                        VALIDITY_DATE, NVL (PI.COMPANY_NAME, PI.FIRST_NAME) || \
                        ' ' || PI.JOINT_NAME  CUSTOMER_NAME, (CASE WHEN \
                        HPM.APPLICATION_ID='1' THEN HPM.LOGIN_ID ELSE \
                        HPM.APPLICATION_ID END) LOGIN_ID, (SELECT COMPANY_NAME \
                        FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE = \
                        HPM.BROKER_CODE) BROKER_COMPANY_NAME, (SELECT DISTINCT \
                        CUSTOMER_NAME FROM PREMIA_CUSTOMER_DETAILS WHERE \
                        CUSTOMER_CODE = NVL (HPM.BDM_CODE, 0)) \
                        PREMIA_CUSTOMER_NAME, TO_CHAR (HPM.INCEPTION_DATE, \
                        'DD/MM/YYYY') POLICY_START_DATE, NVL \
                        (HPM.OVERALL_PREMIUM, 0) PREMIUM, TO_CHAR \
                        (HPM.EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE, \
                        HPM.POLICY_NO, HPM.STATUS ORG_STATUS, (CASE WHEN \
                        HPM.STATUS='P' AND HPM.INTEGRATION_STATUS ='S' THEN \
                        'P' WHEN HPM.STATUS='P' AND HPM.INTEGRATION_STATUS \
                        ='F' THEN 'PD' WHEN HPM.STATUS='D' AND \
                        HPM.INTEGRATION_STATUS ='F' THEN 'D' WHEN \
                        HPM.STATUS='Y' AND HPM.CUST_APPROVE_STATUS='Y'  AND \
                        (HPM.REMARKS IS NULL OR HPM.REMARKS!='Referal') THEN \
                        'CAQ' WHEN HPM.STATUS='Y' AND \
                        HPM.CUST_APPROVE_STATUS='N'  AND (HPM.REMARKS IS NULL \
                        OR HPM.REMARKS!='Referal') THEN 'CRQ' WHEN \
                        HPM.STATUS='Y' AND HPM.CUST_APPROVE_STATUS='P'  AND \
                        (HPM.REMARKS IS NULL OR HPM.REMARKS!='Referal') THEN \
                        'CPQ' WHEN HPM.STATUS='Y' AND \
                        HPM.CUST_APPROVE_STATUS='R'  AND (HPM.REMARKS IS NULL \
                        OR HPM.REMARKS!='Referal') THEN 'CREQ' WHEN \
                        HPM.STATUS='Y' AND ERD.STATUS='R' AND HPM.REMARKS = \
                        'Referal' THEN 'UQ' WHEN HPM.STATUS='Y' AND \
                        HPM.REMARKS IN('Admin') THEN 'AQ' WHEN HPM.STATUS='R' \
                        AND (ERD.STATUS='R' OR ERD.STATUS='D') AND HPM.REMARKS \
                        = 'Referal' AND HPM.ADMIN_REMARKS IS NOT NULL AND \
                        HPM.ADMIN_REFERRAL_STATUS IS NOT NULL THEN 'RRQ' WHEN \
                        HPM.INTEGRATION_STATUS IS NULL AND HPM.STATUS = 'Y' \
                        AND TRUNC(HPM.ENTRY_DATE) > TRUNC(SYSDATE) - 30 AND \
                        HPM.CUST_APPROVE_STATUS IS NULL THEN 'EQ' WHEN \
                        (HPM.STATUS = 'R' OR HPM.STATUS = 'D') AND \
                        (ERD.STATUS='R' OR ERD.STATUS='D') AND HPM.REMARKS NOT \
                        IN ('Referal') THEN 'RQ' WHEN HPM.INTEGRATION_STATUS \
                        IS NULL AND HPM.STATUS = 'Y' AND TRUNC(HPM.ENTRY_DATE) \
                        < TRUNC(SYSDATE) - 30 AND HPM.CUST_APPROVE_STATUS IS \
                        NULL THEN 'EXQ' END) STATUS_TYPE, (CASE WHEN \
                        HPM.STATUS='P' AND HPM.INTEGRATION_STATUS ='S' THEN \
                        'Policies' WHEN HPM.STATUS='P' AND \
                        HPM.INTEGRATION_STATUS ='F' THEN 'Pending Policy' WHEN \
                        HPM.STATUS='D' AND HPM.INTEGRATION_STATUS ='F' THEN \
                        'Cancel Policy' WHEN HPM.STATUS='Y' AND \
                        HPM.CUST_APPROVE_STATUS='Y'  AND (HPM.REMARKS IS NULL \
                        OR HPM.REMARKS!='Referal') THEN 'Customer Approved \
                        Quote' WHEN HPM.STATUS='Y' AND \
                        HPM.CUST_APPROVE_STATUS='N'  AND (HPM.REMARKS IS NULL \
                        OR HPM.REMARKS!='Referal') THEN 'Customer Rejected \
                        Quote' WHEN HPM.STATUS='Y' AND \
                        HPM.CUST_APPROVE_STATUS='P'  AND (HPM.REMARKS IS NULL \
                        OR HPM.REMARKS!='Referal') THEN 'Customer Pending \
                        Quote' WHEN HPM.STATUS='Y' AND \
                        HPM.CUST_APPROVE_STATUS='R'  AND (HPM.REMARKS IS NULL \
                        OR HPM.REMARKS!='Referal') THEN 'Customer Rejected for \
                        ReQuote' WHEN HPM.STATUS='Y' AND ERD.STATUS='R' AND \
                        HPM.REMARKS = 'Referal' THEN 'Referral Pending Quote' \
                        WHEN HPM.STATUS='Y' AND HPM.REMARKS IN ('Admin') THEN \
                        'Referral Approved Quote' WHEN HPM.STATUS='R' AND \
                        (ERD.STATUS='R' OR ERD.STATUS='D') AND HPM.REMARKS = \
                        'Referal' AND HPM.ADMIN_REMARKS IS NOT NULL AND \
                        HPM.ADMIN_REFERRAL_STATUS IS NOT NULL THEN 'Referral \
                        Rejected Quote' WHEN HPM.INTEGRATION_STATUS IS NULL \
                        AND HPM.STATUS = 'Y' AND TRUNC(HPM.ENTRY_DATE) > \
                        TRUNC(SYSDATE) - 30 AND HPM.CUST_APPROVE_STATUS IS \
                        NULL THEN 'Existing Quote' WHEN (HPM.STATUS = 'R' OR \
                        HPM.STATUS = 'D') AND (ERD.STATUS='R' OR \
                        ERD.STATUS='D') AND HPM.REMARKS NOT IN ('Referal') \
                        THEN 'Rejected Quote' WHEN HPM.INTEGRATION_STATUS IS \
                        NULL AND HPM.STATUS = 'Y' AND TRUNC(HPM.ENTRY_DATE) < \
                        TRUNC(SYSDATE) - 30 AND HPM.CUST_APPROVE_STATUS IS \
                        NULL THEN 'Lapsed Quote' END) STATUS_TYPE_NAME,?1 \
                        DOC_NO,(SELECT BRANCH_NAME FROM BRANCH_MASTER WHERE \
                        BRANCH_CODE=HPM.BRANCH_CODE) BRANCH_NAME FROM \
                        HOME_POSITION_MASTER HPM, PERSONAL_INFO \
                        PI,ESERVICE_REQUEST_DETAIL ERD  WHERE HPM.CUSTOMER_ID \
                        = PI.CUSTOMER_ID AND HPM.PRODUCT_ID = ?2  AND \
                        ERD.QUOTE_NO=HPM.QUOTE_NO AND \
                        ERD.APPLICATION_NO=HPM.APPLICATION_NO AND \
                        ERD.CUSTOMER_ID=HPM.CUSTOMER_ID AND \
                        ERD.CUSTOMER_ID=PI.CUSTOMER_ID AND (HPM.APPLICATION_ID \
                        =?3 OR ?3 IS NULL) AND PI.AMEND_ID = (SELECT MAX \
                        (AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = \
                        PI.CUSTOMER_ID) AND PI.STATUS = 'Y'  

TRAVEL_ACTIVE_POLICY = SELECT HPM.POLICY_NO, HPM.CUSTOMER_ID, \
                       HPM.OVERALL_PREMIUM, TO_CHAR(HPM.ENTRY_DATE, \
                       'DD/MM/YYYY') QUOTATION_DATE, NVL (PI.COMPANY_NAME, \
                       PI.FIRST_NAME) CUSTOMER_NAME, PI.LAST_NAME, \
                       HPM.LOGIN_ID, HPM.QUOTE_NO, HPM.EXCESS_PREMIUM, \
                       PI.COMPANY_NAME, TO_CHAR (HPM.INCEPTION_DATE, \
                       'DD/MM/YYYY') INCEPTION_DATE, NULL OPEN_COVER_NO, \
                       HPM.AMEND_ID, HPM.RECEIPT_NO, BCM.COMPANY_NAME \
                       BROKER_NAME, (SELECT TRAVEL_COVER_ID FROM \
                       TRAVEL_RAW_DETAIL WHERE QUOTE_NO = HPM.QUOTE_NO) \
                       TRAVEL_COVER_ID,(SELECT PLAN_TYPE_ID FROM \
                       TRAVEL_RAW_DETAIL WHERE QUOTE_NO = HPM.QUOTE_NO) \
                       POLICY_TYPE,PI.MODE_OF_PAYMENT,HPM.AAA_CARDNO,HPM.RS\
                       A_CARDNO FROM HOME_POSITION_MASTER HPM, PERSONAL_INFO \
                       PI, BROKER_COMPANY_MASTER BCM WHERE (CASE WHEN \
                       HPM.BDM_CODE IS NULL THEN HPM.LOGIN_ID ELSE \
                       HPM.BDM_CODE END) = ?1 AND HPM.STATUS = 'P' AND \
                       HPM.AMEND_ID = '0' AND PI.CUSTOMER_ID = HPM.CUSTOMER_ID \
                       AND HPM.PRODUCT_ID = ?2 AND PI.STATUS = 'Y' AND \
                       PI.AMEND_ID = (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO \
                       WHERE CUSTOMER_ID = PI.CUSTOMER_ID) AND HPM.BROKER_CODE \
                       = BCM.AGENCY_CODE ORDER BY HPM.ENTRY_DATE DESC

TRAVEL_DROPDOWN_BROKER = SELECT * FROM (SELECT DISTINCT PM.LOGIN_ID CODE, \
                         PM.LOGIN_ID FIRST_NAME, BCM.COMPANY_NAME CODEDESC, \
                         LM.OA_CODE FROM TRAVEL_RAW_DETAIL PM, LOGIN_MASTER \
                         LM, BROKER_COMPANY_MASTER BCM WHERE LM.LOGIN_ID = \
                         PM.LOGIN_ID AND LM.AGENCY_CODE = BCM.AGENCY_CODE AND \
                         PM.STATUS IN ('P', 'Y') AND BCM.BRANCH_CODE = ?1 AND \
                         PM.BROKER_CODE = BCM.AGENCY_CODE AND PM.BDM_CODE IS \
                         NULL and lm.status='Y' and BCM.status='Y' AND \
                         LM.OA_CODE NOT IN (SELECT BROKER_CODE FROM \
                         LOGIN_RSAUSER_DETAILS WHERE LOGIN_ID = ?2 AND \
                         PRODUCT_ID = ?3) UNION ALL SELECT DISTINCT \
                         LM.LOGIN_ID CODE, USERNAME, USERNAME CODEDESC, \
                         LM.OA_CODE FROM login_master lm, TRAVEL_RAW_DETAIL PM \
                         WHERE lm.usertype = 'User' AND lm.BRANCH_CODE = ?1 \
                         AND lm.OA_CODE != '90016' AND PM.STATUS IN ('P', 'Y') \
                         AND PM.login_id = lm.login_id AND PM.broker_code = \
                         lm.agency_code AND PM.BDM_CODE IS NULL and \
                         lm.status='Y' AND lm.AGENCY_CODE IN (SELECT DISTINCT \
                         AGENCY_CODE FROM LOGIN_USER_DETAILS LR WHERE \
                         PRODUCT_ID = ?3 AND STATUS = 'Y' AND LR.LOGIN_ID = \
                         lm.LOGIN_ID) UNION ALL SELECT DISTINCT \
                         pcd.CUSTOMER_CODE CODE, pcd.CUSTOMER_NAME, \
                         pcd.CUSTOMER_NAME CODEDESC, pcd.CUSTOMER_CODE FROM \
                         PREMIA_CUSTOMER_DETAILS pcd, TRAVEL_RAW_DETAIL PM \
                         WHERE CUSTOMER_TYPE = '009' AND CUSTOMER_CATEGORY = \
                         (SELECT CORE_APP_CODE FROM branch_master WHERE   \
                         status = 'Y' AND branch_code =?1) AND (SELECT \
                         CORE_APP_CODE FROM branch_master WHERE status = 'Y' \
                         AND branch_code = ?1) BETWEEN DIVISION_FROM AND \
                         DIVISION_TO AND PM.BDM_CODE IS NOT NULL AND \
                         PM.BDM_CODE = pcd.CUSTOMER_CODE AND PM.STATUS IN \
                         ('P', 'Y') AND pcd.status = 'Y') ORDER BY CODEDESC

TRAVEL_EXISTING_DATA = SELECT REFERENCE_NO,QUOTE_NO,CUSTOMER_ID,PASSENGER_NAME \
                       CUSTOMER_NAME,TO_CHAR(ENTRY_DATE,'DD/MM/YYYY') \
                       QUOTATION_DATE,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY') \
                       VALIDITY_DATE ,NVL(TOTAL_PREMIUM,0) PREMIUM FROM \
                       TRAVEL_RAW_DETAIL WHERE (CASE WHEN BDM_CODE IS NULL \
                       THEN LOGIN_ID ELSE BDM_CODE END)=?1 AND STATUS='Y' AND  \
                       APPLICATION_ID=NVL(?2,'1') AND INTEGRATION_STATUS IS \
                       NULL AND CUST_APPROVE_STATUS IS NULL AND REMARKS IS NULL

TRAVEL_EXPIRE_DATA = SELECT A.QUOTE_NO, A.STATUS,A.LAPSED_REMARKS, \
                     TO_CHAR(A.LAPSED_DATE, 'DD/MM/YYYY') LAPSED_DATE, \
                     A.CUSTOMER_ID,TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') \
                     QUOTATION_DATE,TO_CHAR (A.EFFECTIVE_DATE, 'DD/MM/YYYY') \
                     VALIDITY_DATE,NVL (PI.COMPANY_NAME, PI.FIRST_NAME) \
                     CUSTOMER_NAME FROM TRAVEL_RAW_DETAIL A, PERSONAL_INFO PI \
                     WHERE (CASE WHEN A.BDM_CODE IS NULL THEN A.LOGIN_ID ELSE \
                     A.BDM_CODE END) =?1 AND TRUNC (A.EFFECTIVE_DATE) < TRUNC \
                     (SYSDATE) AND A.APPLICATION_ID IN (?2) AND A.STATUS = 'Y' \
                     AND PI.CUSTOMER_ID = A.CUSTOMER_ID AND A.QUOTE_NO IS NOT \
                     NULL AND PI.AMEND_ID = ( SELECT MAX (AMEND_ID) FROM \
                     PERSONAL_INFO WHERE CUSTOMER_ID = PI.CUSTOMER_ID) AND \
                     PI.STATUS = 'Y' AND INTEGRATION_STATUS IS NULL ORDER BY \
                     QUOTE_NO DESC

TRAVEL_PENDING_POLICY = SELECT A.QUOTE_NO, A.LAPSED_REMARKS, \
                        TO_DATE(A.LAPSED_DATE, 'DD/MM/YYYY') LAPSED_DATE, \
                        A.CUSTOMER_ID, TO_CHAR(A.ENTRY_DATE, 'DD/MM/YYYY') AS \
                        QUOTATION_DATE, B.FIRST_NAME CUSTOMER_NAME, \
                        A.LOGIN_ID, A.APPLICATION_NO , B.COMPANY_NAME, \
                        ERD.REFERENCE_NO REQUESTREFERENCENO, A.PREMIUM, \
                        TO_CHAR (A.INCEPTION_DATE, 'DD/MM/YYYY') \
                        INCEPTION_DATE, A.EXPIRY_DATE, B.EMAIL,'' \
                        ISCOMMERCIAL_YN FROM HOME_POSITION_MASTER A, \
                        PERSONAL_INFO B, TRAVEL_RAW_DETAIL ERD WHERE (CASE \
                        WHEN A.BDM_CODE IS NULL THEN A.LOGIN_ID ELSE \
                        A.BDM_CODE END) = ?1 AND A.INTEGRATION_STATUS = 'F' \
                        AND B.CUSTOMER_ID = A.CUSTOMER_ID AND A.PRODUCT_ID =?2 \
                        AND A.APPLICATION_ID IN (CASE WHEN A.APPLICATION_ID = \
                        '1' THEN A.LOGIN_ID ELSE A.APPLICATION_ID END) AND \
                        ERD.QUOTE_NO = A.QUOTE_NO AND B.AMEND_ID = ( SELECT \
                        MAX (AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = \
                        B.CUSTOMER_ID) AND B.STATUS = 'Y' ORDER BY QUOTE_NO \
                        DESC

TRAVEL_PENDING_REFERAL = SELECT HPM.POLICY_NO, HPM.CUSTOMER_ID, \
                         HPM.OVERALL_PREMIUM, TO_CHAR(HPM. ENTRY_DATE, \
                         'DD/MM/YYYY') QUOTATION_DATE, NVL (PI.COMPANY_NAME, \
                         PI. FIRST_NAME) CUSTOMER_NAME, PI.LAST_NAME, \
                         HPM.LOGIN_ID, HPM.QUOTE_NO, HPM .EXCESS_PREMIUM, \
                         PI.COMPANY_NAME, TO_CHAR (HPM.INCEPTION_DATE, \
                         'DD/MM/YYYY') INCEPTION_DATE, NULL OPEN_COVER_NO, \
                         HPM.AMEND_ID, HPM. RECEIPT_NO, BCM.COMPANY_NAME \
                         BROKER_NAME,HPM.APPLICATION_NO,HPM. \
                         DEBIT_NOTE_NO,HPM.CREDIT_NO \
                         CREDIT_NOTE_NO,ERD.REFERENCE_NO \
                         REQUESTREFERENCENO,PI.EMAIL,HPM.PREMIUM,HPM.EXPIRY_DAT\
                         E,HPM.REMARKS,HPM. \
                         REFERRAL_DESCRIPTION,HPM.ADMIN_REMARKS,'' \
                         ISCOMMERCIAL_YN FROM HOME_POSITION_MASTER HPM, \
                         PERSONAL_INFO PI, BROKER_COMPANY_MASTER \
                         BCM,TRAVEL_RAW_DETAIL ERD WHERE (CASE WHEN \
                         HPM.BDM_CODE IS NULL THEN HPM.LOGIN_ID ELSE \
                         HPM.BDM_CODE END) = ?1 AND HPM.STATUS = 'Y' AND \
                         HPM.AMEND_ID = '0' AND PI.CUSTOMER_ID = \
                         HPM.CUSTOMER_ID AND HPM.PRODUCT_ID =?2 AND PI.STATUS \
                         = 'Y' AND PI.AMEND_ID = ( SELECT MAX (AMEND_ID) FROM \
                         PERSONAL_INFO WHERE CUSTOMER_ID = PI.CUSTOMER_ID) AND \
                         HPM.BROKER_CODE = BCM.AGENCY_CODE AND HPM.REMARKS = \
                         'REFERAL' AND ERD.QUOTE_NO =HPM. QUOTE_NO

TRAVEL_REJECTED_DATA = SELECT \
                       A.QUOTE_NO,A.LAPSED_REMARKS,TO_CHAR(A.LAPSED_DATE,'DD/MM\
                       /YYYY') LAPSED_DATE, A.CUSTOMER_ID, \
                       TO_CHAR(A.ENTRY_DATE,'DD/MM/YYYY') QUOTATION_DATE, \
                       TO_CHAR(A.EFFECTIVE_DATE,'DD/MM/YYYY') VALIDITY_PERIOD, \
                       B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, A.STATUS, \
                       B.COMPANY_NAME, 'REJECTED' REJECT_DESC FROM \
                       TRAVEL_RAW_DETAIL A, PERSONAL_INFO B WHERE(CASE WHEN \
                       A.BDM_CODE IS NULL THEN A.LOGIN_ID ELSE A.BDM_CODE END) \
                       =?1 AND (A.STATUS IN ('D')) AND B.CUSTOMER_ID = \
                       A.CUSTOMER_ID AND A.APPLICATION_ID IN (?2) AND \
                       B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO \
                       WHERE CUSTOMER_ID=B.CUSTOMER_ID) AND B.STATUS='Y' AND \
                       INTEGRATION_STATUS IS NULL ORDER BY QUOTE_NO DESC

VEHICLE_CATEGORY_SEARCH = AND ERD.VEH_BODY_ID = ?4 ORDER BY ERD.QUOTE_NO

VEH_TYPE_SEARCH = AND  ERD.VEH_TYPE_ID =?4 ORDER BY ERD.QUOTE_NO

YACHT_BROKER = SELECT * FROM (SELECT LOGIN_ID CODE ,USERNAME CODEDESC FROM \
               LOGIN_MASTER WHERE  OA_CODE = (SELECT OA_CODE  FROM \
               LOGIN_MASTER WHERE LOGIN_ID =? AND USERTYPE != 'Customer' AND \
               USERTYPE != 'Freight') AND USERTYPE != 'Freight' AND STATUS='Y' \
               AND LOGIN_ID IN ( SELECT DISTINCT (A.LOGIN_ID)  FROM \
               HOME_POSITION_MASTER A, PERSONAL_INFO B  WHERE  A.CUSTOMER_ID = \
               B.CUSTOMER_ID  AND B.STATUS = 'Y' AND A.PRODUCT_ID=?) ) order \
               by CODEDESC

YACHT_ISSUER_BROKER = SELECT * FROM (SELECT DISTINCT PM.LOGIN_ID CODE, \
                      PM.LOGIN_ID FIRST_NAME, BCM.COMPANY_NAME CODEDESC, \
                      LM.OA_CODE FROM HOME_POSITION_MASTER PM, LOGIN_MASTER \
                      LM, BROKER_COMPANY_MASTER BCM WHERE PM.PRODUCT_ID = ?3 \
                      AND LM.LOGIN_ID = PM.LOGIN_ID AND LM.AGENCY_CODE = \
                      BCM.AGENCY_CODE AND PM.STATUS IN ('P', 'Y','R') AND \
                      BCM.BRANCH_CODE = ?1 AND PM.BROKER_CODE = \
                      BCM.AGENCY_CODE AND PM.BDM_CODE IS NULL AND lm.status = \
                      'Y' AND BCM.status = 'Y' AND LM.OA_CODE NOT IN (SELECT \
                      BROKER_CODE FROM LOGIN_RSAUSER_DETAILS WHERE LOGIN_ID = \
                      ?2 AND PRODUCT_ID = ?3) UNION ALL SELECT DISTINCT \
                      LM.LOGIN_ID CODE, USERNAME, USERNAME CODEDESC, \
                      LM.OA_CODE FROM login_master lm, HOME_POSITION_MASTER PM \
                      WHERE PM.PRODUCT_ID = ?3 AND lm.usertype = 'User' AND \
                      lm.BRANCH_CODE = ?1 AND lm.OA_CODE != '90016' AND \
                      PM.STATUS IN ('P', 'Y','R') AND PM.login_id = \
                      lm.login_id AND PM.broker_code = lm.agency_code AND \
                      PM.BDM_CODE IS NULL AND lm.AGENCY_CODE IN (SELECT \
                      DISTINCT AGENCY_CODE FROM LOGIN_USER_DETAILS LR WHERE \
                      PRODUCT_ID = ?3 AND STATUS = 'Y' AND LR.LOGIN_ID = \
                      lm.LOGIN_ID) AND lm.status = 'Y' UNION ALL SELECT \
                      DISTINCT pcd.CUSTOMER_CODE CODE, pcd.CUSTOMER_NAME, \
                      pcd.CUSTOMER_NAME CODEDESC, pcd.CUSTOMER_CODE FROM \
                      PREMIA_CUSTOMER_DETAILS pcd, HOME_POSITION_MASTER PM \
                      WHERE PM.PRODUCT_ID = ?3 AND CUSTOMER_TYPE = '009' AND \
                      CUSTOMER_CATEGORY =(SELECT CORE_APP_CODE FROM \
                      BRANCH_MASTER WHERE STATUS='Y' AND BRANCH_CODE=?1) AND  \
                      DIVISION_FROM=(SELECT CORE_APP_CODE FROM branch_master \
                      WHERE status = 'Y' AND branch_code = ?1)  AND \
                      DIVISION_TO=(SELECT CORE_APP_CODE FROM branch_master \
                      WHERE status = 'Y' AND branch_code = ?1) AND PM.BDM_CODE \
                      IS NOT NULL AND PM.BDM_CODE = pcd.CUSTOMER_CODE AND \
                      PM.STATUS IN ('P', 'Y','R') AND pcd.status = 'Y') ORDER \
                      BY CODEDESC
GET_FLEET_HOD_PENDING_QUOTES = SELECT DISTINCT DECODE (ER.APPLICATION_ID, '1', ER.LOGIN_ID, ER.APPLICATION_ID) \
            				   QUOTE_CREATED, ER.APPLICATION_NO, ER.LOGIN_ID, ER.QUOTE_NO,  ER.HODREFERRALREMARKS, \
         					   ER.APPLICATION_ID,ER.CUSTOMER_ID,ER.COMPANY_NAME CUST_NAME,ER.COMPANY_NAME BROKERNAME,\
         					   ER.REQUESTREFERENCENO REQUESTREFERENCENO,TO_CHAR (ER.ENTRY_DATE, 'DD/MM/YYYY') ENTRY_DATE,\
							   (SELECT COUNT (*) FROM FLEET_POLICYTYPE_MASTER MPM WHERE MPM.INT_SEC_CODE = '1007WB' \
                   			   AND MPM.STATUS = 'Y' AND ER.POLICYTYPE = MPM.POLICYTYPE_ID) ISTPL, ER.COMPANY_ID POLICYHOLDERID, \
         					   (SELECT   POLICYTYPE_DESC_ENGLISH FROM   FLEET_POLICYTYPE_MASTER MPM WHERE MPM.STATUS = 'Y' \
         					   AND ER.POLICYTYPE = MPM.POLICYTYPE_ID) POLICYTYPEDESC,TO_CHAR(ER.HOD_REQ_DATE,'DD/MM/YYYY') HOD_REQ_DATE, \
         					   TO_CHAR(ER.HOD_APPROVE_DATE,'DD/MM/YYYY') HOD_APPROVE_DATE,ER.HOD_APPROVE_BY, TO_NUMBER(TRUNC (SYSDATE) - TRUNC (NVL(ER.HOD_REQ_DATE,SYSDATE))) NOOFDAYINHODPENDING \
         					   ,TO_NUMBER(TRUNC (SYSDATE) - TRUNC (NVL(ER.HOD_APPROVE_DATE,SYSDATE))) NOOFDAYINHODAPPROVED,ER.RENEWALYN,ER.RENEWALPOLICYNO FROM FLEET_REQUEST_DETAIL ER, LOGIN_MASTER LM, \
         					   BROKER_COMPANY_MASTER D WHERE ER.LOGIN_ID = LM.LOGIN_ID (+) AND D.AGENCY_CODE = LM.OA_CODE AND \
         					   ER.STATUS IN ('Y', 'E') AND ER.PRODUCT_ID = ?1 AND ER.HODREFERRALYN='Y' AND TRUNC(ER.ENTRY_DATE) > TRUNC(SYSDATE) - 30  \
         					   AND (ER.HODAPPROVESTATUS IS NULL OR ER.HODAPPROVESTATUS=?2) AND ER.BRANCH_CODE IN (?3)
GET_FLEET_HODAPPORREJECT_QUOTES = SELECT DISTINCT DECODE (ER.APPLICATION_ID, '1', ER.LOGIN_ID, ER.APPLICATION_ID) \
            				   QUOTE_CREATED, ER.APPLICATION_NO, ER.LOGIN_ID, ER.QUOTE_NO,  ER.HODREFERRALREMARKS, \
         					   ER.APPLICATION_ID,ER.CUSTOMER_ID,ER.COMPANY_NAME CUST_NAME,ER.COMPANY_NAME BROKERNAME,\
         					   ER.REQUESTREFERENCENO REQUESTREFERENCENO,TO_CHAR (ER.ENTRY_DATE, 'DD/MM/YYYY') ENTRY_DATE,\
							   (SELECT COUNT (*) FROM FLEET_POLICYTYPE_MASTER MPM WHERE MPM.INT_SEC_CODE = '1007WB' \
                   			   AND MPM.STATUS = 'Y' AND ER.POLICYTYPE = MPM.POLICYTYPE_ID) ISTPL, ER.COMPANY_ID POLICYHOLDERID, \
         					   (SELECT   POLICYTYPE_DESC_ENGLISH FROM   FLEET_POLICYTYPE_MASTER MPM WHERE MPM.STATUS = 'Y' \
         					   AND ER.POLICYTYPE = MPM.POLICYTYPE_ID) POLICYTYPEDESC,TO_CHAR(ER.HOD_REQ_DATE,'DD/MM/YYYY') HOD_REQ_DATE,\
         					   TO_CHAR(ER.HOD_APPROVE_DATE,'DD/MM/YYYY') HOD_APPROVE_DATE, TO_NUMBER(TRUNC (NVL(ER.HOD_APPROVE_DATE,SYSDATE)) - TRUNC (NVl(ER.HOD_REQ_DATE,SYSDATE))) NOOFDAYINHODPENDING \
         					   ,ER.HOD_APPROVE_BY,TO_NUMBER(TRUNC (SYSDATE) - TRUNC (NVl(ER.HOD_APPROVE_DATE,SYSDATE))) NOOFDAYINHODAPPROVED,ER.RENEWALYN,ER.RENEWALPOLICYNO FROM FLEET_REQUEST_DETAIL ER, LOGIN_MASTER LM, \
         					   BROKER_COMPANY_MASTER D WHERE ER.LOGIN_ID = LM.LOGIN_ID (+) AND D.AGENCY_CODE = LM.OA_CODE AND \
         					   ER.STATUS IN ('Y', 'E') AND ER.PRODUCT_ID = ?1 AND ER.HODREFERRALYN='Y' \
         					    AND ER.HODAPPROVESTATUS=?2 AND ER.BRANCH_CODE IN (?3) AND TRUNC(ER.ENTRY_DATE) > TRUNC(SYSDATE) - 30
GET_FLEET_HOD_QUOTE_DURATION =  AND TRUNC(ER.HOD_REQ_DATE) BETWEEN TO_DATE(?4,'DD/MM/YYYY') AND TO_DATE(?5,'DD/MM/YYYY')
GET_FLEET_HOD_QUOTE_DURATION30 =  AND TRUNC(ER.HOD_REQ_DATE) > TRUNC(SYSDATE) - 30    
#GET_FLEET_HOD_QUOTE_DURATION =  AND TRUNC(ER.ENTRY_DATE) BETWEEN TO_DATE(?4,'DD/MM/YYYY') AND TO_DATE(?5,'DD/MM/YYYY')
#GET_FLEET_HOD_QUOTE_DURATION30 =  AND TRUNC(ER.ENTRY_DATE) > TRUNC(SYSDATE) - 30          					             					    

MOTOR_INTEG_POLICY_DTLS = SELECT YPD.PRODUCT,YPD.REQUESTREFERENCENO QUOTE_NO, YPD.QUOTATION_POLICY_NO POLICY_NO,(CASE WHEN YPD.CURRENT_STATUS='SUCCESS' THEN 'Approved' ELSE 'Not Approved' END) POLICY_STATUS, YPD.CURRENT_STATUS POLICY_STAGE, TO_CHAR(YPD.REQUEST_TIME,'DD/MM/YYYY') POL_CREATED_DATE, BM.CORE_APP_CODE DIVISION,HPM.OVERALL_PREMIUM FROM HOME_POSITION_MASTER HPM, YI_POLICY_DETAIL YPD,BRANCH_MASTER BM WHERE TO_CHAR(HPM.QUOTE_NO) = YPD.REQUESTREFERENCENO AND HPM.BRANCH_CODE = BM.BRANCH_CODE AND (YPD.PRODUCT=?1 OR ?1 IS NULL) AND TRUNC(YPD.REQUEST_TIME) BETWEEN TO_DATE(?2, 'DD/MM/YYYY') AND TO_DATE(?3, 'DD/MM/YYYY')
MOTOR_INETG_USER_ID = SELECT HPM.APPLICATION_ID,(CASE WHEN HPM.APPLICATION_ID ='1' THEN LM.LOGIN_ID ELSE (SELECT CORE_LOGIN_ID FROM LOGIN_MASTER WHERE LOGIN_ID=HPM.APPLICATION_ID) END) REQUEST_USER_ID FROM LOGIN_MASTER LM , BROKER_COMPANY_MASTER BCM, HOME_POSITION_MASTER HPM,PERSONAL_INFO PI WHERE LM.LOGIN_ID=HPM.LOGIN_ID AND LM.OA_CODE= BCM.AGENCY_CODE AND PI.CUSTOMER_ID=HPM.CUSTOMER_ID AND HPM.QUOTE_NO=?1
MOTOR_WHATSAPP_STATUS = SELECT WHATSAPPMESSAGE,FILE_MSG FROM INTEG_WHATSAPP_DATA WHERE QUOTE_NO=?1 AND TYPE_ID='POLICY_CONFIRM_MOTOR'
MOTOR_COVER_PREMIUM = SELECT YCD.COVER_CODE,YCD.PREMIUM FROM YI_COVER_DETAIL YCD WHERE P_WS_RESPONSE_TYPE='S' AND YCD.REQUESTREFERENCENO=?1 AND YCD.PREMIUM!=0
MOTOR_COVER_TYPE = SELECT MGM.COVER_TYPE FROM MOTOR_GROUP_MASTER MGM WHERE MGM.CORE_APPCODE=?1 OR MGM.OTHR_APPCODE_TPL=?1
MOTOR_CHARGE_DETAIL = SELECT CHARGE_CODE,CHARGE_RATE,CHARGE_AMOUNT FROM YI_CHARGE_DETAIL WHERE REQUESTREFERENCENO=?1
MOTOR_VAT_DETAIL = SELECT NVL(VAT_AMOUNT,0) VAT_AMOUNT FROM YI_VAT_DETAIL WHERE REQUESTREFERENCENO=?1
PORTFOLIO_ADMIN_BRANCH_ALL=select ATTACHED_BRANCH BRANCH_CODE from login_master where login_id=?1


ADMIN_PORTFOLIO_ACTIVEPOLICY_PRODUCTION = SELECT  ROWNUM \
                               SNO,TO_CHAR(PM.EFFECTIVE_DATE,'DD/MM/YYYY') \
                               EFFECTIVE_DATE,PI.CUST_NAME,PI.LAST_NAME,(CASE \
                               WHEN MDD.ISCOMMERCIAL_YN ='N' THEN 'PRIVATE' \
                               ELSE 'COMMERCIAL'END) ISCOMMERCIAL_YN,(SELECT \
                               BRANCH_NAME FROM BRANCH_MASTER WHERE \
                               BRANCH_CODE=PM.BRANCH_CODE) \
                               BRANCH_NAME,PM.APPLICATION_ID,PM.LOGIN_ID,PM.APP\
                               LICATION_NO,BCM.COMPANY_NAME \
                               BROKER_ORGANIZATION,PM.REMARKS,PI.FIRST_NAME,PM.\
                               OVERALL_PREMIUM + NVL (PM.EXCESS_PREMIUM, '0') \
                               PREMIUM,NVL (PM.EXCESS_PREMIUM, '0') \
                               EXCESS_PREMIUM,PI.COMPANY_NAME,PM.POLICY_NO,TO_C\
                               HAR (PM.ENTRY_DATE, \
                               'DD/MM/YYYY')ENTRY_DATE,PM.PRODUCT_ID,PM.CREDIT_\
                               NO,PM.DEBIT_NOTE_NO,PM.RECEIPT_NO, (SELECT \
                               PRODUCT_NAME FROM PRODUCT_MASTER PMM WHERE \
                               PMM.PRODUCT_ID=PM.PRODUCT_ID) \
                               PRODUCT_NAME,MDD.POLICYTYPE,PM.QUOTE_NO,(CASE \
                               WHEN PM.STATUS='P' AND PM.INTEGRATION_STATUS \
                               ='S' THEN 'P' WHEN PM. STATUS='P' AND \
                               PM.INTEGRATION_STATUS ='F' THEN 'PD' WHEN \
                               PM.STATUS='D' AND PM.INTEGRATION_STATUS ='F' \
                               THEN 'D' WHEN PM.STATUS='Y' AND \
                               PM.CUST_APPROVE_STATUS='Y' THEN 'CAQ' WHEN \
                               PM.STATUS='Y' AND PM.CUST_APPROVE_STATUS='N' \
                               THEN 'CRQ' WHEN PM.STATUS='Y' AND \
                               PM.CUST_APPROVE_STATUS='P' THEN 'CPQ' WHEN \
                               PM.STATUS='Y' AND PM.CUST_APPROVE_STATUS='R' \
                               THEN 'CREQ' WHEN PM.STATUS='Y' AND \
                               ERD.STATUS='R' AND PM.REMARKS = 'REFERAL' THEN \
                               'UQ' WHEN PM.STATUS='Y' AND PM.REMARKS \
                               IN('ADMIN') THEN 'AQ' WHEN PM.STATUS='Y' AND \
                               (ERD.STATUS='R' OR ERD.STATUS='D') AND \
                               PM.REMARKS = 'REFERAL' AND PM.ADMIN_REMARKS IS \
                               NOT NULL AND PM.ADMIN_REFERRAL_STATUS IS NOT \
                               NULL THEN 'RRQ' WHEN PM.INTEGRATION_STATUS IS \
                               NULL AND PM.STATUS = 'Y' AND \
                               TRUNC(PM.ENTRY_DATE) > TRUNC(SYSDATE) - 30 AND \
                               PM.CUST_APPROVE_STATUS IS NULL THEN 'EQ' WHEN \
                               (PM.STATUS = 'R' OR PM.STATUS = 'D') AND \
                               (ERD.STATUS='R' OR ERD.STATUS='D') AND \
                               PM.REMARKS NOT IN ('REFERAL') THEN 'RQ' WHEN \
                               PM.INTEGRATION_STATUS IS NULL AND PM.STATUS = \
                               'Y' AND TRUNC(PM.ENTRY_DATE) < TRUNC(SYSDATE) - \
                               30 AND PM.CUST_APPROVE_STATUS IS NULL THEN \
                               'EXQ' END) STATUS_TYPE, ( CASE WHEN \
                               PM.STATUS='P' AND PM.INTEGRATION_STATUS ='S' \
                               THEN 'POLICIES' WHEN PM.STATUS='P' AND \
                               PM.INTEGRATION_STATUS ='F' THEN 'PENDING \
                               POLICY' WHEN PM.STATUS='D' AND \
                               PM.INTEGRATION_STATUS ='F' THEN 'CANCEL POLICY' \
                               WHEN PM.STATUS='Y' AND \
                               PM.CUST_APPROVE_STATUS='Y' THEN 'CUSTOMER \
                               APPROVED QUOTE' WHEN PM.STATUS='Y' AND \
                               PM.CUST_APPROVE_STATUS='N' THEN 'CUSTOMER \
                               REJECTED QUOTE' WHEN PM.STATUS='Y' AND \
                               PM.CUST_APPROVE_STATUS='P' THEN 'CUSTOMER \
                               PENDING QUOTE' WHEN PM.STATUS='Y' AND \
                               PM.CUST_APPROVE_STATUS='R' THEN 'CUSTOMER \
                               REJECTED FOR REQUOTE' WHEN PM.STATUS='Y' AND \
                               ERD.STATUS='R' AND PM.REMARKS = 'REFERAL' THEN \
                               'REFERRAL PENDING QUOTE' WHEN PM.STATUS='Y' AND \
                               PM.REMARKS IN ('ADMIN') THEN 'REFERRAL APPROVED \
                               QUOTE' WHEN PM.STATUS='Y' AND (ERD.STATUS='R' \
                               OR ERD.STATUS='D') AND PM.REMARKS = 'REFERAL' \
                               AND PM.ADMIN_REMARKS IS NOT NULL AND \
                               PM.ADMIN_REFERRAL_STATUS IS NOT NULL THEN \
                               'REFERRAL REJECTED QUOTE' WHEN \
                               PM.INTEGRATION_STATUS IS NULL AND PM.STATUS = \
                               'Y' AND TRUNC(PM.ENTRY_DATE) > TRUNC(SYSDATE) - \
                               30 AND PM.CUST_APPROVE_STATUS IS NULL THEN \
                               'EXISTING QUOTE' WHEN (PM.STATUS = 'R' OR \
                               PM.STATUS = 'D') AND (ERD.STATUS='R' OR \
                               ERD.STATUS='D') AND PM.REMARKS NOT IN \
                               ('REFERAL') THEN 'REJECTED QUOTE' WHEN \
                               PM.INTEGRATION_STATUS IS NULL AND PM.STATUS = \
                               'Y' AND TRUNC(PM.ENTRY_DATE) < TRUNC(SYSDATE) - \
                               30 AND PM.CUST_APPROVE_STATUS IS NULL THEN \
                               'LAPSED QUOTE' END) \
                               STATUS_TYPE_NAME,ERD.REQUESTREFERENCENO \
                               REQUESTREFERENCENO  FROM  HOME_POSITION_MASTER \
                               PM JOIN MOTOR_DATA_DETAIL MDD ON  \
                               (PM.QUOTE_NO=MDD.QUOTE_NO) JOIN PERSONAL_INFO \
                               PI ON  (MDD.CUSTOMER_ID=PI.CUSTOMER_ID) JOIN \
                               LOGIN_MASTER LM ON (LM.LOGIN_ID=PM.LOGIN_ID) \
                               JOIN BROKER_COMPANY_MASTER BCM  ON \
                               (LM.OA_CODE=BCM.AGENCY_CODE) JOIN \
                               ESERVICE_REQUEST_DETAIL ERD ON (PM.QUOTE_NO = \
                               ERD.QUOTE_NO) WHERE TRUNC(PM.EFFECTIVE_DATE) \
                               BETWEEN TO_DATE (?1, 'DD/MM/YYYY') AND TO_DATE \
                               (?2, 'DD/MM/YYYY') AND  \
                               DECODE(?3,'ALL','A',PM.PRODUCT_ID) IN \
                               DECODE(?3,'ALL','A',?3)   AND  LOWER(PM.STATUS) \
                               IN (?4) AND BCM.BRANCH_CODE IN(SELECT \
                               REGEXP_SUBSTR(?5, '[^,]+', 1, LEVEL) AS DATA \
                               FROM DUAL CONNECT BY REGEXP_SUBSTR(?5, '[^,]+', \
                               1, LEVEL) IS NOT NULL) AND PI.AMEND_ID=(SELECT \
                               MAX(AMEND_ID) FROM PERSONAL_INFO P WHERE \
                               PI.CUSTOMER_ID=P.CUSTOMER_ID)

ADMIN_PORTFOLIO_PENDINGPOLICY_PRODUCTION = SELECT   ROWNUM \
                                SNO,PI.CUST_NAME,PI.LAST_NAME,(CASE WHEN \
                                MDD.ISCOMMERCIAL_YN ='N' THEN 'PRIVATE' ELSE \
                                'COMMERCIAL'END) ISCOMMERCIAL_YN,(SELECT \
                                BRANCH_NAME FROM BRANCH_MASTER WHERE \
                                BRANCH_CODE=PM.BRANCH_CODE) \
                                BRANCH_NAME,PM.APPLICATION_ID,PM.APPLICATION_NO\
                                ,BCM.COMPANY_NAME \
                                BROKER_ORGANIZATION,PM.LOGIN_ID,PM.QUOTE_NO,PM.\
                                REMARKS, PI.FIRST_NAME, CASE  WHEN MDD.STATUS \
                                IN ('C')  THEN  FT.FINAL_PREMIUM  ELSE \
                                (PM.PREMIUM + NVL (PM.EXCESS_PREMIUM, '0'))  \
                                END  PREMIUM,NVL (PM.EXCESS_PREMIUM, '0') \
                                EXCESS_PREMIUM, \
                                PI.COMPANY_NAME,PM.POLICY_NO,TO_CHAR \
                                (PM.ENTRY_DATE,'DD/MM/YYYY')ENTRY_DATE,PM.PRODU\
                                CT_ID,(SELECT PRODUCT_NAME FROM PRODUCT_MASTER \
                                PMM  WHERE PMM.PRODUCT_ID=PM.PRODUCT_ID) \
                                PRODUCT_NAME,NVL(FT.REFERALL_REMARKS,MDD.REFERR\
                                AL_REMARKS) AS REFERAL_REMARKS,(CASE WHEN \
                                PM.STATUS='P' AND PM.INTEGRATION_STATUS ='S' \
                                THEN 'P' WHEN PM. STATUS='P' AND \
                                PM.INTEGRATION_STATUS ='F' THEN 'PD' WHEN \
                                PM.STATUS='D' AND PM.INTEGRATION_STATUS ='F' \
                                THEN 'D' WHEN PM.STATUS='Y' AND \
                                PM.CUST_APPROVE_STATUS='Y' THEN 'CAQ' WHEN \
                                PM.STATUS='Y' AND PM.CUST_APPROVE_STATUS='N' \
                                THEN 'CRQ' WHEN PM.STATUS='Y' AND \
                                PM.CUST_APPROVE_STATUS='P' THEN 'CPQ' WHEN \
                                PM.STATUS='Y' AND PM.CUST_APPROVE_STATUS='R' \
                                THEN 'CREQ' WHEN PM.STATUS='Y' AND \
                                ERD.STATUS='R' AND PM.REMARKS = 'REFERAL' THEN \
                                'UQ' WHEN PM.STATUS='Y' AND PM.REMARKS \
                                IN('ADMIN') THEN 'AQ' WHEN PM.STATUS='Y' AND \
                                (ERD.STATUS='R' OR ERD.STATUS='D') AND \
                                PM.REMARKS = 'REFERAL' AND PM.ADMIN_REMARKS IS \
                                NOT NULL AND PM.ADMIN_REFERRAL_STATUS IS NOT \
                                NULL THEN 'RRQ' WHEN PM.INTEGRATION_STATUS IS \
                                NULL AND PM.STATUS = 'Y' AND \
                                TRUNC(PM.ENTRY_DATE) > TRUNC(SYSDATE) - 30 AND \
                                PM.CUST_APPROVE_STATUS IS NULL THEN 'EQ' WHEN \
                                (PM.STATUS = 'R' OR PM.STATUS = 'D') AND \
                                (ERD.STATUS='R' OR ERD.STATUS='D') AND \
                                PM.REMARKS NOT IN ('REFERAL') THEN 'RQ' WHEN \
                                PM.INTEGRATION_STATUS IS NULL AND PM.STATUS = \
                                'Y' AND TRUNC(PM.ENTRY_DATE) < TRUNC(SYSDATE) \
                                - 30 AND PM.CUST_APPROVE_STATUS IS NULL THEN \
                                'EXQ' END) STATUS_TYPE, ( CASE WHEN \
                                PM.STATUS='P' AND PM.INTEGRATION_STATUS ='S' \
                                THEN 'POLICIES' WHEN PM.STATUS='P' AND \
                                PM.INTEGRATION_STATUS ='F' THEN 'PENDING \
                                POLICY' WHEN PM.STATUS='D' AND \
                                PM.INTEGRATION_STATUS ='F' THEN 'CANCEL \
                                POLICY' WHEN PM.STATUS='Y' AND \
                                PM.CUST_APPROVE_STATUS='Y' THEN 'CUSTOMER \
                                APPROVED QUOTE' WHEN PM.STATUS='Y' AND \
                                PM.CUST_APPROVE_STATUS='N' THEN 'CUSTOMER \
                                REJECTED QUOTE' WHEN PM.STATUS='Y' AND \
                                PM.CUST_APPROVE_STATUS='P' THEN 'CUSTOMER \
                                PENDING QUOTE' WHEN PM.STATUS='Y' AND \
                                PM.CUST_APPROVE_STATUS='R' THEN 'CUSTOMER \
                                REJECTED FOR REQUOTE' WHEN PM.STATUS='Y' AND \
                                ERD.STATUS='R' AND PM.REMARKS = 'REFERAL' THEN \
                                'REFERRAL PENDING QUOTE' WHEN PM.STATUS='Y' \
                                AND PM.REMARKS IN ('ADMIN') THEN 'REFERRAL \
                                APPROVED QUOTE' WHEN PM.STATUS='Y' AND \
                                (ERD.STATUS='R' OR ERD.STATUS='D') AND \
                                PM.REMARKS = 'REFERAL' AND PM.ADMIN_REMARKS IS \
                                NOT NULL AND PM.ADMIN_REFERRAL_STATUS IS NOT \
                                NULL THEN 'REFERRAL REJECTED QUOTE' WHEN \
                                PM.INTEGRATION_STATUS IS NULL AND PM.STATUS = \
                                'Y' AND TRUNC(PM.ENTRY_DATE) > TRUNC(SYSDATE) \
                                - 30 AND PM.CUST_APPROVE_STATUS IS NULL THEN \
                                'EXISTING QUOTE' WHEN (PM.STATUS = 'R' OR \
                                PM.STATUS = 'D') AND (ERD.STATUS='R' OR \
                                ERD.STATUS='D') AND PM.REMARKS NOT IN \
                                ('REFERAL') THEN 'REJECTED QUOTE' WHEN \
                                PM.INTEGRATION_STATUS IS NULL AND PM.STATUS = \
                                'Y' AND TRUNC(PM.ENTRY_DATE) < TRUNC(SYSDATE) \
                                - 30 AND PM.CUST_APPROVE_STATUS IS NULL THEN \
                                'LAPSED QUOTE' END) \
                                STATUS_TYPE_NAME,ERD.REQUESTREFERENCENO \
                                REQUESTREFERENCENO FROM  HOME_POSITION_MASTER \
                                PM JOIN MOTOR_DATA_DETAIL MDD ON  \
                                (PM.QUOTE_NO=MDD.QUOTE_NO) JOIN PERSONAL_INFO \
                                PI ON  (MDD.CUSTOMER_ID=PI.CUSTOMER_ID) JOIN \
                                LOGIN_MASTER LM ON (LM.LOGIN_ID=PM.LOGIN_ID) \
                                JOIN BROKER_COMPANY_MASTER BCM  ON \
                                (LM.OA_CODE=BCM.AGENCY_CODE) LEFT JOIN \
                                FACTOR_RATE_TRAN_DETAILS FT ON \
                                (FT.APPLICATION_NO=PM.APPLICATION_NO AND \
                                NVL(MDD.POLICYTYPE,14)=FT.POLICYTYPE) JOIN \
                                ESERVICE_REQUEST_DETAIL ERD ON (PM.QUOTE_NO = \
                                ERD.QUOTE_NO) WHERE TRUNC(PM.ENTRY_DATE) \
                                BETWEEN TO_DATE (?1, 'DD/MM/YYYY') AND TO_DATE \
                                (?2, 'DD/MM/YYYY') AND  \
                                DECODE(?3,'ALL','A',PM.PRODUCT_ID) IN \
                                DECODE(?3,'ALL','A',?3)   AND  \
                                LOWER(PM.STATUS) IN (?4) AND BCM.BRANCH_CODE \
                                IN(SELECT REGEXP_SUBSTR(?5, '[^,]+', 1, LEVEL) \
                                AS DATA FROM DUAL CONNECT BY REGEXP_SUBSTR(?5, \
                                '[^,]+', 1, LEVEL) IS NOT NULL)  AND \
                                PI.AMEND_ID=(SELECT MAX(AMEND_ID) FROM \
                                PERSONAL_INFO P WHERE \
                                PI.CUSTOMER_ID=P.CUSTOMER_ID)
                                
MOTOR_INTEG_PRODUCTION_REPORT=SELECT QUOTE_NO, POLICY_NO, POLICY_STATUS, POLICY_STAGE, POL_CREATED_DATE, BASEPREMIUM, MINIMUM_PREMIUM_ADJUSTMENT, LOADING, DISCOUNT, NOTPART_OF_BASE_PREMIUM, LESS_NON_BASIC, ADDON_PREMIUM, SUM(CHARGE_AMOUNT) CHARGE_AMOUNT, VAT_AMOUNT, (NVL(BASEPREMIUM,0) + NVL(MINIMUM_PREMIUM_ADJUSTMENT,0) + NVL(LOADING,0) - NVL(DISCOUNT,0) + NVL(NOTPART_OF_BASE_PREMIUM,0) + NVL(ADDON_PREMIUM,0) + NVL(SUM(CHARGE_AMOUNT),0) + NVL(VAT_AMOUNT,0)) DERIVED_PREMIUM, NET_PREMIUM FROM ( SELECT A.REQUESTREFERENCENO QUOTE_NO, A.QUOTATION_POLICY_NO POLICY_NO, (CASE WHEN A.CURRENT_STATUS='SUCCESS' THEN 'Approved' ELSE 'Not Approved' END) POLICY_STATUS, A.CURRENT_STATUS POLICY_STAGE, TO_CHAR(A.REQUEST_TIME,'DD/MM/YYYY') POL_CREATED_DATE, SUM(CASE WHEN COVER_CODE IN ('10001', '10005') THEN D.PREMIUM END) BASEPREMIUM, SUM(CASE WHEN COVER_CODE='10603' THEN D.PREMIUM END) MINIMUM_PREMIUM_ADJUSTMENT, SUM(CASE WHEN GROUP_TYPE='L' AND COVER_CODE!='10603' THEN D.PREMIUM END) LOADING, SUM(CASE WHEN GROUP_TYPE='D' THEN D.PREMIUM END) DISCOUNT, SUM(CASE WHEN COVER_CODE in ('10656','10613','100610') THEN D.PREMIUM END) LESS_NON_BASIC, SUM(CASE WHEN COVER_CODE IN ('10023','100611') THEN D.PREMIUM END) NOTPART_OF_BASE_PREMIUM, (SELECT SUM(PREMIUM )FROM ( SELECT DISTINCT YC.COVER_CODE, YC.PREMIUM FROM MOTOR_OPCOVER_ADDON_DETAILS G, YI_COVER_DETAIL YC WHERE YC.REQUESTREFERENCENO=REQUESTREFERENCENO AND YC.PREMIUM!=0 AND YC.COVER_CODE=G.CORE_APPCODE AND G.PRODUCTID=65 AND G.STATUS='Y' AND G.CONFIG_TYPE='A' AND YC.COVER_CODE NOT IN ('10001', '10005','10656', '100610','10023','100611') AND NOT EXISTS (SELECT 1 FROM MOTOR_GROUP_MASTER WHERE CORE_APPCODE=G.CORE_APPCODE AND STATUS='Y')) ) ADDON_PREMIUM, A.NET_PREMIUM FROM YI_POLICY_DETAIL A INNER JOIN YI_COVER_DETAIL D ON (A.REQUESTREFERENCENO= D.REQUESTREFERENCENO) LEFT OUTER JOIN MOTOR_GROUP_MASTER E ON (D.COVER_CODE=E.CORE_APPCODE AND E.STATUS='Y') WHERE TRUNC(A.REQUEST_TIME) BETWEEN TO_DATE(?1, 'DD/MM/YYYY') AND TO_DATE(?2, 'DD/MM/YYYY') AND D.PREMIUM!=0 AND A.PRODUCT IN (SELECT REGEXP_SUBSTR(?3, '[^,]+', 1, LEVEL) \
                                AS DATA FROM DUAL CONNECT BY REGEXP_SUBSTR(?3, '[^,]+', 1, LEVEL) IS NOT NULL) GROUP BY A.REQUESTREFERENCENO, A.QUOTATION_POLICY_NO, A.CURRENT_STATUS, A.REQUEST_TIME, A.NET_PREMIUM ) F, YI_VAT_DETAIL B, YI_CHARGE_DETAIL C WHERE F.QUOTE_NO=B.REQUESTREFERENCENO AND F.QUOTE_NO=C.REQUESTREFERENCENO GROUP BY QUOTE_NO, POLICY_NO, POLICY_STATUS, POLICY_STAGE, POL_CREATED_DATE, BASEPREMIUM, MINIMUM_PREMIUM_ADJUSTMENT, LOADING, DISCOUNT, NOTPART_OF_BASE_PREMIUM, LESS_NON_BASIC, ADDON_PREMIUM, VAT_AMOUNT, NET_PREMIUM

FLEET_BROKER = SELECT * FROM (SELECT DISTINCT PM.LOGIN_ID CODE, PM.LOGIN_ID \
               FIRST_NAME, BCM.COMPANY_NAME CODEDESC, LM.OA_CODE FROM \
               FLEET_REQUEST_DETAIL PM, LOGIN_MASTER LM, \
               BROKER_COMPANY_MASTER BCM WHERE LM.LOGIN_ID = PM.LOGIN_ID AND \
               LM.AGENCY_CODE = BCM.AGENCY_CODE AND PM.STATUS IN ('P', \
               'Y','R') AND BCM.BRANCH_CODE = ?1 AND PM.BROKER_CODE = \
               BCM.AGENCY_CODE AND PM.BDM_CODE IS NULL AND lm.status = 'Y' AND \
               BCM.status = 'Y' AND LM.OA_CODE NOT IN (SELECT BROKER_CODE FROM \
               LOGIN_RSAUSER_DETAILS WHERE LOGIN_ID = ?2 AND PRODUCT_ID = ?3) \
               UNION ALL SELECT DISTINCT LM.LOGIN_ID CODE, USERNAME, USERNAME \
               CODEDESC, LM.OA_CODE FROM login_master lm, \
               FLEET_REQUEST_DETAIL PM WHERE lm.usertype = 'User' AND \
               lm.BRANCH_CODE = ?1 AND lm.OA_CODE != '90016' AND PM.STATUS IN \
               ('P', 'Y','R') AND PM.login_id = lm.login_id AND PM.broker_code \
               = lm.agency_code AND PM.BDM_CODE IS NULL AND lm.AGENCY_CODE IN \
               (SELECT DISTINCT AGENCY_CODE FROM LOGIN_USER_DETAILS LR WHERE \
               PRODUCT_ID = ?3 AND STATUS = 'Y' AND LR.LOGIN_ID = lm.LOGIN_ID) \
               AND lm.status = 'Y' UNION ALL SELECT DISTINCT pcd.CUSTOMER_CODE \
               CODE, pcd.CUSTOMER_NAME, pcd.CUSTOMER_NAME CODEDESC, \
               pcd.CUSTOMER_CODE FROM PREMIA_CUSTOMER_DETAILS pcd, \
               FLEET_REQUEST_DETAIL PM WHERE CUSTOMER_TYPE = '009' AND \
               CUSTOMER_CATEGORY =(SELECT CORE_APP_CODE FROM BRANCH_MASTER \
               WHERE STATUS='Y' AND BRANCH_CODE=?1) AND ((SELECT   \
               CORE_APP_CODE FROM   branch_master WHERE   status = 'Y' AND \
               branch_code = ?1) BETWEEN DIVISION_FROM AND DIVISION_TO) AND \
               PM.BDM_CODE = pcd.CUSTOMER_CODE AND PM.STATUS IN ('P', 'Y','R') \
               AND pcd.status = 'Y') ORDER BY CODEDESC
               
FLEET_REJECTED_DATA = SELECT ERD.REQUESTREFERENCENO, ERD.APPLICATION_NO, ERD.QUOTE_NO, '' LAPSED_REMARKS, '' LAPSED_DATE, \
           			  ERD.CUSTOMER_ID, TO_CHAR (ERD.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, '' VALIDITY_PERIOD, ERD.COMPANY_NAME CUSTOMER_NAME, \
           	 		  (CASE WHEN ERD.BDM_CODE IS NULL OR ERD.APPLICATION_ID = '1' THEN ERD.LOGIN_ID ELSE ERD.BDM_CODE END) LOGIN_ID, \
           			  ERD.STATUS, ERD.COMPANY_NAME, 'REJECTED' REJECT_DESC, NVL(ERD.OVERALL_PREMIUM, 0) PREMIUM, ERD.UPLOAD_TRAN_ID, \
          			  TO_CHAR (ERD.ENTRY_DATE, 'DD/MM/YYYY') VALIDITY_DATE, (CASE WHEN ERD.UPLOAD_TRAN_ID IS NULL AND (SELECT COUNT(*) FROM \
                      FLEET_TEMPLATE_RAW FTR WHERE FTR.TRANSACTION_ID=ERD.UPLOAD_TRAN_ID AND FTR.STATUS!='R')=0 THEN 'FU' WHEN \
                      ERD.UPLOAD_TRAN_ID IS NOT NULL  AND ((SELECT  FTD.TOTALRECORDS FROM FLEET_TRANSACTION_DETAILS FTD  WHERE \
                      FTD.TRANID=ERD.UPLOAD_TRAN_ID)!=(SELECT COUNT(*) FROM FLEET_TEMPLATE_RAW FTR WHERE FTR.TRANSACTION_ID=ERD.UPLOAD_TRAN_ID \
                      AND FTR.STATUS!='R')) THEN 'FUP' WHEN ERD.UPLOAD_TRAN_ID IS NOT NULL AND ((SELECT FTD.TOTALRECORDS FROM \
                      FLEET_TRANSACTION_DETAILS FTD WHERE FTD.TRANID=ERD.UPLOAD_TRAN_ID)=(SELECT COUNT(*) FROM FLEET_TEMPLATE_RAW FTR \
                      WHERE  FTR.TRANSACTION_ID=ERD.UPLOAD_TRAN_ID AND FTR.STATUS!='R')) THEN 'FUC' END) STATUS_TYPE, ERD.RENEWALYN,ERD.RENEWALPOLICYNO \
                      FROM FLEET_REQUEST_DETAIL ERD, PERSONAL_INFO PI WHERE (CASE WHEN ERD.BDM_CODE IS NULL OR ERD.APPLICATION_ID = '1' THEN \
                      ERD.LOGIN_ID ELSE ERD.BDM_CODE END) = ?1 AND ERD.PRODUCT_ID ='75' AND (ERD.APPLICATION_ID = ?2 OR ?2 IS NULL) \
           			  AND (ERD.STATUS IN ('D')) AND ERD.INTEGRATION_STATUS IS NULL AND (ERD.HODREFERRALYN='N' OR ERD.HODREFERRALYN IS NULL) \
           		      AND TRUNC(ERD.ENTRY_DATE) >  TRUNC(SYSDATE) - 30 AND ERD.CUST_APPROVE_STATUS IS NULL AND ERD.CUSTOMER_ID = PI.CUSTOMER_ID (+) \
           		      AND (PI.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = PI.CUSTOMER_ID) OR '' IS NULL) \
           			  AND (PI.STATUS = 'Y' OR '' IS NULL) ORDER BY ERD.ENTRY_DATE DESC

FLEET_EXPIRE_DATA = SELECT ERD.REQUESTREFERENCENO, ERD.QUOTE_NO, ERD.STATUS, ERD.CUSTOMER_ID, TO_CHAR (ERD.ENTRY_DATE, 'DD/MM/YYYY') \
				    QUOTATION_DATE,  ERD.COMPANY_NAME CUSTOMER_NAME, NVL(ERD.OVERALL_PREMIUM, 0) PREMIUM, '' LAPSED_REMARKS, '' LAPSED_DATE, \
				    '' VALIDITY_PERIOD, TO_CHAR (ERD.ENTRY_DATE, 'DD/MM/YYYY') VALIDITY_DATE, (CASE WHEN ERD.BDM_CODE IS NULL OR \
				    ERD.APPLICATION_ID = '1' THEN ERD.LOGIN_ID ELSE ERD.BDM_CODE END) LOGIN_ID, ERD.APPLICATION_NO, ERD.COMPANY_NAME, \
				    ERD.UPLOAD_TRAN_ID, (CASE WHEN ERD.UPLOAD_TRAN_ID IS NULL AND (SELECT COUNT(*) FROM  FLEET_TEMPLATE_RAW FTR \
				    WHERE FTR.TRANSACTION_ID=ERD.UPLOAD_TRAN_ID AND FTR.STATUS!='R')=0 THEN 'FU' WHEN ERD.UPLOAD_TRAN_ID IS NOT NULL \
				    AND ((SELECT FTD.TOTALRECORDS FROM FLEET_TRANSACTION_DETAILS FTD WHERE FTD.TRANID=ERD.UPLOAD_TRAN_ID)!=(SELECT COUNT(*) \
                    FROM FLEET_TEMPLATE_RAW FTR WHERE FTR.TRANSACTION_ID=ERD.UPLOAD_TRAN_ID AND FTR.STATUS!='R')) THEN 'FUP' WHEN \
                    ERD.UPLOAD_TRAN_ID IS NOT NULL AND ((SELECT FTD.TOTALRECORDS FROM FLEET_TRANSACTION_DETAILS FTD WHERE \
                    FTD.TRANID=ERD.UPLOAD_TRAN_ID)=(SELECT COUNT(*) FROM FLEET_TEMPLATE_RAW FTR WHERE FTR.TRANSACTION_ID=ERD.UPLOAD_TRAN_ID \
                    AND FTR.STATUS!='R')) THEN 'FUC' END) STATUS_TYPE,ERD.RENEWALYN,ERD.RENEWALPOLICYNO FROM FLEET_REQUEST_DETAIL ERD, PERSONAL_INFO PI, HOME_POSITION_MASTER HPM \
   					WHERE (CASE WHEN ERD.BDM_CODE IS NULL OR ERD.APPLICATION_ID = '1' THEN ERD.LOGIN_ID ELSE ERD.BDM_CODE END) = ?1 \
                	AND ERD.PRODUCT_ID ='75' AND ERD.STATUS='Y' AND ERD.INTEGRATION_STATUS IS NULL AND (ERD.HODREFERRALYN='N' \
                	OR ERD.HODREFERRALYN IS NULL) AND TRUNC (ERD.ENTRY_DATE) <  TRUNC(SYSDATE) - 30 AND ERD.CUST_APPROVE_STATUS IS NULL \
           			AND ERD.CUSTOMER_ID = PI.CUSTOMER_ID (+)  AND (ERD.APPLICATION_ID = ?2 OR ?2 IS NULL) AND (PI.AMEND_ID = (SELECT   MAX (AMEND_ID) \
                    FROM   PERSONAL_INFO WHERE   CUSTOMER_ID = PI.CUSTOMER_ID) OR '' IS NULL) AND (PI.STATUS = 'Y' OR '' IS NULL) AND \
                    ERD.QUOTE_NO=HPM.QUOTE_NO (+) AND ERD.STATUS=HPM.STATUS (+) ORDER BY ERD.ENTRY_DATE DESC
                    
ADMIN_PORTFOLIO_ACTIVEPOLICY_PRODUCTION_GENEERATED=AND (PM.INTEGRATION_STATUS = 'S' ) AND (PM.POL_INTEG_STATUS = 'SUCCESS' )
ADMIN_PORTFOLIO_ACTIVEPOLICY_PRODUCTION_PENDING=AND (PM.INTEGRATION_STATUS != 'S' OR PM.INTEGRATION_STATUS IS NULL ) AND (PM.POL_INTEG_STATUS != 'SUCCESS' OR PM.POL_INTEG_STATUS IS NULL )

ADMIN_PRODUCTION_REPORT=SELECT HPM.BRANCH_CODE, (SELECT BRANCH_NAME FROM BRANCH_MASTER WHERE HPM.BRANCH_CODE = BRANCH_CODE) BRANCH_NAME, (CASE WHEN HPM.APPLICATION_ID = '1' THEN HPM.LOGIN_ID ELSE HPM.APPLICATION_ID END) USER_CREATED, ERD.POLICYTYPE POLICYTYPE_ID, (SELECT POLICYTYPE_DESC_ENGLISH FROM MOTOR_POLICYTYPE_MASTER MS WHERE POLICY_SUBTYPE_ID = ERD.POLICYTYPE AND AMEND_ID = (SELECT MAX (AMEND_ID) FROM MOTOR_POLICYTYPE_MASTER WHERE POLICY_SUBTYPE_ID = MS.POLICY_SUBTYPE_ID)) POLICYTYPE, COUNT(CASE WHEN HPM.STATUS='Y' THEN 1 END) QUOTE, COUNT(CASE WHEN HPM.STATUS='P' THEN 1 END) POLICY, COUNT(CASE WHEN HPM.CUST_APPROVE_STATUS = 'Y' THEN 1 END) CUSTOMER_APPROVED, COUNT(CASE WHEN HPM.CUST_APPROVE_STATUS = 'P' THEN 1 END) CUSTOMER_PENDING, COUNT(CASE WHEN HPM.CUST_APPROVE_STATUS = 'R' THEN 1 END) CUSTOMER_REQUOTE, COUNT(CASE WHEN HPM.REMARKS = 'Referal' AND HPM.CUST_APPROVE_STATUS IS NULL THEN 1 END) REFERRAL_PENDING, COUNT(CASE WHEN HPM.REMARKS = 'Admin' AND HPM.CUST_APPROVE_STATUS IS NULL THEN 1 END) REFERRAL_APPROVED, SUM(HPM.PREMIUM) GROSS_PREMIUM, SUM(HPM.OVERALL_PREMIUM) NET_PREMIUM FROM ESERVICE_REQUEST_DETAIL ERD INNER JOIN HOME_POSITION_MASTER HPM ON ERD.QUOTE_NO = HPM.QUOTE_NO INNER JOIN LOGIN_MASTER LM ON ( (HPM.APPLICATION_ID = '1' AND HPM.LOGIN_ID = LM.LOGIN_ID) OR (HPM.APPLICATION_ID != '1' AND HPM.APPLICATION_ID = LM.LOGIN_ID) ) WHERE ERD.QUOTE_NO IS NOT NULL AND TRUNC (HPM.EFFECTIVE_DATE) BETWEEN TO_DATE(?1,'DD/MM/YYYY') AND TO_DATE(?2,'DD/MM/YYYY') AND ERD.PRODUCT_ID=?3 AND ( (?4='99999' AND 'All Branch'='All Branch') OR (?4!='99999' AND HPM.BRANCH_CODE IN (?4)) ) AND ( (?5='99999' AND 'All Policytype'='All Policytype') OR (?5!='99999' AND ERD.POLICYTYPE IN (?5)) ) AND ( (?6='99999' AND 'All Userid'='All Userid') OR (?6!='99999' AND LM.LOGIN_ID IN (?6)) ) GROUP BY HPM.BRANCH_CODE, ERD.POLICYTYPE, HPM.APPLICATION_ID, HPM.LOGIN_ID, ERD.POLICYTYPE ORDER BY HPM.BRANCH_CODE

ADMIN_DASH_QUOTE_REPORT=SELECT BRANCH_CODE, BRANCH_NAME, USER_CREATED, POLICYTYPE, SUM(TOTAL_QUOTATIONS) TOTAL_QUOTATIONS, SUM(TOTAL_REFERAL) TOTAL_REFERAL, SUM(CUSTOMER_APPROVED)CUSTOMER_APPROVED, SUM(CUSTOMER_PENDING) CUSTOMER_PENDING, SUM(CUSTOMER_REQUOTE) CUSTOMER_REQUOTE, SUM(CUSTOMER_REJECTED)CUSTOMER_REJECTED, SUM(REFERAL_PENDING) REFERAL_PENDING, SUM(REFERAL_APPROVED) REFERAL_APPROVED, SUM(REFERAL_REJECTED) REFERAL_REJECTED, SUM(TOTAL_POLICY)TOTAL_POLICY, SUM(GROSS_PREMIUM)GROSS_PREMIUM, SUM(NET_PREMIUM) NET_PREMIUM FROM ( SELECT HPM.BRANCH_CODE, (SELECT BRANCH_NAME FROM BRANCH_MASTER WHERE HPM.BRANCH_CODE = BRANCH_CODE) BRANCH_NAME, (CASE WHEN HPM.APPLICATION_ID = '1' THEN HPM.LOGIN_ID ELSE HPM.APPLICATION_ID END) USER_CREATED , (SELECT POLICYTYPE_DESC_ENGLISH FROM MOTOR_POLICYTYPE_MASTER MS WHERE MS.STATUS='Y' AND MS.POLICY_SUBTYPE_ID = ERD.POLICYTYPE AND AMEND_ID = (SELECT MAX (AMEND_ID) FROM MOTOR_POLICYTYPE_MASTER WHERE POLICY_SUBTYPE_ID = MS.POLICY_SUBTYPE_ID)) POLICYTYPE, COUNT(*) TOTAL_QUOTATIONS, COUNT(CASE WHEN ( (HPM.STATUS IN ('Y','E') AND HPM.REMARKS='Referal') OR (HPM.STATUS IN ('Y','E') AND HPM.REMARKS='Admin' AND HPM.CUST_APPROVE_STATUS IS NULL) OR (HPM.STATUS='R' AND HPM.ADMIN_REFERRAL_STATUS='N') ) THEN 1 END) TOTAL_REFERAL, COUNT(CASE WHEN HPM.STATUS='Y' AND HPM.CUST_APPROVE_STATUS = 'Y' THEN 1 END) CUSTOMER_APPROVED, COUNT(CASE WHEN HPM.STATUS='Y' AND HPM.CUST_APPROVE_STATUS = 'P' THEN 1 END) CUSTOMER_PENDING, COUNT(CASE WHEN HPM.STATUS='Y' AND HPM.CUST_APPROVE_STATUS = 'R' THEN 1 END) CUSTOMER_REQUOTE, COUNT(CASE WHEN HPM.STATUS='Y' AND HPM.CUST_APPROVE_STATUS = 'F' THEN 1 END) CUSTOMER_REJECTED, COUNT(CASE WHEN HPM.STATUS IN ('Y','E') AND HPM.REMARKS='Referal' THEN 1 END) REFERAL_PENDING, COUNT(CASE WHEN HPM.STATUS IN ('Y','E') AND HPM.REMARKS='Admin' AND HPM.CUST_APPROVE_STATUS IS NULL THEN 1 END) REFERAL_APPROVED, COUNT(CASE WHEN HPM.STATUS = 'R' AND HPM.ADMIN_REFERRAL_STATUS = 'N' THEN 1 END) REFERAL_REJECTED , 0 TOTAL_POLICY, 0 GROSS_PREMIUM, 0 NET_PREMIUM FROM ESERVICE_REQUEST_DETAIL ERD LEFT OUTER JOIN HOME_POSITION_MASTER HPM ON ERD.QUOTE_NO = HPM.QUOTE_NO INNER JOIN LOGIN_MASTER LM ON ( (HPM.APPLICATION_ID = '1' AND HPM.LOGIN_ID = LM.LOGIN_ID) OR (HPM.APPLICATION_ID != '1' AND HPM.APPLICATION_ID = LM.LOGIN_ID) ) WHERE ERD.PRODUCT_ID=65 AND ERD.POLICYTYPE IS NOT NULL AND TRUNC (ERD.ENTRY_DATE) BETWEEN TRUNC(SYSDATE)-30 AND TRUNC(SYSDATE) AND ( (OA_CODE='90016' AND USERTYPE!='User') OR (OA_CODE!='90016' AND 'A'='A') ) AND HPM.BRANCH_CODE =?3 AND (HPM.LOGIN_ID=?2 OR HPM.APPLICATION_ID=?2) GROUP BY HPM.BRANCH_CODE, HPM.APPLICATION_ID, HPM.LOGIN_ID, ERD.POLICYTYPE UNION ALL SELECT HPM.BRANCH_CODE, (SELECT BRANCH_NAME FROM BRANCH_MASTER WHERE HPM.BRANCH_CODE = BRANCH_CODE) BRANCH_NAME, (CASE WHEN HPM.APPLICATION_ID = '1' THEN HPM.LOGIN_ID ELSE HPM.APPLICATION_ID END) USER_CREATED , (SELECT POLICYTYPE_DESC_ENGLISH FROM MOTOR_POLICYTYPE_MASTER MS, ESERVICE_REQUEST_DETAIL ERD WHERE MS.STATUS='Y' AND MS.POLICY_SUBTYPE_ID = ERD.POLICYTYPE AND ERD.QUOTE_NO = HPM.QUOTE_NO AND ERD.POLICYTYPE IS NOT NULL AND AMEND_ID = (SELECT MAX (AMEND_ID) FROM MOTOR_POLICYTYPE_MASTER WHERE POLICY_SUBTYPE_ID = MS.POLICY_SUBTYPE_ID)) POLICYTYPE, 0 TOTAL_QUOTATIONS, 0 TOTAL_REFERAL, 0 CUSTOMER_APPROVED, 0 CUSTOMER_PENDING, 0 CUSTOMER_REQUOTE, 0 CUSTOMER_REJECTED, 0 REFERAL_PENDING, 0 REFERAL_APPROVED, 0 REFERAL_REJECTED, COUNT(*) TOTAL_POLICY, SUM(HPM.PREMIUM) GROSS_PREMIUM, SUM(HPM.OVERALL_PREMIUM) NET_PREMIUM FROM HOME_POSITION_MASTER HPM INNER JOIN LOGIN_MASTER LM ON ( (HPM.APPLICATION_ID = '1' AND HPM.LOGIN_ID = LM.LOGIN_ID) OR (HPM.APPLICATION_ID != '1' AND HPM.APPLICATION_ID = LM.LOGIN_ID) ) WHERE HPM.PRODUCT_ID=?1 AND TRUNC (HPM.EFFECTIVE_DATE) BETWEEN TRUNC(SYSDATE)-30 AND TRUNC(SYSDATE) AND HPM.STATUS='P' AND HPM.INTEGRATION_STATUS='S' AND HPM.POL_INTEG_STATUS='SUCCESS' AND ( (OA_CODE='90016' AND USERTYPE!='User') OR (OA_CODE!='90016' AND 'A'='A') ) AND HPM.BRANCH_CODE =?3 AND (HPM.LOGIN_ID=?2 OR HPM.APPLICATION_ID=?2) GROUP BY HPM.BRANCH_CODE, HPM.APPLICATION_ID, HPM.LOGIN_ID, HPM.QUOTE_NO ) GROUP BY BRANCH_CODE, BRANCH_NAME, USER_CREATED, POLICYTYPE ORDER BY 1
##ADMIN_DASH_POLICY_REPORT=SELECT 'Policy' REPORT_TYPE, POLICYTYPE_ID, POLICYTYPE, USER_CREATED, COUNT(*) POLICY, SUM(PREMIUM) GROSS_PREMIUM, SUM(OVERALL_PREMIUM) NET_PREMIUM FROM PRODUCTION_REPORT_VIEW WHERE TRUNC (EFFECTIVE_DATE) BETWEEN TRUNC(SYSDATE)-30 AND TRUNC(SYSDATE) AND PRODUCT_ID=?1 AND USER_CREATED=?2 AND BRANCH_CODE =?3 AND POLICYTYPE_ID IS NOT NULL AND STATUS='P' AND INTEGRATION_STATUS='S' AND POL_INTEG_STATUS='SUCCESS' GROUP BY POLICYTYPE_ID, POLICYTYPE, USER_CREATED

TRAVELCOVER = SELECT POLICY_TYPE_ID CODE,POLICY_TYPE_DESC CODEDESC FROM  TRAVEL_POLICY_TYPE_MASTER WHERE STATUS='Y'
TRAVEL_COVER = AND POLICY_TYPE_ID IN('3','4')
NATIONALITY = SELECT  COUNTRY_ID  AS  CODE,NATIONALITY_NAME AS CODEDESC FROM COUNTRY_MASTER CM  WHERE  STATUS='Y' AND NATIONALITY_NAME  IS NOT NULL AND CM.AMEND_ID=(SELECT  MAX(AMEND_ID) FROM COUNTRY_MASTER CM1 WHERE CM.COUNTRY_ID=CM1.COUNTRY_ID)  ORDER BY 2 ASC
CITY = SELECT CITY_ID CODE,CITY_NAME CODEDESC FROM CITY_MASTER WHERE   STATUS='Y' AND COUNTRY_ID='1'  ORDER BY CITY_ID ASC
COUNTRY  = SELECT COUNTRY_ID AS CODE,COUNTRY_NAME AS CODEDESC FROM COUNTRY_MASTER WHERE STATUS IN('Y','R') 

ADMIN_REFERRAL_REPORT=SELECT HPM.POLICY_NO,NVL(ERD.POLICYTYPE, MDD.POLICYTYPE) POLICYTYPE_ID, ( SELECT MS.POLICYTYPE_DESC_ENGLISH FROM MOTOR_POLICYTYPE_MASTER MS WHERE MS.STATUS = 'Y' AND MS.POLICY_SUBTYPE_ID = NVL(ERD.POLICYTYPE, MDD.POLICYTYPE) AND AMEND_ID = ( SELECT MAX (AMEND_ID) FROM MOTOR_POLICYTYPE_MASTER WHERE POLICY_SUBTYPE_ID = MS.POLICY_SUBTYPE_ID)) POLICYTYPE, HPM. QUOTE_NO, ( CASE WHEN HPM.APPLICATION_ID = '1' THEN HPM.LOGIN_ID ELSE HPM.APPLICATION_ID END) USER_CREATED, HPM.BRANCH_CODE, ( SELECT BRANCH_NAME FROM BRANCH_MASTER WHERE BRANCH_CODE = HPM.BRANCH_CODE AND STATUS = 'Y') BRANCH_NAME, HPM.STATUS, CASE WHEN HPM.ADMIN_REFERRAL_STATUS = 'Y' THEN 'Yes' ELSE 'No' END AS ADMIN_REFERRAL_STATUS, CASE WHEN HPM.STATUS IN ('Y','E') AND HPM.ADMIN_REFERRAL_STATUS='N' AND HPM.REMARKS='Referal' THEN 'Referal Pending/Unapproved' WHEN HPM.STATUS IN ('Y','E') AND HPM.REMARKS='Admin' AND HPM.CUST_APPROVE_STATUS IS NULL THEN 'Referal Approved' WHEN HPM.STATUS='R' AND HPM.ADMIN_REFERRAL_STATUS='N' THEN 'Referal Rejected' WHEN HPM.STATUS='P' AND HPM.REMARKS='Admin' AND HPM.INTEGRATION_STATUS='S' AND HPM.POL_INTEG_STATUS='SUCCESS' Then 'Policy Converted' ELSE 'Existing Quote' END STATUS_DESCRIPTION, HPM.CEO_REFERRAL, HPM.REFERAL_CODES, HPM. REFERRAL_DESCRIPTION, CD_DRIVER_OFFENCE DRIVER_OFFENCE, HPM.APPROVED_BY, TO_CHAR(HPM.APPR_CAN_DT, 'DD/MM/YYYY') APPROVED_DATE, TO_CHAR(ERD.ENTRY_DATE,'DD/MM/YYYY HH24:MI' ) ENTRY_DATE, CASE WHEN HPM.STATUS='P' THEN TO_CHAR(HPM.EFFECTIVE_DATE,'DD/MM/YYYY') ELSE NULL END POLICY_ISSUE_DATE, TO_CHAR(HPM.INCEPTION_DATE,'DD/MM/YYYY') POLICT_START_DATE, HPM.ADMIN_REMARKS, HPM.REMARKS, HPM.PREMIUM, HPM. OVERALL_PREMIUM, TO_CHAR(HPM.APPR_CAN_DT,'DD/MM/YYYY HH24:MI:SS') HPM_APPR_CAN_DT, TO_CHAR(ERD.ENTRY_DATE,'DD/MM/YYYY HH24:MI:SS') ERD_ENTRY_DATE, CASE WHEN HPM.STATUS='P' THEN TO_CHAR(HPM.EFFECTIVE_DATE,'DD/MM/YYYY HH24:MI:SS') ELSE NULL END HPM_EFFECTIVE_DATE_A, CASE WHEN HPM.STATUS='P' THEN TO_CHAR(HPM.APPR_CAN_DT,'DD/MM/YYYY HH24:MI:SS') ELSE NULL END HPM_APPR_CAN_DT_A FROM ESERVICE_REQUEST_DETAIL ERD LEFT OUTER JOIN HOME_POSITION_MASTER HPM ON (ERD.QUOTE_NO = HPM.QUOTE_NO) INNER JOIN MOTOR_DATA_DETAIL MDD ON (HPM.QUOTE_NO = MDD.QUOTE_NO) INNER JOIN LOGIN_MASTER LM ON ( (HPM.APPLICATION_ID = '1' AND HPM.LOGIN_ID = LM.LOGIN_ID) OR (HPM.APPLICATION_ID != '1' AND HPM.APPLICATION_ID = LM.LOGIN_ID)) INNER JOIN MS_COMMON_DETAIL MCDQ ON (ERD.REQUESTREFERENCENO=MCDQ.REQUESTREFERENCENO) INNER JOIN MS_CUSTOMER_DETAIL MCD ON (MCDQ.CDREFERENCENO=MCD.CD_REFERENCENO) WHERE HPM.PRODUCT_ID=?3 AND TRUNC(HPM.EFFECTIVE_DATE) BETWEEN TO_DATE(?1, 'DD/MM/YYYY') AND TO_DATE(?2, 'DD/MM/YYYY') AND HPM.BRANCH_CODE IN (SELECT REGEXP_SUBSTR(?4, '[^,]+', 1, LEVEL) AS data FROM dual CONNECT BY REGEXP_SUBSTR(?4, '[^,]+', 1, LEVEL) IS NOT NULL) ORDER BY POLICYTYPE_ID, HPM.BRANCH_CODE

#ADMIN_REFERRAL_REPORT=SELECT HPM.POLICY_NO,NVL(ERD.POLICYTYPE, MDD.POLICYTYPE) POLICYTYPE_ID, (SELECT MS. POLICYTYPE_DESC_ENGLISH FROM MOTOR_POLICYTYPE_MASTER MS WHERE MS.STATUS = 'Y' AND MS.POLICY_SUBTYPE_ID = NVL(ERD.POLICYTYPE, MDD.POLICYTYPE) AND AMEND_ID = ( SELECT MAX (AMEND_ID) FROM MOTOR_POLICYTYPE_MASTER WHERE POLICY_SUBTYPE_ID = MS.POLICY_SUBTYPE_ID)) POLICYTYPE, HPM. QUOTE_NO, ( CASE WHEN HPM.APPLICATION_ID = '1' THEN HPM.LOGIN_ID ELSE HPM.APPLICATION_ID END) USER_CREATED, HPM.BRANCH_CODE, ( SELECT BRANCH_NAME FROM BRANCH_MASTER WHERE BRANCH_CODE = HPM.BRANCH_CODE AND STATUS = 'Y') BRANCH_NAME, HPM.STATUS, CASE WHEN HPM.ADMIN_REFERRAL_STATUS = 'Y' THEN 'Yes' ELSE 'No' END AS ADMIN_REFERRAL_STATUS, CASE WHEN HPM.STATUS IN ('Y','E') AND HPM.ADMIN_REFERRAL_STATUS='N' AND HPM.REMARKS='Referal' THEN 'Referal Pending/Unapproved' WHEN HPM.STATUS IN ('Y','E') AND HPM.REMARKS='Admin' AND HPM.CUST_APPROVE_STATUS IS NULL THEN 'Referal Approved' WHEN HPM.STATUS='R' AND HPM.ADMIN_REFERRAL_STATUS='N' THEN 'Referal Rejected' WHEN HPM.STATUS='P' AND HPM.REMARKS='Admin' AND HPM.INTEGRATION_STATUS='S' AND HPM.POL_INTEG_STATUS='SUCCESS' Then 'Policy Converted' ELSE 'Existing Quote' END STATUS_DESCRIPTION, HPM.CEO_REFERRAL, HPM.REFERAL_CODES, HPM. REFERRAL_DESCRIPTION, HPM.APPROVED_BY, TO_CHAR(HPM.APPR_CAN_DT, 'DD/MM/YYYY') APPROVED_DATE, TO_CHAR(ERD.ENTRY_DATE,'DD/MM/YYYY HH24:MI' ) ENTRY_DATE, CASE WHEN HPM.STATUS='P' THEN TO_CHAR(HPM.EFFECTIVE_DATE,'DD/MM/YYYY') ELSE NULL END POLICY_ISSUE_DATE , TO_CHAR(HPM.INCEPTION_DATE,'DD/MM/YYYY') POLICT_START_DATE, HPM. ADMIN_REMARKS, HPM.REMARKS, HPM.PREMIUM, HPM.OVERALL_PREMIUM, (HPM.APPR_CAN_DT - ERD.ENTRY_DATE) APPROVAL_RESPONSE , CASE WHEN HPM.STATUS='P' THEN (HPM.EFFECTIVE_DATE - HPM.APPR_CAN_DT) ELSE NULL END POLICY_CONVERTED_RESPONSE FROM ESERVICE_REQUEST_DETAIL ERD LEFT OUTER JOIN HOME_POSITION_MASTER HPM ON (ERD.QUOTE_NO = HPM.QUOTE_NO) INNER JOIN MOTOR_DATA_DETAIL MDD ON (HPM.QUOTE_NO = MDD.QUOTE_NO) INNER JOIN LOGIN_MASTER LM ON ( (HPM. APPLICATION_ID = '1' AND HPM.LOGIN_ID = LM.LOGIN_ID) OR (HPM.APPLICATION_ID != '1' AND HPM.APPLICATION_ID = LM.LOGIN_ID)) WHERE HPM.PRODUCT_ID=?3 AND TRUNC(HPM.EFFECTIVE_DATE) BETWEEN TO_DATE(?1, 'DD/MM/YYYY') AND TO_DATE(?2, 'DD/MM/YYYY') AND HPM.BRANCH_CODE IN ( SELECT REGEXP_SUBSTR(?4, '[^,]+', 1, LEVEL) AS data FROM dual CONNECT BY REGEXP_SUBSTR(?4, '[^,]+', 1, LEVEL) IS NOT NULL) ORDER BY POLICYTYPE_ID, HPM.BRANCH_CODE